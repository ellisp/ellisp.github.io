      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Do tweeps with more followers follow tweeps with more followers?</title>
      	
         
         
            <meta name ="description" content ="I investigate a question about the Twitter network, and find that generally (until reaching a level of fame few of us aspire to), having more followers oneself is associated with following people who have less followers, not more.">
            <meta property="og:description" content ="I investigate a question about the Twitter network, and find that generally (until reaching a level of fame few of us aspire to), having more followers oneself is associated with following people who have less followers, not more.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Do tweeps with more followers follow tweeps with more followers?" />
         
            <meta property="og:image" content="https:/freerangestats.info/img/0118-main-scatter.svg" />
         
		 
			<meta property="og:url" content="https://freerangestats.info/blog/2018/02/24/following-followers.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2024/09/14/stepwise>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Do tweeps with more followers follow tweeps with more followers?</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>I investigate a question about the Twitter network, and find that generally (until reaching a level of fame few of us aspire to), having more followers oneself is associated with following people who have less followers, not more.</p>
	   <p class="meta">24 Feb 2018</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <p>Branko Milanovic <a href="https://twitter.com/BrankoMilan/status/964303658790866944">asked on Twitter</a>:</p>

<blockquote>
  <p>Idea for a paper: “Homogamy” on Twitter.  Do people with more followers follow people with more followers?</p>
</blockquote>

<p>I don’t have time to write a paper but I was sufficiently interested to want to blog about it.  The consensus in the replies was “of course they do”, with the claim that Twitter is well known for being assortative.  Oh, here’s some terminology:</p>

<ul>
  <li><em>homogamy</em> - in-breeding, or (in sociology) marriage between individuals who are, in some culturally important way, similar to eachother</li>
  <li><em>assortative</em> - a preference for a network’s nodes to attach to others that are similar in some way.</li>
</ul>

<p>The idea of assortativity in a network is basically that popular people (or whatever a node is) hang out with eachother and form lots of connections.</p>

<p>First, let’s cut to the chase.  Turns out that in fact, looking at the trimmed mean number of followers of the people that Twitter users follow, the relationship with the number of followers of the original person is not straightforward:</p>

<p><img src="/img/0118-main-scatter.svg" width="100%" /></p>

<p>In fact, you could say that generally, the more followers you have, the <em>less</em> followers the people you follow have - until a threshold of around 100,000 followers, which makes you one of the giants of Twitter (for a reference point that might mean something to readers of this blog, <a href="https://twitter.com/hadleywickham">Hadley Wickham</a> has around 58,000 followers, so more than 100,000 is really a lot).  This finding holds with two different methods of sampling people from Twitter, and is confirmed by more sophisticated modelling that looks simultaneously at the number of people one is following and the number of followers they have.</p>

<p>One plausible explanation is that “number of followers” is a proxy for length of engagement on Twitter.  When one starts out on Twitter, you are presented with a bunch of suggested popular accounts to follow (eg sports teams, entertainment celebrities, famous media outlets), typically with very high numbers of followers themselves.  So on day one, the average number of followers of the people <em>you</em> follow is very high.  Over time, the regular user of Twitter follows people (eg your friends) with less followers and the average followers of those people declines.  Only for the super-famous, everyone you know or care about is famous and so the homogamy/assortativity thesis kicks in but <em>iff</em> you’re a bit selective about who you follow, and don’t just follow back all your non-entity fans.</p>

<p>The issue (I think) that stops Twitter being highly assortative is the one-way nature of following someone.  Katy Perry’s 109 million followers don’t need to ask her permission to follow her; this makes the forming of edges between nodes in the Twitter network fundamentally different to marriage.</p>

<p>So what about the references mentioned in the Twitter exchange after Milanovic’s first tweet on this?  What I see in the literature (admittedly after a very cursory glance - I’m pressed for time as I write this) is a bit different.  There’s a couple of pieces suggesting <em>happiness</em> is assortative - people who write happy tweets associate with others who do the same, and the same applies to people who write unhappy tweets.  Also, the action of replying and retweeting is assortative.  But contrary to what some said in the Twitter exchange, I don’t see articles showing that the follow/followed network is assortative.</p>

<p>Let’s go into how I did this.</p>

<h2 id="a-sampling-problem">A sampling problem</h2>

<p>The first challenge is to get a sample of Twitter users.  This is harder than it might seem at first, if the aim is (as it should be) to be representative of the population at large.  First challenge is defining that population.  Do we mean every Twitter account, every human Twitter account, every account that is used for actively tweeting (why would you restrict it to this, as even reading tweets should surely count?).</p>

<p>There’s no conveniently published population of Twitter users. I’m aware of three broad ways one might go about getting a sample of users:</p>

<ol>
  <li>You could do the equivalent of “random digit dialling”, making up numeric Twitter identification numbers and checking them in the Twitter API for existence.  This method is in fact what you find if you google “how do I get a sample of Twitter users” but Twitter have made it effectively impossible by the (hidden) way they assign IDs. I observed ID numbers up to 10^17 and as low as 10^6, and sampling random numbers between those extremes hoping to hit one of the 300 million or so actual users sounds like a recipe for getting nowhere.</li>
  <li>You can pick a node and use a snowball sampling method; that is, follow an edge (either a person the first node follows, or a node who follows them) to another node, record what you need to about that person, then follow another edge to a third node, and so on until you have enough people.  This is what I did with the sample labelled “snowball sampling along network”.</li>
  <li>You can sample a bunch of actual tweets, and treat their authors as your sample.  This is what I did with the sample labelled “sample of today’s tweeters”.</li>
</ol>

<p>Method 1 is I think infeasible.  Method 2 will oversample users with lots of followers and who follow lots of people - basically, the more networked you are, the more likely you are to be sampled.  On the plus side for Method 2, quiet users who lurk but aren’t tweeting these days will have a chance of selection.  Method 3 on the other hand will give a very particular slice of users; but it has the advantage of less obvious dependence between the nodes we pick (all they have in common is tweeting in the last couple of minutes of when we harvest them).  I was unsure enough about sampling strategy to try them both.</p>

<p>Here’s code to do the sampling, using Jeff Gentry’s <code class="language-plaintext highlighter-rouge">twitteR</code> R package.  Note that the code that follows isn’t very robust, and took days to run because of Twitter’s rules on maximum downloads via the public API.  There’s lots that can go wrong with grabbing data from the Twitter API, hence the extensive and undisciplined use of <code class="language-plaintext highlighter-rouge">try()</code> in the code below in an effort to keep the data harvesting going in the face of various quirks .</p>

<p>First, setup.  This requires four different pass phrases which associated with your Twitter account (for obvious reasons, blanked out in the below, which stops this script being fully reproducible as-is).</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">twitteR</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">GGally</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">mgcv</span><span class="p">)</span><span class="w">

</span><span class="n">consumer_key</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"XXXXXXX"</span><span class="w">
</span><span class="n">consumer_secret</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"XXXXXXXXXX"</span><span class="w">
</span><span class="n">access_token</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"XXXXXXXXXX"</span><span class="w">
</span><span class="n">access_secret</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"XXXXXXXXXXX"</span><span class="w">

</span><span class="n">setup_twitter_oauth</span><span class="p">(</span><span class="n">consumer_key</span><span class="p">,</span><span class="w"> </span><span class="n">consumer_secret</span><span class="p">,</span><span class="w"> </span><span class="n">access_token</span><span class="p">,</span><span class="w"> </span><span class="n">access_secret</span><span class="p">)</span></code></pre></figure>

<p>As I’m interested in the “average” number of followers of the people a sampled user follows, for each user I sample I’m going to need to find out everyone they follow and estimate how many followers <em>they</em> have.  This is the thing that takes time.  It also exposes a problem; Twitter won’t let you look at more than a certain number of users at once.  That number turns out to be 75,000, as I find out from this experiment with <a href="https://twitter.com/search?q=toddcarey&amp;src=typd">Todd Carey</a>:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">many_following_user</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getUser</span><span class="p">(</span><span class="s2">"toddcarey"</span><span class="p">)</span><span class="w">
</span><span class="n">many_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">many_following_user</span><span class="o">$</span><span class="n">getFriendIDs</span><span class="p">()</span><span class="w">
</span><span class="nf">length</span><span class="p">(</span><span class="n">many_ids</span><span class="p">)</span><span class="w">      </span><span class="c1"># returns only 75000 ids; I think the most recent 75,000 he's followed</span></code></pre></figure>

<p>The problem here is that as Carey follows so many people (1.28 million) it’s infeasible to get the details of them all.  In fact, it’s infeasible even just to get all their 1.28 million screen names and then sample from those (I’m very happy to estimate “average number of followers of people X follows” from a sample).  I’ll have to deal with getting 75,000 users he follows, then sampling from those 75,000.  The big problem here is that I think those are the most recent 75,000 people he’s followed.  All else being equal, these are likely to be newer Twitter users than the overall population of people he follows, and hence likely to bias downwards my estimate of the average number of followers <em>they</em> have (as newer users will almost certainly have fewer followers on average).</p>

<p>[As an aside, one might wonder what is the point of following 1.28 million people on Twitter; it’s presumably part of a strategy, automated or not, of attracting followers by implicitly agreeing to follow them back.  It’s not fully automatic - I established this by following him to see what happened, and nothing did.]</p>

<p>I don’t see what can be done about this, other than note the people who follow more than 75,000 people as potentially suspect in subsequent analysis.  There’s not that many of them in my sample anyway.</p>

<p>Anywhere, here’s the code that does the snowball sampling.  I start with myself.  I take three types of average number of followers of the people X follows: mean (which is highly vulnerable to an arbitrarily large number getting in the sample), 20% trimmed mean and 50% trimmed mean (ie median); but I’m satisfied that 20% trimmed mean is robust and a good measure.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#=======================snowball sampling method================</span><span class="w">

</span><span class="n">follow_data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_frame</span><span class="p">(</span><span class="w">
  </span><span class="n">number_followers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span><span class="w">
  </span><span class="n">number_following</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span><span class="w">
  </span><span class="n">mean_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(),</span><span class="w">
  </span><span class="n">trmean_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(),</span><span class="w">
  </span><span class="n">median_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(),</span><span class="w">
  </span><span class="n">screenName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">()</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="c1"># Terminology</span><span class="w">
</span><span class="c1"># A "friend" is someone you follow</span><span class="w">
</span><span class="c1"># A "follower" is someone who follows you</span><span class="w">

</span><span class="n">current_sn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"ellis2013nz"</span><span class="w">

</span><span class="n">set.seed</span><span class="p">(</span><span class="m">124</span><span class="p">)</span><span class="w">

</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">1000</span><span class="p">){</span><span class="w">
  </span><span class="c1"># save latest copy of results in case of crash</span><span class="w">
  </span><span class="n">save</span><span class="p">(</span><span class="n">follow_data</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"follow_data.rda"</span><span class="p">)</span><span class="w">
  
  </span><span class="c1"># number of calls left to make under Twitter's limits</span><span class="w">
  </span><span class="n">lims</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getCurRateLimitInfo</span><span class="p">()</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/followers/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/friends/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w">
  </span><span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="n">lims</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getCurRateLimitInfo</span><span class="p">()</span><span class="w">
    </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/followers/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">
      </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/friends/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w">
    </span><span class="n">message</span><span class="p">(</span><span class="s2">"Waiting"</span><span class="p">)</span><span class="w">
    </span><span class="n">Sys.sleep</span><span class="p">(</span><span class="m">60</span><span class="p">)</span><span class="w"> </span><span class="c1"># wait 15 minutes (or 1 minute, 15 times)</span><span class="w">
  </span><span class="p">}</span><span class="w">
  
  
  </span><span class="n">cat</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">current_sn</span><span class="p">,</span><span class="w"> </span><span class="s2">" | "</span><span class="p">))</span><span class="w">
  
  </span><span class="n">current_user</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getUser</span><span class="p">(</span><span class="n">current_sn</span><span class="p">)</span><span class="w">
  </span><span class="n">follow_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"screenName"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_sn</span><span class="w">
  
  </span><span class="c1"># who this user follows (what happens if this is eg 1million people? I think it gets truncated at 75,000,</span><span class="w">
  </span><span class="c1"># which is not as bad as it sounds as we only need a sample; but the problem will be that this is their</span><span class="w">
  </span><span class="c1"># 75,000 most recent people they have followed, who might be biased to be newcomers?):</span><span class="w">
  
  </span><span class="c1"># certain privacy settings stop you seeing someone's friends and followers, in which case</span><span class="w">
  </span><span class="c1"># we try to sample another node from the last good person</span><span class="w">
  </span><span class="n">all_my_friends</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">character</span><span class="p">()</span><span class="w">
  </span><span class="n">try</span><span class="p">(</span><span class="n">all_my_friends</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_user</span><span class="o">$</span><span class="n">getFriendIDs</span><span class="p">())</span><span class="w">          </span><span class="c1"># about 1 second for c.1500 IDs, longer for more</span><span class="w">
  </span><span class="k">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">all_my_friends</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">){</span><span class="w">
  
    </span><span class="c1"># sample some of those friends</span><span class="w">
    </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="m">2000</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">all_my_friends</span><span class="p">))</span><span class="w">
    </span><span class="n">sample_my_friends</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">all_my_friends</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
    </span><span class="n">friend_details</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lookupUsers</span><span class="p">(</span><span class="n">sample_my_friends</span><span class="p">)</span><span class="w">            </span><span class="c1"># about 15 seconds</span><span class="w">
  
    </span><span class="n">friend_details_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">twListToDF</span><span class="p">(</span><span class="n">friend_details</span><span class="p">)</span><span class="w">
    
    </span><span class="n">follow_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"number_followers"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_user</span><span class="o">$</span><span class="n">followersCount</span><span class="w">
    </span><span class="n">follow_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"number_following"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_user</span><span class="o">$</span><span class="n">friendsCount</span><span class="w">
    
    </span><span class="c1"># mean number of followers of the people this user follows</span><span class="w">
    </span><span class="n">follow_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"mean_ff"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">friend_details_df</span><span class="o">$</span><span class="n">followersCount</span><span class="p">)</span><span class="w">
    </span><span class="n">follow_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"trmean_ff"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">friend_details_df</span><span class="o">$</span><span class="n">followersCount</span><span class="p">,</span><span class="w"> </span><span class="n">tr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w">
    </span><span class="n">follow_data</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"median_ff"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">friend_details_df</span><span class="o">$</span><span class="n">followersCount</span><span class="p">)</span><span class="w">
    
  </span><span class="p">}</span><span class="w">
  
  </span><span class="c1"># find the next user - flip a coin for it to be either a friend or a follower</span><span class="w">
  </span><span class="n">current_sn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"non_existent_user"</span><span class="w">
  </span><span class="k">while</span><span class="p">(</span><span class="n">current_sn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"non_existent_user"</span><span class="p">){</span><span class="w">
      
    </span><span class="k">if</span><span class="p">(</span><span class="n">sample</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">){</span><span class="w">
      </span><span class="c1"># 50% chance</span><span class="w">
      </span><span class="c1"># pick one of the user's friends (ie people they follow) at random as the new node to sample</span><span class="w">
      </span><span class="c1"># note that as a sampling strategy this will bias us towards people who are followed.  People</span><span class="w">
      </span><span class="c1"># who have few followers have little chance of being selected here.  Does this matter?</span><span class="w">
      </span><span class="c1"># Probably not for our main research question, but it does stop us doing meaningful inference</span><span class="w">
      </span><span class="c1"># on population totals of number of people followed and number of people following - unless</span><span class="w">
      </span><span class="c1"># we could estimate *how much* more likely people are to be followed, then we could estimate</span><span class="w">
      </span><span class="c1"># weights to make up for it.</span><span class="w">
      </span><span class="n">cat</span><span class="p">(</span><span class="s2">"\nsampling a friend\n"</span><span class="p">)</span><span class="w">
      </span><span class="n">try</span><span class="p">(</span><span class="n">current_sn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample_n</span><span class="p">(</span><span class="n">friend_details_df</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="o">$</span><span class="n">screenName</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="c1"># 50% chance</span><span class="w">
    </span><span class="c1"># pick one of the user's followers as the new node.  This is to mitigate the problem</span><span class="w">
    </span><span class="c1"># noted above.  We will still end up over-representing people with lots of followers</span><span class="w">
    </span><span class="c1"># (who will be sampled by the previuos method), and people who follow lots of people</span><span class="w">
    </span><span class="c1"># (more likely to be picked up in this alternative procedure in the next line), but</span><span class="w">
    </span><span class="c1"># that is better than *only* over sampling people with lots of followers.  Probably.</span><span class="w">
      </span><span class="n">cat</span><span class="p">(</span><span class="s2">"\nsampling a follower\n"</span><span class="p">)</span><span class="w">
      
      </span><span class="c1"># problem here when current_user has no followers:</span><span class="w">
      </span><span class="c1"># a random sample from the last 1000 people to follow this person (ie biased to more </span><span class="w">
      </span><span class="c1"># recent, for people with lots of followers, but c'est la vie - important to speed things</span><span class="w">
      </span><span class="c1"># up a bit)</span><span class="w">
      </span><span class="n">try</span><span class="p">(</span><span class="n">follower_samp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">current_user</span><span class="o">$</span><span class="n">getFollowerIDs</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">),</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w">
      </span><span class="n">try</span><span class="p">(</span><span class="n">current_sn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lookupUsers</span><span class="p">(</span><span class="n">follower_samp</span><span class="p">)[[</span><span class="m">1</span><span class="p">]]</span><span class="o">$</span><span class="n">screenName</span><span class="p">)</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<p>This gets me a sample that looks like the below.  Note that this method is prone to sampling individuals more than once, particularly highly networked users (ie lots of followers and/or lots of people following).  I’ll deal with that later by taking the average of the estimates of them.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="o">&gt;</span><span class="w"> </span><span class="n">follow_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
</span><span class="o">+</span><span class="w">   </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">number_followers</span><span class="p">))</span><span class="w">
</span><span class="c1"># A tibble: 983 x 6</span><span class="w">
   </span><span class="n">number_followers</span><span class="w"> </span><span class="n">number_following</span><span class="w"> </span><span class="n">mean_ff</span><span class="w"> </span><span class="n">trmean_ff</span><span class="w"> </span><span class="n">median_ff</span><span class="w"> </span><span class="n">screenName</span><span class="w">    
              </span><span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span><span class="w">            </span><span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span><span class="w">   </span><span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span><span class="w">     </span><span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span><span class="w">     </span><span class="o">&lt;</span><span class="n">dbl</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">chr</span><span class="o">&gt;</span><span class="w">         
 </span><span class="m">1</span><span class="w">        </span><span class="m">108538969</span><span class="w">              </span><span class="m">203</span><span class="w"> </span><span class="m">6002702</span><span class="w">   </span><span class="m">1227629</span><span class="w">    </span><span class="m">450295</span><span class="w"> </span><span class="n">katyperry</span><span class="w">     
 </span><span class="m">2</span><span class="w">         </span><span class="m">71131344</span><span class="w">             </span><span class="m">1034</span><span class="w"> </span><span class="m">3113456</span><span class="w">    </span><span class="m">373193</span><span class="w">    </span><span class="m">140602</span><span class="w"> </span><span class="n">YouTube</span><span class="w">       
 </span><span class="m">3</span><span class="w">         </span><span class="m">44212387</span><span class="w">              </span><span class="m">183</span><span class="w"> </span><span class="m">3208975</span><span class="w">    </span><span class="m">594062</span><span class="w">    </span><span class="m">255161</span><span class="w"> </span><span class="n">BillGates</span><span class="w">     
 </span><span class="m">4</span><span class="w">         </span><span class="m">40436829</span><span class="w">             </span><span class="m">1868</span><span class="w">  </span><span class="m">810532</span><span class="w">     </span><span class="m">38519</span><span class="w">     </span><span class="m">17959</span><span class="w"> </span><span class="n">narendramodi</span><span class="w">  
 </span><span class="m">5</span><span class="w">         </span><span class="m">40410386</span><span class="w">             </span><span class="m">1867</span><span class="w">  </span><span class="m">810495</span><span class="w">     </span><span class="m">38519</span><span class="w">     </span><span class="m">17926</span><span class="w"> </span><span class="n">narendramodi</span><span class="w">  
 </span><span class="m">6</span><span class="w">         </span><span class="m">40409932</span><span class="w">             </span><span class="m">1867</span><span class="w">  </span><span class="m">810489</span><span class="w">     </span><span class="m">38519</span><span class="w">     </span><span class="m">17926</span><span class="w"> </span><span class="n">narendramodi</span><span class="w">  
 </span><span class="m">7</span><span class="w">         </span><span class="m">40400380</span><span class="w">             </span><span class="m">1868</span><span class="w">  </span><span class="m">809897</span><span class="w">     </span><span class="m">38479</span><span class="w">     </span><span class="m">17924</span><span class="w"> </span><span class="n">narendramodi</span><span class="w">  
 </span><span class="m">8</span><span class="w">         </span><span class="m">35470473</span><span class="w">             </span><span class="m">1661</span><span class="w"> </span><span class="m">1559447</span><span class="w">    </span><span class="m">334577</span><span class="w">    </span><span class="m">219023</span><span class="w"> </span><span class="n">SportsCenter</span><span class="w">  
 </span><span class="m">9</span><span class="w">         </span><span class="m">24954373</span><span class="w">              </span><span class="m">424</span><span class="w"> </span><span class="m">1182455</span><span class="w">    </span><span class="m">232537</span><span class="w">     </span><span class="m">96970</span><span class="w"> </span><span class="n">PMOIndia</span><span class="w">      
</span><span class="m">10</span><span class="w">         </span><span class="m">21680806</span><span class="w">              </span><span class="m">771</span><span class="w">  </span><span class="m">900960</span><span class="w">      </span><span class="m">6736</span><span class="w">      </span><span class="m">2814</span><span class="w"> </span><span class="n">HillaryClinton</span><span class="w">
</span><span class="c1"># ... with 973 more rows</span></code></pre></figure>

<p>The snapshot sampling method is a bit simpler.  All I need is 1,000 random tweets, which I get by searching for tweets containing the letter “e” (as <code class="language-plaintext highlighter-rouge">twitteR</code> doesn’t facilitate a completely open search as far as I can see).  This isn’t great - I think it eliminates people using some character sets - but is good enough for a blog.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#==================snapshot sampling method===========</span><span class="w">
</span><span class="c1"># The first method of sampling will oversample people with lots of followers and people</span><span class="w">
</span><span class="c1"># with lots of friends.  As this is potentially linked to the response variable (indirectly)</span><span class="w">
</span><span class="c1"># it might be better to try an alternative sampling method, by grabbing a bunch of tweets.</span><span class="w">
</span><span class="c1"># This method will oversample people who are active tweeting today, which is a different</span><span class="w">
</span><span class="c1"># sort of coverage problem, so still need to be careful.</span><span class="w">
</span><span class="n">follow_data_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_frame</span><span class="p">(</span><span class="w">
  </span><span class="n">number_followers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span><span class="w">
  </span><span class="n">number_following</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">integer</span><span class="p">(),</span><span class="w">
  </span><span class="n">mean_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(),</span><span class="w">
  </span><span class="n">trmean_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(),</span><span class="w">
  </span><span class="n">median_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numeric</span><span class="p">(),</span><span class="w">
  </span><span class="n">screenName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">character</span><span class="p">()</span><span class="w">
</span><span class="p">)</span><span class="w">


</span><span class="c1"># 1000 random tweets with the letter "e" in them:</span><span class="w">
</span><span class="n">tweets</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">searchTwitter</span><span class="p">(</span><span class="s2">"e"</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w">

</span><span class="c1"># the users</span><span class="w">
</span><span class="n">users</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">sapply</span><span class="p">(</span><span class="n">tweets</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="n">x</span><span class="o">$</span><span class="n">screenName</span><span class="p">}))</span><span class="w">

</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="nf">length</span><span class="p">(</span><span class="n">users</span><span class="p">)){</span><span class="w">
  </span><span class="c1"># save latest copy of results in case of crash</span><span class="w">
  </span><span class="n">save</span><span class="p">(</span><span class="n">follow_data_2</span><span class="p">,</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"follow_data_2.rda"</span><span class="p">)</span><span class="w">
  
  </span><span class="c1"># number of calls left to make under Twitter's limits</span><span class="w">
  </span><span class="n">lims</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getCurRateLimitInfo</span><span class="p">()</span><span class="w">
  </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/followers/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">
    </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/friends/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w">
  </span><span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="n">lims</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getCurRateLimitInfo</span><span class="p">()</span><span class="w">
    </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/followers/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">
      </span><span class="nf">as.numeric</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">lims</span><span class="p">,</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"/friends/ids"</span><span class="p">)</span><span class="o">$</span><span class="n">remaining</span><span class="p">)</span><span class="w">
    </span><span class="n">message</span><span class="p">(</span><span class="s2">"Waiting"</span><span class="p">)</span><span class="w">
    </span><span class="n">Sys.sleep</span><span class="p">(</span><span class="m">60</span><span class="p">)</span><span class="w"> </span><span class="c1"># wait 15 minutes (or 1 minute, 15 times)</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">current_sn</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">users</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w">
  
  </span><span class="n">cat</span><span class="p">(</span><span class="n">paste</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">current_sn</span><span class="p">,</span><span class="w"> </span><span class="s2">" | "</span><span class="p">))</span><span class="w">
  
  </span><span class="n">try</span><span class="p">({</span><span class="w">
    </span><span class="n">current_user</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">getUser</span><span class="p">(</span><span class="n">current_sn</span><span class="p">)</span><span class="w"> </span><span class="c1"># this fails surprisingly often, not sure why</span><span class="w">
    </span><span class="n">follow_data_2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"screenName"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_sn</span><span class="w">
    
    </span><span class="c1"># who this user follows (what happens if this is eg 1million people? I think it gets truncated at 15,000,</span><span class="w">
    </span><span class="c1"># which is not as bad as it sounds as we only need a sample; but the problem will be that this is their</span><span class="w">
    </span><span class="c1"># 15,000 most recent people they have followed, who might be biased to be newcomers?):</span><span class="w">
    
    </span><span class="c1"># certain privacy settings stop you seeing someone's friends and followers, in which case</span><span class="w">
    </span><span class="c1"># we try to sample another node from the last good person</span><span class="w">
    </span><span class="n">all_my_friends</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">character</span><span class="p">()</span><span class="w">
    </span><span class="n">try</span><span class="p">(</span><span class="n">all_my_friends</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_user</span><span class="o">$</span><span class="n">getFriendIDs</span><span class="p">())</span><span class="w">          </span><span class="c1"># about 1 second for c.1500 IDs, longer for more</span><span class="w">
    </span><span class="k">if</span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">all_my_friends</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">){</span><span class="w">
      
      </span><span class="c1"># sample some of those friends</span><span class="w">
      </span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">min</span><span class="p">(</span><span class="m">2000</span><span class="p">,</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">all_my_friends</span><span class="p">))</span><span class="w">
      </span><span class="n">sample_my_friends</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="n">all_my_friends</span><span class="p">,</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w">
      </span><span class="n">friend_details</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lookupUsers</span><span class="p">(</span><span class="n">sample_my_friends</span><span class="p">)</span><span class="w">            </span><span class="c1"># about 15 seconds</span><span class="w">
      
      </span><span class="n">friend_details_df</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">twListToDF</span><span class="p">(</span><span class="n">friend_details</span><span class="p">)</span><span class="w">
      
      </span><span class="n">follow_data_2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"number_followers"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_user</span><span class="o">$</span><span class="n">followersCount</span><span class="w">
      </span><span class="n">follow_data_2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"number_following"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">current_user</span><span class="o">$</span><span class="n">friendsCount</span><span class="w">
      
      </span><span class="c1"># mean number of followers of the people this user follows</span><span class="w">
      </span><span class="n">follow_data_2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"mean_ff"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">friend_details_df</span><span class="o">$</span><span class="n">followersCount</span><span class="p">)</span><span class="w">
      </span><span class="n">follow_data_2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"trmean_ff"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">friend_details_df</span><span class="o">$</span><span class="n">followersCount</span><span class="p">,</span><span class="w"> </span><span class="n">tr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w">
      </span><span class="n">follow_data_2</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="s2">"median_ff"</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">median</span><span class="p">(</span><span class="n">friend_details_df</span><span class="o">$</span><span class="n">followersCount</span><span class="p">)</span><span class="w">
      
    </span><span class="p">}</span><span class="w">
  </span><span class="p">})</span><span class="w">
</span><span class="p">}</span></code></pre></figure>

<h2 id="results">Results</h2>

<p>The resulting numbers are all very skewed distributions.  Visually, they look good when you take the logarithm of the original number plus 1 (needed to avoid turning people with 0 friends or 0 followers becoming <code class="language-plaintext highlighter-rouge">-Inf</code>).  I can justify “+ 1” by saying that, in a way, everyone follows themself and is followed by themselves.</p>

<p>Here’s the distributions and relationships of the key variables, when transformed this way:</p>

<p><img src="/img/0118-pairs.png" width="100%" /></p>

<p>We see a strong positive relationship between number of your followers and number of people you are following - until we get to people with many followers (10,000 or more), when the relationship breaks down (visible only in the snowball sample, as the simpler “today’s tweeters” sampling method harvests few such people).  Partly this comes from reciprocal follow-back arrangements, partly it is a general indicator of longevity.</p>

<p>We also see a strongly negative relationship between number of people one is following and the average number of their followers.  This makes sense and fits in with the notion that if you want to be following people with lots of followers, you have to be quite selective in who you follow, and its best to follow big names in sport, entertainment and perhaps politics.  Consider Trump supporter <a href="https://twitter.com/TheRoyalPosts">@TheRoyalPosts</a> as an extreme example (not actually included in the final sample).  With 41,700 followers of her own, she follows only 120 prominent political accounts, with an astonishing average number of followers themselves of 7 million.</p>

<p>At this point let’s have another look at the graphic I started the post with:</p>

<p><img src="/img/0118-main-scatter.svg" width="100%" /></p>

<p>From these last couple of charts, I’m actually pretty happy with both of my sampling methods.</p>

<p>Here’s the code that combines the two samples and produces the graphics above.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#==================analysis========================</span><span class="w">

</span><span class="n">follow_data_proc</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">follow_data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">sampling_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Snowball sampling\nalong network"</span><span class="p">)</span><span class="w">

</span><span class="n">follow_data_proc_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">follow_data_2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">sampling_method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Sample of today's tweeters"</span><span class="p">)</span><span class="w"> 

</span><span class="n">follow_data_comb</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rbind</span><span class="p">(</span><span class="n">follow_data_proc</span><span class="p">,</span><span class="w"> </span><span class="n">follow_data_proc_2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">trmean_ff</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">screenName</span><span class="p">,</span><span class="w"> </span><span class="n">sampling_method</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="w">
    </span><span class="n">number_followers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">number_followers</span><span class="p">),</span><span class="w">
    </span><span class="n">number_following</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">number_following</span><span class="p">),</span><span class="w">
    </span><span class="n">mean_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">mean_ff</span><span class="p">),</span><span class="w">
    </span><span class="n">trmean_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">trmean_ff</span><span class="p">),</span><span class="w">
    </span><span class="n">median_ff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">median_ff</span><span class="p">),</span><span class="w">
    </span><span class="n">n_obs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">()</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">many_following</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cut</span><span class="p">(</span><span class="n">number_following</span><span class="p">,</span><span class="w"> </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">5000</span><span class="p">,</span><span class="w"> </span><span class="m">15000</span><span class="p">,</span><span class="w"> </span><span class="m">75000</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">9</span><span class="p">),</span><span class="w">
                              </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"0 - 1,000"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1,001 - 5,000"</span><span class="p">,</span><span class="w"> </span><span class="s2">"5,001 - 15,000"</span><span class="p">,</span><span class="w"> </span><span class="s2">"15,001 - 75,000"</span><span class="p">,</span><span class="w"> </span><span class="s2">"75,001 or more"</span><span class="p">)))</span><span class="w">

</span><span class="n">follow_data_trans</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">follow_data_comb</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">number_followers_l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log10</span><span class="p">(</span><span class="n">number_followers</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">
         </span><span class="n">number_following_l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log10</span><span class="p">(</span><span class="n">number_following</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w">
         </span><span class="n">trmean_ff_l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log10</span><span class="p">(</span><span class="n">trmean_ff</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">number_followers_l</span><span class="p">,</span><span class="w"> </span><span class="n">number_following_l</span><span class="p">,</span><span class="w"> </span><span class="n">trmean_ff_l</span><span class="p">,</span><span class="w"> </span><span class="n">sampling_method</span><span class="p">)</span><span class="w"> 

</span><span class="n">ggpairs</span><span class="p">(</span><span class="n">follow_data_trans</span><span class="p">,</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sampling_method</span><span class="p">))</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">follow_data_comb</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_followers</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">trmean_ff</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">sampling_method</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">many_following</span><span class="p">),</span><span class="w"> </span><span class="n">pch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">21</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"loess"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_log10</span><span class="p">(</span><span class="s2">"Number of followers, of this person"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_log10</span><span class="p">(</span><span class="s2">"Trimmed mean number of followers,\nof the people this person follows"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Do people with more followers follow people with more followers?"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Apparently 'it depends'."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_brewer</span><span class="p">(</span><span class="s2">"Following how\nmany people:"</span><span class="p">,</span><span class="w"> </span><span class="n">palette</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Spectral"</span><span class="p">,</span><span class="w">
                    </span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">title.hjust</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">override.aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">5</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"right"</span><span class="p">)</span></code></pre></figure>

<h2 id="modelling">Modelling</h2>

<p>Finally, I wanted to see if the apparent u-shaped relationship between number of followers and the average number of followers of people one follows was robust to a model that simultaneously modelled the strongly negative relationship between the number of people one follows and that same response variable.  It turns out that this is the case.  Here are the partial effects of the two variables in a generalized additive model without an interaction term:</p>

<p><img src="/img/0118-simple.svg" width="100%" /></p>

<p>And here is how the relationship looks when there is an interaction term.  First, as a three-dimensional perspective plot:</p>

<p><img src="/img/0118-persp.svg" width="100%" /></p>

<p>… then, more usefully as a heatmap.</p>

<p><img src="/img/0118-heatmap.svg" width="100%" /></p>

<p>The interaction is significant so we’d keep it in even though it complicates the interpretation.</p>

<p>I think the heatmap is the best representation of the data.  It shows clearly that the average number of followers of the people one follows is:</p>

<ul>
  <li>high for people with few followers</li>
  <li>high for people with many followers who <em>don’t</em> follow many themselves</li>
  <li>low for people with many followers who <em>do</em> follow lots of people themselves</li>
</ul>

<p>Additionally, there are are very few or no users who follow hundreds of thousands of accounts but have a low number of their own followers (hence the white space in the top left corner).</p>

<p>Here’s the code for the modelling:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">mod_full</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">trmean_ff_l</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">number_followers_l</span><span class="p">,</span><span class="w"> </span><span class="n">number_following_l</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">follow_data_trans</span><span class="p">)</span><span class="w">
</span><span class="n">mod_simp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">gam</span><span class="p">(</span><span class="n">trmean_ff_l</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">number_followers_l</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">s</span><span class="p">(</span><span class="n">number_following_l</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">follow_data_trans</span><span class="p">)</span><span class="w">
</span><span class="n">anova</span><span class="p">(</span><span class="n">mod_full</span><span class="p">,</span><span class="w"> </span><span class="n">mod_simp</span><span class="p">,</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"F"</span><span class="p">)</span><span class="w">

</span><span class="c1"># simple two variable model</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">font.main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">mod_simp</span><span class="p">,</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"No-interaction model"</span><span class="p">)</span><span class="w">  

</span><span class="c1"># perspective plot</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">mod_full</span><span class="p">,</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">scheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s2">"Impact on the trimmed mean number\nof followers of people that are followed"</span><span class="p">))</span><span class="w">

</span><span class="c1"># heat map</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">mod_full</span><span class="p">,</span><span class="w"> </span><span class="n">pages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">scheme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">hcolors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo.colors</span><span class="p">(</span><span class="m">50</span><span class="p">),</span><span class="w">
     </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s2">"Impact on the trimmed mean number\nof followers of people that are followed"</span><span class="p">),</span><span class="w">
     </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Logarithm of number of followers"</span><span class="p">,</span><span class="w">
     </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Logarithm of number people following"</span><span class="p">)</span><span class="w">
</span><span class="n">legend</span><span class="p">(</span><span class="s2">"topleft"</span><span class="p">,</span><span class="w"> </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"low"</span><span class="p">,</span><span class="w"> </span><span class="s2">"medium"</span><span class="p">,</span><span class="w"> </span><span class="s2">"high"</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">topo.colors</span><span class="p">(</span><span class="m">3</span><span class="p">),</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.2</span><span class="p">)</span></code></pre></figure>



		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2018/02/17/books-2017">Books I liked in 2017</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2018/03/20/truncated-poisson">Truncated Poisson distributions in R and Stan</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
			<p>My day job is Director of the <a href='https://sdd.spc.int/'>Statistics for Development Division</a> at the Pacific Community, the principal scientific and technical organisation in the Pacific region, proudly supporting development since 1947. We are an international development organisation owned and governed by our 27 country and territory members. This blog is not part of my role there and contains my personal views only.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="https://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="https://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics https://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>