      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Relative risk ratios and odds ratios</title>
      	
         
         
            <meta name ="description" content ="Explanation and demonstration with simulated data of the difference between relative risk ratios and odds ratios, and how to extract them from a generalized linear model.">
            <meta property="og:description" content ="Explanation and demonstration with simulated data of the difference between relative risk ratios and odds ratios, and how to extract them from a generalized linear model.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Relative risk ratios and odds ratios" />
         
            <meta property="og:image" content="http://freerangestats.info/img/0131-data.png" />
         
		 
			<meta property="og:url" content="http://freerangestats.info/blog/2018/08/17/risk-ratios.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
				  <li><a href = /blog/2019/04/07/fonts-and-stuff>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">election forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href = "/elections/oz/index.html">Australia federal 2019</a></li>
				  <li><a href = "/elections/combined.html">NZ 2016</a></li>
                  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Relative risk ratios and odds ratios</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>Explanation and demonstration with simulated data of the difference between relative risk ratios and odds ratios, and how to extract them from a generalized linear model.</p>
	   <p class="meta">17 Aug 2018</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <p>This post tries to explain the difference between odds ratios and relative risk ratios; and how just a few letters in the code fitting a generalized linear model mean the difference between extracting one or the other.  There are plenty of other explanations available (for example, <a href="https://www.theanalysisfactor.com/the-difference-between-relative-risk-and-odds-ratios/">here</a> and <a href="https://www.mdedge.com/jfponline/article/65515/relative-risks-and-odds-ratios-whats-difference">here</a>), but there is also still plenty of <a href="https://www.researchgate.net/post/When_should_we_use_a_risk_ratio_odds_ratio_and_relative_ratio_in_the_meta-analysis_to_compare_between_2_predictors_variables">confusion</a> about the differences.  I wanted to illustrate the issues with a concrete but simulated example and actual code that could be used as a foundation in the wild.</p>

<h2 id="concepts">Concepts</h2>

<p>Odds ratios and relative risk are commonly used to contrast the prevalence of some indicator (eg disease) in different categories of population.  They seem to get particular emphasis in medical and epidemiological literature but are used broadly.</p>

<p>Before we look at odds and risk <em>ratios</em>, let’s be clear on what odds and probabilities are <em>(this couple of paragraphs added on 20 August 2018)</em>.</p>

<ul>
  <li>A <em>probability</em> will be a familiar concept to readers of this blog.  Let’s say that one quarter of tigers are diseased.  If we pick a tiger at random, there is a 1/4 (or 0.25) probability that we pick a diseased one.  When picking something at random, a probability is the ratio of number of positive occurrences (treating “diseased” as a “positive”, in the clinical sense) divided by the number of <em>total possible occurrences</em>.</li>
  <li>The <em>odds</em> is instead the number of positive occurrences in relation to the number of <em>non positive occurrences</em>.  So while the tiger has a one in four probability of being diseased, we say the odds are “3 to 1” (or “1 to 3” - if you get these mixed up don’t worry, so does everyone else, just make sure you keep track of whether the “1” or the “3” is the thing you are worried about!).  For every one diseased tiger, there are three non-diseased tigers.  If you were gambling $10, you would want the bookie to pay you “3 to 1” in winnings ($30) on your wager (plus returning your original $10 stake) to make it worthwhile betting that a randomly chosen tiger had the disease.</li>
  <li>a <em>relative  risk ratio</em> is one probability divided by another; for example the probability of a tiger being diseased, divided by the probability of a bear being diseased.  A lot of confusion would be saved (in my view) if we could call these “probability ratios” instead, but the term “relative risk ratio” seems to be here to stay.</li>
  <li>an <em>odds ratio</em> is one set of odds divided by another; for example, the odds of a tiger being diseased, divided by the odds of a bear being diseased.</li>
</ul>

<p>This diagram demonstrates with some simulated data the core concepts:</p>

<p><img src="/img/0131-data.svg" width="100%" /></p>

<ul>
  <li>Tigers have a 1/4 (0.25) probability of being diseased, which is “1 to 3” odds of being diseased.</li>
  <li>Lions have a 1/2 (0.5) probability of being diseased, which is “1 to 1” or “even” odds.</li>
  <li>Bears have a 1/10 (0.1) probability of being diseased, which is “1 to 9” odds.</li>
</ul>

<p>I find the relative probabilities very intuitive - Tigers have 2.5 times the probability of being diseased as Bears, and Lions have 5 times the probability.</p>

<p>Odds ratios - not so much.  Even though I’m a statistician with a particular interest in games of chance (which form the genealogy of odds), I don’t really intuit how to interpret the Tiger to Bears odds ratio of 3 times the odds of being diseased.  In fact, there’s evidence that when scientific papers report odds ratios, they are <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1112884/">commonly misinterpreted as being risk ratios</a> (“People of type X are twice as likely to have the disease compared to people of type Y” being a common formulation).</p>

<p>When the probabilities are very close to zero, then odds ratios are similar to risk ratios.  The farther they get from zero, the more they differ, and the more dangerous it is if people misinterpret an odds ratio as a risk ratio.</p>

<p>The best argument for reporting odds ratios is that they are symmetric - whether you are reporting on presence or absence, the odds ratio is unaffected.  In our example above, if we looked at the probability of not being diseased, the Tigers:Bears odds ratio becomes 3:1 / 9:1 which is still a 3, whereas the relative probability is (3/4) / (9/10) which is  5/6 or 0.833.  So while it’s nice and intuitive to say Tigers are 2.5 times as likely as Bears to be diseased, they are 0.833 times as likely as Bears to be not-diseased.  This can lead to confusion.  The odds ratio is three both ways (or at least, 3 in one direction and 1/3 in the other).</p>

<p>Most situations where we want these statistics, I think relative risk ratios are much better, more intutitive, and easier to explain.  I don’t think the asymmetry matters much in most communications, whereas the misunderstanding of odds ratios often does.  Frequent misunderstanding of the target audience is a high price to pay for symmetry. And I’m not sure why symmetry is necessary anyway.</p>

<p>A balanced (in my view) and non-paywalled article on the topic (which has generated many) is <a href="https://jamanetwork.com/journals/jamapediatrics/fullarticle/381459">this one by Cummings in JAMA Pediatrics</a>.</p>

<p>Before we go onto to getting these estimates from a fitted model, here’s the R code that created that simulated data and the graphic:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">viridis</span><span class="p">)</span><span class="w">

</span><span class="n">set.seed</span><span class="p">(</span><span class="m">765</span><span class="p">)</span><span class="w">
</span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100000</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_frame</span><span class="p">(</span><span class="w">
  </span><span class="n">animal_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"lion"</span><span class="p">,</span><span class="w"> </span><span class="s2">"tiger"</span><span class="p">,</span><span class="w"> </span><span class="s2">"bear"</span><span class="p">),</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.2</span><span class="p">,</span><span class="w"> </span><span class="m">0.3</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w">
</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">diseased</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
    </span><span class="n">animal_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"lion"</span><span class="w">  </span><span class="o">~</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">)),</span><span class="w">
    </span><span class="n">animal_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"tiger"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.75</span><span class="p">,</span><span class="w"> </span><span class="m">0.25</span><span class="p">)),</span><span class="w">
    </span><span class="n">animal_</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"bear"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">sample</span><span class="p">(</span><span class="m">0</span><span class="o">:</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">prob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0.9</span><span class="p">,</span><span class="w"> </span><span class="m">0.1</span><span class="p">))</span><span class="w">
  </span><span class="p">))</span><span class="w"> 

</span><span class="n">true_props</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">animal_</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">diseased</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">diseased</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">odds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"1:9"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1:1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"1:3"</span><span class="p">),</span><span class="w">
         </span><span class="n">lab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="s2">"Probability: "</span><span class="p">,</span><span class="w"> </span><span class="n">diseased</span><span class="p">,</span><span class="w"> </span><span class="s2">"\nOdds: "</span><span class="p">,</span><span class="w"> </span><span class="n">odds</span><span class="p">))</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.logical</span><span class="p">(</span><span class="n">diseased</span><span class="p">),</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">animal_</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"fill"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_text</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">true_props</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lab</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diseased</span><span class="p">),</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Proportion"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Diseased or not:"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">guides</span><span class="p">(</span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Simulated data for demonstrating odds and risk ratios"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Risk ratio:    tiger / bear = 2.5,   lion / bear = 5.0\nOdds ratio:   tiger / bear = 3.0,   lion / bear = 9.0"</span><span class="p">)</span></code></pre></figure>

<h2 id="obtaining-odds-and-risk-ratios-from-a-generalized-linear-model">Obtaining odds and risk ratios from a generalized linear model</h2>

<p>Putting that aside, how do we get these estimates from a model?</p>

<h3 id="odds-ratios">Odds ratios</h3>

<p>Frankly, I suspect the more material reason for the prevalence of odds ratios is that they fall easily out of the results of a logistic regression (generalized linear model with the canonical logit link function relating the mean of the response to the linear predictor - where the logit function is the logarithm of the odds).  For a categorical explanatory variable that has been represented as dummy indicator variables, <em>e</em> to the power of the coefficient for the dummy variable will give an estimate of the odds ratio.</p>

<p>Here’s an example of extracting estimates of odds ratios from our data:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Odds ratio:
</span><span class="n">model_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">diseased</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">animal_</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quasibinomial</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">
</span><span class="nf">exp</span><span class="p">(</span><span class="n">coef</span><span class="p">(</span><span class="n">model_2</span><span class="p">))[</span><span class="m">-1</span><span class="p">]</span><span class="w">

</span><span class="c1">#  animal_lion animal_tiger 
#     9.286664     2.997837 
</span><span class="err">#</span></code></pre></figure>

<p>These odds ratios are of the given animal (Lion or Tiger) relative to the disease rate of the reference level, which in this case is Bear.  So these are estimates of the ratios depicted in the original diagram.</p>

<p>You would get the same point estimate if you used <code class="highlighter-rouge">family = binomial</code>, or <code class="highlighter-rouge">family = quasi(link = 'logit', variance = "mu(1-mu)")</code>; it’s the logit link that’s important here.</p>

<p>Note that these estimates are biased; despite being based on large samples of 100,000 animals they haven’t converged on the true odds ratios of 9 and 3.  The estimates of the original coefficients are unbiased; but the non-linear transformation of <code class="highlighter-rouge">exp(coef(model))</code> inevitably introduces bias.  A statistic that is unbiased on one scale will be biased if you transform it to another scale; such is life.</p>

<p>Using <code class="highlighter-rouge">binomial</code> versus <code class="highlighter-rouge">quasibinomial</code> does make a difference to confidence intervals, but in our current case it’s not material.  The confidence intervals at least contain the correct values; although the point estimate is biased (and also not in the centre of the confidence interval, again due to the non-linear transformation), the confidence interval is still valid for the transformed scale:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="nf">exp</span><span class="p">(</span><span class="n">confint</span><span class="p">(</span><span class="n">model_2</span><span class="p">))[</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">

</span><span class="c1">#                 2.5 %   97.5 %
# animal_lion  8.920358 9.669207
# animal_tiger 2.881889 3.118685
</span><span class="err">#</span></code></pre></figure>

<h3 id="risk-ratios">Risk ratios</h3>

<p>At a minimum, the <em>only</em> change that needs to be done to get risk ratios is to change the link function that relates the mean value of the response variable to the linear predictor.  For estimates of odds ratios, this is logit (ie the logarithm of the odds of the mean); for estimates of relative risk ratios, this becomes logarithm.  We can specify this manually, or just use a built-in family for our generalized linear model for which the logarithm is the canonical link fucntion, and hence the default.  The <code class="highlighter-rouge">quasipoisson</code> is a great choice here:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Risk ratio:
</span><span class="n">model_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">glm</span><span class="p">(</span><span class="n">diseased</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">animal_</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">quasipoisson</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data</span><span class="p">)</span><span class="w">
</span><span class="nf">exp</span><span class="p">(</span><span class="n">coef</span><span class="p">(</span><span class="n">model_1</span><span class="p">))[</span><span class="m">-1</span><span class="p">]</span><span class="w">

</span><span class="c1">#  animal_lion animal_tiger 
#     5.112507     2.504792 
</span><span class="err">#</span></code></pre></figure>

<p>Again, these point estimates are biased because of the non-linear <code class="highlighter-rouge">exp()</code> transformation of the unbiased original coefficients.  But the confidence intervals contain the correct values (which recall are 5.0 and 2.5):</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="nf">exp</span><span class="p">(</span><span class="n">confint</span><span class="p">(</span><span class="n">model_1</span><span class="p">))[</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w">

</span><span class="c1">#                 2.5 %   97.5 %
# animal_lion  4.961963 5.268162
# animal_tiger 2.426520 2.585758
</span><span class="err">#</span></code></pre></figure>

<p>If we’d used <code class="highlighter-rouge">poisson</code> as our family instead of <code class="highlighter-rouge">quasipoisson</code>, the dispersion parameter is forced to be 1.0, instead of 0.7 which it is estimated to be by the <code class="highlighter-rouge">quasipoisson</code> model.  The net effect of that “underdispersion” in the data in this case is that the confidence intervals with <code class="highlighter-rouge">family = poisson</code> are <em>larger</em> than in the <code class="highlighter-rouge">quasipoisson</code> instance.  This won’t always apply, but it often will when we are modelling data such as this which is, in fact under-dispersed compared to a pure poisson distribution (because none of the counts can exceed 1).</p>

<p>These examples have avoided complications of other explanatory variables, but the point of using a generalized linear model for this (rather than observing proportions directly) is that we can add in other variables and report on relative risks (or odds, if we must) “while controlling for …” those other variables.</p>

<p>The approach also <a href="http://grokbase.com/t/r/r-help/109dad6km5/r-relative-risk-regression-with-survey-data">nicely extends to complex surveys</a>; we can use <code class="highlighter-rouge">svyglm()</code> from Lumley’s <code class="highlighter-rouge">survey</code> package, with any of the <code class="highlighter-rouge">family</code> specifications above, according to our needs and get good results.</p>

<h2 id="summary">Summary</h2>

<p>So, key points;</p>

<ul>
  <li>carefully choose which (or both) of odds or risk ratios to use</li>
  <li>explicitly communicate what you are reporting, and try to counter in your communication the likely misunderstandings particularly with odds ratios</li>
  <li><code class="highlighter-rouge">exp(coef(model))</code> for a glm fit with <code class="highlighter-rouge">family = quasibinomial</code> will give odds ratios</li>
  <li><code class="highlighter-rouge">exp(coef(model))</code> for a glm fit with <code class="highlighter-rouge">family = quasipoisson</code> will give relative risk ratios</li>
  <li>remember that point estimates from this approach are biased, and like all point estimates give an undue impression of precision; always include a confidence interval or credibility interval as well.</li>
</ul>

<h3 id="modification-history">Modification history</h3>

<p>Modified on 20 August 2018 to add definition of “odds” and of “probability”.</p>


		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2018/08/14/fuel-prices">Time series intervention analysis with fuel prices</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2018/08/24/simulating-survey">Estimating relative risk in a simulated complex survey</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics
http://Http://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>