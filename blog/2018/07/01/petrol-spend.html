      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Spend on petrol by income</title>
      	
         
         
            <meta name ="description" content ="I explore the relationship between household income and expenditure on gasoline and motor oil in the USA Bureau of Labor Statistics' Consumer Expenditure Survey.">
            <meta property="og:description" content ="I explore the relationship between household income and expenditure on gasoline and motor oil in the USA Bureau of Labor Statistics' Consumer Expenditure Survey.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Spend on petrol by income" />
         
            <meta property="og:image" content="https:/freerangestats.info/img/0124-scatter-1.png" />
         
		 
			<meta property="og:url" content="https://freerangestats.info/blog/2018/07/01/petrol-spend.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
	        <!--	  <li><a href="/blog/most-popular.html">ordered by popularity</a></li> -->
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2025/08/23/timeuse-technical>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Spend on petrol by income</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>I explore the relationship between household income and expenditure on gasoline and motor oil in the USA Bureau of Labor Statistics' Consumer Expenditure Survey.</p>
	   <p class="meta">01 Jul 2018</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <h2 id="fuel-tax-debates">Fuel tax debates</h2>
<p>So, there’s currently a <a href="https://twitter.com/simonbwilson/status/1012792274332233728">vibrant debate on a small New Zealandish corner of Twitter</a> about a petrol tax coming into effect in Auckland today, and the different impacts of such taxes on richer and poorer households.</p>

<p>The Government has released analysis from the Stats NZ Household Expenditure Survey <a href="https://www.nzherald.co.nz/nz/news/article.cfm?c_id=1&amp;objectid=12078915">showing higher petrol consumption per household for higher income households</a> (and hence paying more of the new tax).  <a href="https://twitter.com/Economissive/status/1012944031469338625">Sam Warburton, an economist with the New Zealand Institute, argues in response</a> that poorer households have older, often larger, less efficient vehicles, leading to higher fuel costs per kilometre.  This means a fuel tax will not only result in poor people paying more as a percentage of their income (as any sales tax on basic commodities will do), but paying more <em>per kilometre</em>.  Further, poor people are more likely to live out of the big urban centres, and when in an urban area are less likely to be well serviced by public transport.</p>

<p>Mr Warburton also argues that the results from the Household Expenditure Survey are misleading because they include “people who can’t afford or otherwise don’t own cars”.  <a href="https://twitter.com/Economissive/status/981306458699476992">His own analysis </a> from the Ministry of Transport’s Household Travel Survey shows that households including two or more children, with Māori, with unemployed people, or in the poorer regions all pay more tax per kilometre.</p>

<p>I’m totally convinced by Mr Warburton on the argument that poorer people are paying more tax per kilometre, which makes a fuel tax a particularly <a href="https://en.wikipedia.org/wiki/Regressive_tax">regressive tax</a>. Even paying the same rate per kilometre would be regressive because transport costs are a higher proportion of income for poorer people; so more tax <em>per kilometre</em> is really rubbing salt into the wound.  I’m not convinced though by the suggestion that they will pay more of the new tax even in absolute terms; I’m inclined to trust the Household Economic Survey on this one.</p>

<h2 id="the-usa-consumer-expenditure-survey">The USA Consumer Expenditure Survey</h2>

<p>One good thing about this debate was it motivated me to do something that’s been on my list for a while, which is to get my toes in the water with the USA Bureau of Labor Statistics’ impressive <a href="https://www.bls.gov/cex/home.htm">Consumer Expenditure Survey</a>.  Huge amounts of confidentialised microdata from this mammoth program are freely available for download - without even filling in any forms!  This makes it suitable to use in a blog post in a way I couldn’t with the New Zealand or Australian Household Expenditure Surveys (both of which have Confidentialised Unit Record Files for researchers, but with restrictions that get in the way of quick usage in public like this).</p>

<p>Big caveat for what follows - literally I looked at this survey for the first time today, and it is <em>very complex</em>.  Just for starters, the Consumer Expenditure Survey really <a href="https://www.bls.gov/cex/">comprises two surveys</a> - an Interview Survey for “major and/or recurring items” and the Diary Survey for “minor or frequently purchased items”.  It is very possible that I am using not-the-best variables.  Feedback welcomed.</p>

<h3 id="densities-of-income-and-fuel-spend">Densities of income and fuel spend</h3>

<p>Let’s get started by downloading the data.  Here’s a couple of graphs of what I think are the main variables of interest here.  These draw on:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">gasmocq</code> “Gasoline and motor oil this quarter”</li>
  <li><code class="language-plaintext highlighter-rouge">fincbtxm</code> “Total amount of family income - imputed or collected” (in the past 12 months? although the data dictionary only implies this)</li>
  <li><code class="language-plaintext highlighter-rouge">fam_size</code> “Number of Members in CU” (ie in responding household)</li>
  <li><code class="language-plaintext highlighter-rouge">bls_urbn</code> “Is this CU located in an urban or a rural area”</li>
</ul>

<p><img src="/img/0124-densities.svg" width="100%" /></p>

<p><img src="/img/0124-densities-inc.svg" width="100%" /></p>

<p>Both these graphics are showing a quantity divided by household size to get a simple estimate of amount per person.  A better approach would be to used equivalised figures, taking into account economies of scale for larger households and different cost structures for different age groups, but it probably would have taken me all morning just to work out a safe way of doing that so I’ve stuck with the simpler method.</p>

<p>Both these graphics - and most of those that follow - also use <a href="/blog/2015/09/05/creating-a-scale-transformation">John and Draper’s modulus transform that I wrote about in some of my first ever posts on this blog</a>.  It’s a great way to effectively visualise heavily skewed data that has zero and negative values as well as positive, a common occurrence with economic variables.  The helper functions for the transformation are available in my bag-of-misc R package <code class="language-plaintext highlighter-rouge">frs</code> available from GitHub.</p>

<p>Here’s code to do that download, prepare the data for later and draw graphs:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># mandatory reading: https://www.bls.gov/cex/pumd_novice_guide.pdf</span><span class="w">

</span><span class="n">library</span><span class="p">(</span><span class="n">haven</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">frs</span><span class="p">)</span><span class="w">    </span><span class="c1"># for modulus transforms of scales</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span><span class="w">   </span><span class="c1"># for rlm.  Watch out for dplyr::select and MASS::select clash.</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggExtra</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">survey</span><span class="p">)</span><span class="w">

</span><span class="c1"># download the latest year's data (caution - 71MB):</span><span class="w">
</span><span class="n">dir.create</span><span class="p">(</span><span class="s2">"bls-cd"</span><span class="p">)</span><span class="w">
</span><span class="n">download.file</span><span class="p">(</span><span class="s2">"https://www.bls.gov/cex/pumd/data/stata/intrvw16.zip"</span><span class="p">,</span><span class="w">
              </span><span class="n">destfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bls-cd/intrvw16.zip"</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wb"</span><span class="p">)</span><span class="w">

</span><span class="c1"># download the data dictionary</span><span class="w">
</span><span class="n">download.file</span><span class="p">(</span><span class="s2">"https://www.bls.gov/cex/pumd/ce_pumd_interview_diary_dictionary.xlsx"</span><span class="p">,</span><span class="w">
              </span><span class="n">destfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bls-cd/ce_pumd_interview_diary_dictionary.xlsx"</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wb"</span><span class="p">)</span><span class="w">

</span><span class="n">unzip</span><span class="p">(</span><span class="s2">"bls-cd/intrvw16.zip"</span><span class="p">,</span><span class="w"> </span><span class="n">exdir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"bls-cd"</span><span class="p">)</span><span class="w">

</span><span class="c1"># The FMLI files have characteristics, income, weights, and summary expenditure</span><span class="w">
</span><span class="c1"># the numbers in file names refer to year and quarter.  So intrvw16/fmli162.dta is </span><span class="w">
</span><span class="c1"># 2016, second quarter</span><span class="w">

</span><span class="c1"># Import 2017 first quarter:</span><span class="w">
</span><span class="n">fmli171</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_dta</span><span class="p">(</span><span class="s2">"bls-cd/intrvw16/fmli171.dta"</span><span class="p">)</span><span class="w">

</span><span class="c1"># looks like no attributes associated with the various columns; have to use the Excel data dictionary</span><span class="w">
</span><span class="n">str</span><span class="p">(</span><span class="nf">attributes</span><span class="p">(</span><span class="n">fmli171</span><span class="p">))</span><span class="w">
</span><span class="nf">attr</span><span class="p">(</span><span class="n">fmli171</span><span class="p">,</span><span class="w"> </span><span class="s2">"labels"</span><span class="p">)</span><span class="w">
</span><span class="nf">attr</span><span class="p">(</span><span class="n">fmli171</span><span class="p">,</span><span class="w"> </span><span class="s2">"label"</span><span class="p">)</span><span class="w">

</span><span class="c1"># which columns are  numeric, candidates to hold income and expenditure non-binned data:</span><span class="w">
</span><span class="n">formats</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sapply</span><span class="p">(</span><span class="n">fmli171</span><span class="p">,</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="nf">attr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="s2">"format.stata"</span><span class="p">)})</span><span class="w">
</span><span class="n">formats</span><span class="p">[</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"[0-9]g"</span><span class="p">,</span><span class="w"> </span><span class="n">formats</span><span class="p">)]</span><span class="w">

</span><span class="c1"># Bit of basic processing for convenience.  Make a new data frame called d with some labels we need later,</span><span class="w">
</span><span class="c1"># and the per person variables calculated in one place.  </span><span class="w">
</span><span class="c1"># First, the code labels for income classes:</span><span class="w">
</span><span class="n">inclasses</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Less than $5,000"</span><span class="p">,</span><span class="w"> </span><span class="s2">"$5,000 to $9,999"</span><span class="p">,</span><span class="w"> </span><span class="s2">"$10,000 to $14,999"</span><span class="p">,</span><span class="w"> </span><span class="s2">"$15,000 to $19,999"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"$20,000 to $29,999"</span><span class="p">,</span><span class="w"> </span><span class="s2">"$30,000 to $39,999"</span><span class="p">,</span><span class="w"> </span><span class="s2">"$40,000 to $49,999"</span><span class="p">,</span><span class="w"> </span><span class="s2">"$50,000 to $69,999"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"$70,000 and over"</span><span class="p">)</span><span class="w">

</span><span class="n">inclass_lu</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_frame</span><span class="p">(</span><span class="w">
  </span><span class="n">inclass</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">9</span><span class="p">),</span><span class="w">
  </span><span class="n">inclass_ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ordered</span><span class="p">(</span><span class="n">inclasses</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inclasses</span><span class="p">)</span><span class="w">
</span><span class="p">)</span><span class="w"> 

</span><span class="c1"># create the working version of the data frame:</span><span class="w">
</span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fmli171</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">gas_pp</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">gasmocq</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">fam_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w">
         </span><span class="n">inc_pp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fincbtxm</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">fam_size</span><span class="p">,</span><span class="w">
         </span><span class="n">gas_p_inc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gasmocq</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">fincbtxm</span><span class="p">,</span><span class="w">
         </span><span class="n">no_gas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.integer</span><span class="p">(</span><span class="n">gas_pp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w">
         </span><span class="n">bls_urbn_ch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">bls_urbn</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"Urban"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Rural"</span><span class="p">),</span><span class="w">
         </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">inclass_lu</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"inclass"</span><span class="p">)</span><span class="w">


</span><span class="c1"># parameter for how much to transform the dollar scales:</span><span class="w">
</span><span class="n">lambda</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">0.2</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gas_pp</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bls_urbn_ch</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_density</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dollar</span><span class="p">,</span><span class="w">
                     </span><span class="n">trans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_trans</span><span class="p">(</span><span class="n">lambda</span><span class="p">),</span><span class="w">
                     </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_breaks</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_rug</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Spend on petrol has a spike at $0 and a skewed distribution beyond that"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Unweighted, 2017 quarter 1. Horizontal scale has been transformed."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: USA Bureau of Labor Statistics Consumer Expenditure Survey"</span><span class="p">,</span><span class="w">
       </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Expenditure per person on gasoline and motor oil this quarter x 4"</span><span class="p">)</span><span class="w">

</span><span class="c1"># some looks at various variables as described in the Excel data dictionary:</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">cuincome</span><span class="p">)</span><span class="w"> </span><span class="c1"># total income; not present</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">earnincx</span><span class="p">)</span><span class="w"> </span><span class="c1"># earnings before tax; not present</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">earncomp</span><span class="p">)</span><span class="w">   </span><span class="c1"># composition of earners</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">cutenure</span><span class="p">)</span><span class="w">   </span><span class="c1"># housing tenure (6 categories)</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">inclass</span><span class="p">)</span><span class="w">    </span><span class="c1"># income bracket</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">inc_rank</span><span class="p">)</span><span class="w"> </span><span class="c1"># Weighted cumulative percent ranking based on total current income before taxes (for complete income reporters)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">othrincm</span><span class="p">)</span><span class="w"> </span><span class="c1"># other income</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">ffrmincx</span><span class="p">)</span><span class="w"> </span><span class="c1"># farm income, not present</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">fincbtax</span><span class="p">)</span><span class="w"> </span><span class="c1"># total amount of family income before taxes in the past 12 months</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">fmli171</span><span class="o">$</span><span class="n">finlwt21</span><span class="p">)</span><span class="w"> </span><span class="c1"># final calibrated weight</span><span class="w">

</span><span class="n">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inc_pp</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bls_urbn_ch</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_density</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_rug</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"After imputation, income has a skewed distribution with no spike at zero"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Unweighted, 2017 quarter 1. Horizontal scale has been transformed."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dollar</span><span class="p">,</span><span class="w">
                     </span><span class="n">trans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_trans</span><span class="p">(</span><span class="n">lambda</span><span class="p">),</span><span class="w">
                     </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_breaks</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: USA Bureau of Labor Statistics Consumer Expenditure Survey"</span><span class="p">,</span><span class="w">
       </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
       </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Family income per person before taxes in the past 12 months"</span><span class="p">)</span></code></pre></figure>

<h3 id="relationship-of-income-and-fuel-spend">Relationship of income and fuel spend</h3>

<p>Here are some different ways of looking at the relationship between household income and the amount spent on fuel.  They all show a lot of variation between individual households, but significant evidence of a material positive relationship between the two.</p>

<p>First, here’s a graph that tries to combine the binned “income classification” with the ranking of the household  on income(ie its quantile if you like).  The categories aren’t as neat as might be expected, I’m pretty sure because of these variables representing different states of imputation:</p>

<p><img src="/img/0124-quantile.svg" width="100%" /></p>

<p>The collection of people who don’t spend any money on petrol drags the regression line downwards, but it’s the slope that counts; definitely upwards.  The higher ranked a household is on income, the more they spend per person on gasoline and motor oil.</p>

<p>BTW, note that the points in these plots are different sizes.  The size is mapped to the calibrated survey weight indicating how many people in the US population each sample point is representing; this is a good starting point for trying to represented weighted data in a scatter plot.</p>

<p>I’m wary of using quantiles or rankings in this sort of analysis; I don’t see much or any gain over other transformations and new risks and interpretability problems are introduced.  Perhaps more usefully, here are some straightforward scatterplots of income per person and vehicle fuel expenditure per person:</p>

<p><img src="/img/0124-scatter-1.svg" width="100%" /></p>

<p><img src="/img/0124-scatter-2.svg" width="100%" /></p>

<p>No doubt about that strong relationship; poorer households spend less on fuel (and nearly everything else, of course, although that’s not shown) than do richer households.</p>

<p>On the other hand, there’s equally no doubt that poorer households spend more on fuel as a proportion of their income:</p>

<p><img src="/img/0124-props.svg" width="100%" /></p>

<p>Here’s the code for those four graphics:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#-----------income quantile v fuel scatter plot-------------------</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gas_pp</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inc_rank</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finlwt21</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inclass_ch</span><span class="p">),</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rlm"</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finlwt21</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dollar</span><span class="p">,</span><span class="w">
                     </span><span class="n">trans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_trans</span><span class="p">(</span><span class="n">lambda</span><span class="p">),</span><span class="w">
                     </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_breaks</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Income quantile"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Spend on petrol increases as income quantile of the household increases"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Blue line shows robust regression using M estimator.  Vertical axis is transformed."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: USA Bureau of Labor Statistics Consumer Expenditure Survey"</span><span class="p">,</span><span class="w">
       </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str_wrap</span><span class="p">(</span><span class="s2">"Income class of household based on income before taxes"</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">),</span><span class="w">
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Expenditure per person on gasoline and motor oil this quarter"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"right"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">guides</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">override.aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_size_area</span><span class="p">(</span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="w">

</span><span class="c1">#-----------scatter plots----------------</span><span class="w">
</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ggplot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inc_pp</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gas_pp</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finlwt21</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rlm"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="s2">"Income per person in household in past 12 months"</span><span class="p">,</span><span class="w">
                     </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dollar</span><span class="p">,</span><span class="w">
                     </span><span class="n">trans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_trans</span><span class="p">(</span><span class="n">lambda</span><span class="p">),</span><span class="w">
                     </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_breaks</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dollar</span><span class="p">,</span><span class="w">
                     </span><span class="n">trans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_trans</span><span class="p">(</span><span class="n">lambda</span><span class="p">),</span><span class="w">
                     </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_breaks</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Spend on petrol increases as income of the household increases"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Blue line shows robust regression using M estimator.  Both axes are transformed."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: USA Bureau of Labor Statistics Consumer Expenditure Survey"</span><span class="p">,</span><span class="w">
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Expenditure per person on gasoline and motor oil this quarter x 4"</span><span class="p">)</span><span class="w"> 

  
</span><span class="n">ggMarginal</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"density"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w">

</span><span class="n">ggMarginal</span><span class="p">(</span><span class="n">p</span><span class="w"> </span><span class="o">%+%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">gas_pp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">inc_pp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> 
           </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"density"</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">)</span><span class="w">

</span><span class="c1">#-----------proportion spent on fuel-------------		   </span><span class="w">
</span><span class="n">d</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">inc_pp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1000</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inc_pp</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gas_p_inc</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finlwt21</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="s2">"Income per person in household in past 12 months"</span><span class="p">,</span><span class="w">
                     </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dollar</span><span class="p">,</span><span class="w">
                     </span><span class="n">trans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_trans</span><span class="p">(</span><span class="n">lambda</span><span class="p">),</span><span class="w">
                     </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_breaks</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_cartesian</span><span class="p">(</span><span class="n">ylim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Poorer households spend more on petrol proportionately than do richer households"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: USA Bureau of Labor Statistics Consumer Expenditure Survey"</span><span class="p">,</span><span class="w">
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Expenditure per person on gasoline and motor oil\nas a proportion of income"</span><span class="p">)</span><span class="w"> </span></code></pre></figure>

<h3 id="who-is-likely-to-spend-nothing-on-petrol-at-all">Who is likely to spend nothing on petrol at all?</h3>

<p>Finally, I was interested in who spends nothing on petrol at all.  This relates to Mr Warburton’s argument that the New Zealand Household Economic Survey if flawed for these purposes because the average spend on petrol includes people who have been priced out of vehicles altogether.  In fact, with the US data, there is a very strong negative relationship between household income and the probability of spending zero on gasoline and motor oil.:</p>

<p><img src="/img/0124-no-gas.svg" width="100%" />
<img src="/img/0124-no-gas2.svg" width="100%" /></p>

<p>However, as the previous scatterplots showed, removing either or both of the zero income and zero fuel spend cases from the US Consumer Expenditure survey doesn’t serve to remove the relationship between income and gasoline spend.</p>

<p>Finally, here’s the code for this last bit of analysis:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">p1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inc_pp</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">no_gas</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">finlwt21</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"glm"</span><span class="p">,</span><span class="w"> </span><span class="n">method.args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"binomial"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="s2">"Income per person in household in past 12 months"</span><span class="p">,</span><span class="w">
                     </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dollar</span><span class="p">,</span><span class="w">
                     </span><span class="n">trans</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_trans</span><span class="p">(</span><span class="n">lambda</span><span class="p">),</span><span class="w">
                     </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">modulus_breaks</span><span class="p">(</span><span class="n">lambda</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Probability of spending $0 on gasoline and motor oil this quarter\n"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"none"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: USA Bureau of Labor Statistics Consumer Expenditure Survey 2017 Q1"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Poorer households are more likely to spend nothing on petrol at all"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Blue line shows logistic regression; points show American households"</span><span class="p">)</span><span class="w">

</span><span class="n">print</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span><span class="w">

</span><span class="n">p2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">p1</span><span class="w"> </span><span class="o">%+%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">inc_pp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="s2">"Effect holds even if restricted to households with positive income"</span><span class="p">)</span><span class="w">
</span><span class="n">print</span><span class="p">(</span><span class="n">p2</span><span class="p">)</span><span class="w">

</span><span class="c1"># Check out the relationship with slightly more formal modelling than just on the fly in the graphic.</span><span class="w">
</span><span class="c1"># crude approximation of the survey design, that takes just the primary sampling units and weights</span><span class="w">
</span><span class="c1"># into account but ignores the stratification and post-stratification calibration (this will be</span><span class="w">
</span><span class="c1"># conservative for inference so that's ok).  </span><span class="w">
</span><span class="c1"># Also, better would be to transform `inc_pp`, or use a gam, or something.  This will do for now!</span><span class="w">
</span><span class="n">dd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">svydesign</span><span class="p">(</span><span class="o">~</span><span class="n">psu</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">finlwt21</span><span class="p">)</span><span class="w">

</span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">svyglm</span><span class="p">(</span><span class="n">no_gas</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">inc_pp</span><span class="p">,</span><span class="w"> </span><span class="n">design</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dd</span><span class="p">,</span><span class="w"> </span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"quasibinomial"</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span></code></pre></figure>

<p>Just as I was finalising this post, <a href="https://twitter.com/Thoughtfulnz/status/1013288397392117760">new discussion started</a> suggesting the American Time Use Survey as a good source of microdata to directly analyse the question of whether poorer households travel more or less.  Looks a good topic to come back to at some point.</p>



		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2018/06/26/fertility-rate">Demography simulations</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2018/07/07/twitter-monitor">Setting up RStudio Server, Shiny Server and PostgreSQL</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<p>Find me on <a rel="me" href="https://bsky.app/profile/freerangestats.info">Bluesky</a> or <a rel="me" href="https://mastodon.social/@peter_ellis">Mastodon</a>.</p>
			<hr></hr>
			
			<p>My day job is Director of the <a href='https://sdd.spc.int/'>Statistics for Development Division</a> at the Pacific Community, the principal scientific and technical organisation in the Pacific region, proudly supporting development since 1947. We are an international development organisation owned and governed by our 27 country and territory members. This blog is not part of my role there and contains my personal views only.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="https://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="https://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics https://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>