      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Dynamic Stochastic General Equilibrium models made (relatively) easy with R</title>
      	
         
         
            <meta name ="description" content ="The gEcon R package makes it (relatively) easy to define and calibrate Computable General Equilibrium models and their more nuanced next-generation successors, Dynamic Stochastic General Equilibrium models.">
            <meta property="og:description" content ="The gEcon R package makes it (relatively) easy to define and calibrate Computable General Equilibrium models and their more nuanced next-generation successors, Dynamic Stochastic General Equilibrium models.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Dynamic Stochastic General Equilibrium models made (relatively) easy with R" />
         
            <meta property="og:image" content="http://ellisp.github.io/img/0031-irf.png" />
         
		 
			<meta property="og:url" content="http://freerangestats.info/blog/2016/02/20/DSGE.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2021/02/05/stock-visualizations>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Dynamic Stochastic General Equilibrium models made (relatively) easy with R</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>The gEcon R package makes it (relatively) easy to define and calibrate Computable General Equilibrium models and their more nuanced next-generation successors, Dynamic Stochastic General Equilibrium models.</p>
	   <p class="meta">20 Feb 2016</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <h2 id="general-equilibrium-economic-models">General Equilibrium economic models</h2>
<p>To expand my economics toolkit I’ve been trying to get my head around <a href="https://en.wikipedia.org/wiki/Computable_general_equilibrium">Computable General Equilibrium (CGE)</a> and <a href="https://en.wikipedia.org/wiki/Dynamic_stochastic_general_equilibrium">Dynamic Stochastic General Equilibrium (DSGE)</a> models.  Both classes of model are used in theoretical and policy settings to understand the impact of changes to an economic system on its equilibrium state.</p>

<p>I’m not a specialist in this area so the below should be taken as the best effort by a keen amateur.  Corrections or suggestions welcomed!</p>

<p>CGE models have the simpler approach of the two and a longer history and have been very widely applied to practical policy questions such as the impact of trade deals.  Many economic consultancies have their own in-house CGE model/s which they wheel out and aadapt to a range of their clients’ questions.  They work by comparing static equilibrium states, assumed to meet requirements (such as markets clearing effectively instantly) needed to be in equilibrium, “calibrated” to the real economy by choosing a set of numbers for the various parameters that match the state of the economy at a particular point in time.  The model is then adjusted - for example, to allow for changes in prices from a free trade agreement - and the new equilibrium compared to the old.</p>

<p>DSGE models are also based on an assumption of a steady state equilibrium of the economy, but they allow for real amounts of time being taken to move towards that steady state, and for a random (ie stochastic) element in the path taken towards that steady state.  This greatly improves their coherence in terms of philosophy of science - compared to a CGE which simply calibrates to a single point of time and doesn’t have any degrees of freedom to quantify uncertainty or the fit of the model to reality, the parameters in DSGEs can be estimated based on a history of observations, and parameters can have probability distributions not just points.  Parameters are typically estimated with Bayesian methods.</p>

<p>Over the past 15 years or so as the maths and computing has gotten better, the DSGE approach has become dominant in macroeconomic modelling, although not yet (to my observation) in everyday applied economics of the sort done by consultants for government agencies contemplating policy choices.  DSGE models perform ok (to the degree that anything does) at economic forecasting, and give a nice coherent framework for considering policy options.  For example, the Reserve Bank of New Zealand (like many if not all monetary authorities around the world - I haven’t counted) developed the cutely-named <a href="http://www.rbnz.govt.nz/research-and-publications/research-programme/additional-research/kitt---a-dsge-model-for-forecasting-and-policy-analysis">KITT (Kiwi Inflation Targeting Technology)</a> DSGE model and adopted it in 2009 as the main forecasting and scenario tool; and apparently replaced this with <a href="http://www.nzae.org.nz/wp-content/uploads/2015/01/Sander.pdf">NZSIM, a more parsimonious model in 2014</a> - slightly condescendingly described as “deliberately kept small so is easily understood and applied by a range of users.”</p>

<h2 id="critiques">Critiques</h2>
<p>General Equilibrium approach has been roundly criticised from the margins of the economics field (pun) ever since it leapt to dominance in the second half of the twentieth century, from a philosophy of science perspective (doesn’t really make Popperian falsifiable predictions) and from the obvious and acknowledged absurdity/simplification of the assumptions needed to make the system tractable.</p>

<p>Noah Smith provides a <a href="http://noahpinionblog.blogspot.co.nz/2013/05/what-can-you-do-with-dsge-model.html">good sceptical discussion of the worth of DSGE in this post</a> and elsewhere.</p>

<p>I find the arguments for a <a href="http://www.amazon.com/Post-Walrasian-Macroeconomics-Stochastic-Equilibrium/dp/052168420X">post-Walrasian economics - beyond the DSGE</a> fairly compelling.  My key takeout from that book (not necessarily it’s main intent) is that new computing power means that we are increasingly in a position where we no longer have to just accept the simplifying assumptions needed for General Equilibrium approach to be tractable.  <a href="https://en.wikipedia.org/wiki/Agent-based_computational_economics">Agent-based models</a> are now possible that allow simulation of much more complex interactions between agents who lack the perfect knowledge required in the GE approach and behave realistically in terms of interactions and other ways.  Such models lack analytical solutions (ie ones that could in principle be worked out with pen and paper) but Monte Carlo methods can lead to insight as to how the real economy behaves.</p>

<h2 id="defining-a-ge-model-with-gecon">Defining a GE model with gEcon</h2>
<p>While I do think that these general equilibrium approaches will be superseded in the next 20 years (bit of a call I know), the alternatives are currently immature.  I still need to get my head around GE approaches.  Luckily I came across the <a href="http://gecon.r-forge.r-project.org/"><code class="highlighter-rouge">gEcon</code> project</a> - an exciting off-shoot of work done for the Polish government, now open-sourced and maintained by the original authors.  <code class="highlighter-rouge">gEcon</code> provides an easy language for defining a CGE or DSGE model, taking much of the hand-done mathematics pain out of the whole thing:</p>

<blockquote>
  <p>“Owing to the development of an algorithm for automatic derivation of first order conditions and implementation of a comprehensive symbolic library, gEcon allows users to describe their models in terms of optimisation problems of agents. To authors’ best knowledge there is no other publicly available framework for writing and solving DSGE &amp; CGE models in this natural way. Writing models in terms of optimisation problems instead of the FOCs is far more natural to an economist, takes off the burden of tedious differentiation, and reduces the risk of making a mistake.”</p>
</blockquote>

<p>The definition of agents’ optimisation problems in a sophisticated DGSE in the gEcon environment looks like this example extract from <a href="https://ideas.repec.org/p/pra/mprapa/64440.html">an implementation of the classic Smets-Wouters 2003 DSGE for the Euro area</a>.  The total model description is around 500 lines of code.  This particular block  is describing aspects of the price setting mechanism.  It’s not easy, but it is a lot easier than solving first order conditions by hand:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">block</span><span class="w"> </span><span class="n">PRICE_SETTING_PROBLEM</span><span class="w"> </span><span class="c1"># example gEcon language extract
</span><span class="p">{</span><span class="w">
    </span><span class="n">identities</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="n">g_1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lambda_p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_2</span><span class="p">[]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">eta_p</span><span class="p">[];</span><span class="w">
        </span><span class="n">g_1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="p">[]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi_star</span><span class="p">[]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Y</span><span class="p">[]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xi_p</span><span class="w"> </span><span class="o">*</span><span class="w">
                </span><span class="n">E</span><span class="p">[][(</span><span class="nb">pi</span><span class="p">[]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">gamma_p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">pi</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="m">-1</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lambda_p</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w">
                    </span><span class="p">(</span><span class="n">pi_star</span><span class="p">[]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">pi_star</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_1</span><span class="p">[</span><span class="m">1</span><span class="p">]];</span><span class="w">
        </span><span class="n">g_2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lambda</span><span class="p">[]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">mc</span><span class="p">[]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Y</span><span class="p">[]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">xi_p</span><span class="w"> </span><span class="o">*</span><span class="w">
                </span><span class="n">E</span><span class="p">[][(</span><span class="nb">pi</span><span class="p">[]</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="n">gamma_p</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">pi</span><span class="p">[</span><span class="m">1</span><span class="p">])</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">lambda_p</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">lambda_p</span><span class="p">))</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">g_2</span><span class="p">[</span><span class="m">1</span><span class="p">]];</span><span class="w">
    </span><span class="p">};</span><span class="w">

    </span><span class="n">shocks</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="n">eta_p</span><span class="p">[];</span><span class="w">                </span><span class="c1"># Price mark-up shock
</span><span class="w">    </span><span class="p">};</span><span class="w">

    </span><span class="n">calibration</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="n">xi_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.908</span><span class="p">;</span><span class="w">           </span><span class="c1"># Probability of not receiving the ``price-change signal''
</span><span class="w">        </span><span class="n">gamma_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.469</span><span class="p">;</span><span class="w">        </span><span class="c1"># Indexation parameter for non-optimising firms
</span><span class="w">    </span><span class="p">};</span><span class="w">
</span><span class="p">};</span></code></pre></figure>

<p>Similar code controls parts of the system such as the approach taken by the monetary authority (how much weight do they give to controlling inflation?), government expenditure, friction in the labour market, etc.</p>

<p>Incidentally, when the gEcon authors implemented the Smets-Wouters ‘03 model they identified a few small mistakes in the original implementation, which for me adds to the credibility of their argument that their (relatively) natural agent-based optimisation language is less prone to human error.</p>

<p><code class="highlighter-rouge">gEcon</code> is implemented in R; the authors give the reason for this (as opposed to more traditional Matlab / Octave / GAMS solution) being the greater flexibility (“not everything needs to be a matrix”) and easy connections to full range of other econometric and data management methods.</p>

<h2 id="solving-a-gecon-dsge-model-from-r">Solving a gEcon DSGE model from R</h2>
<p>Once the model has been defined, R functions can perform tasks such as :</p>

<ul>
  <li>calculate its steady state</li>
  <li>estimate the impact of randomness</li>
  <li>simulate paths through time (the “dynamic stochastic” bit)</li>
  <li>estimate the impact of changes over time through impulse-response functions</li>
</ul>

<p>For example, here is a simulation of one path through time for the deviation from the steady state of consumption, investment, capital, wages and income just from randomness in the Smets-Wouters ‘03 model:</p>

<p><img src="/img/0031-onepath.svg" alt="onepath" /></p>

<p>Getting to this point used this R code.  Note that I’m not reproducing below the full definition of the model, though I am including code that downloads it for you</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># ###################################################################
# (c) Chancellery of the Prime Minister 2012-2015                   #
# Licence terms for gEcon can be found in the file:                 #
# http://gecon.r-forge.r-project.org/files/gEcon_licence.txt        #
#                                                                   #
# gEcon authors: Grzegorz Klima, Karol Podemski,                    #
#          Kaja Retkiewicz-Wijtiwiak, Anna Sowińska                 #
# ###################################################################
</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">gEcon</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w">

</span><span class="c1"># download model definition and import into R:
</span><span class="n">download.file</span><span class="p">(</span><span class="s2">"http://gecon.r-forge.r-project.org/models/SW_03/SW_03.gcn"</span><span class="p">,</span><span class="w">
              </span><span class="n">destfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"SW_03.gcn"</span><span class="p">)</span><span class="w">
</span><span class="n">sw_gecon1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">make_model</span><span class="p">(</span><span class="s1">'SW_03.gcn'</span><span class="p">)</span><span class="w">

</span><span class="c1"># set some initial variable values:
</span><span class="n">initv</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">z_f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">Q_f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="nb">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">pi_obj</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
              </span><span class="n">epsilon_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon_L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon_I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">epsilon_G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
              </span><span class="n">r_k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">,</span><span class="w"> </span><span class="n">r_k_f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.01</span><span class="p">)</span><span class="w">

</span><span class="n">sw_gecon1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">initval_var</span><span class="p">(</span><span class="n">sw_gecon1</span><span class="p">,</span><span class="w"> </span><span class="n">init_var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">initv</span><span class="p">)</span><span class="w">

</span><span class="c1"># set some initial parameter values:
</span><span class="n">initf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="w">
   </span><span class="n">beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.99</span><span class="p">,</span><span class="w">            </span><span class="c1"># Discount factor
</span><span class="w">   </span><span class="n">tau</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.025</span><span class="p">,</span><span class="w">            </span><span class="c1"># Capital depreciation rate
</span><span class="w">   </span><span class="n">varphi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">6.771</span><span class="p">,</span><span class="w">         </span><span class="c1"># Parameter of investment adjustment cost function
</span><span class="w">   </span><span class="n">psi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.169</span><span class="p">,</span><span class="w">            </span><span class="c1"># Capacity utilisation cost parameter
</span><span class="w">   </span><span class="n">sigma_c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1.353</span><span class="p">,</span><span class="w">        </span><span class="c1"># Coefficient of relative risk aversion
</span><span class="w">   </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.573</span><span class="p">,</span><span class="w">              </span><span class="c1"># Habit formation intensity
</span><span class="w">   </span><span class="n">sigma_l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.4</span><span class="p">,</span><span class="w">          </span><span class="c1"># Reciprocal of labour elasticity w.r.t. wage
</span><span class="w">   </span><span class="n">omega</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w">               </span><span class="c1"># Labour disutility parameter
</span><span class="p">)</span><span class="w">
</span><span class="n">sw_gecon1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">set_free_par</span><span class="p">(</span><span class="n">sw_gecon1</span><span class="p">,</span><span class="w"> </span><span class="n">initf</span><span class="p">)</span><span class="w">

 
</span><span class="c1"># find the steady state for that set of starting values:
</span><span class="n">sw_gecon2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">steady_state</span><span class="p">(</span><span class="n">sw_gecon1</span><span class="p">)</span><span class="w">
</span><span class="n">get_ss_values</span><span class="p">(</span><span class="n">sw_gecon2</span><span class="p">)</span><span class="w">

</span><span class="c1"># solve the model in linearised form for 1st order perturbations/randomness:
</span><span class="n">sw_gecon2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">solve_pert</span><span class="p">(</span><span class="n">sw_gecon2</span><span class="p">,</span><span class="w"> </span><span class="n">loglin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">

</span><span class="c1"># simulate one path:
</span><span class="n">one_path</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">random_path</span><span class="p">(</span><span class="n">sw_gecon2</span><span class="p">,</span><span class="w"> </span><span class="n">var_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="s2">"Y"</span><span class="p">,</span><span class="w"> </span><span class="s2">"K"</span><span class="p">,</span><span class="w"> </span><span class="s2">"I"</span><span class="p">,</span><span class="w"> </span><span class="s2">"C"</span><span class="p">,</span><span class="w"> </span><span class="s2">"W"</span><span class="p">))</span><span class="w">
</span><span class="n">plot_simulation</span><span class="p">(</span><span class="n">one_path</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="n">deviation</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">steady_state</span></code></pre></figure>

<h2 id="impulse-response-functions">Impulse response functions</h2>
<p>In a method familiar to users of other economic modelling methods like Vector Autoregressions (VARs), it’s possible to “shock” the DSGE system and see the impact play out over time as the complex inter-relationships of agents within the system move from the shock towards a new equilibrium.  Here’s an example of the expected impact of a shock to the inflation objective applied to the Smets-Wouters ‘03 model:</p>

<p><img src="/img/0031-irf.svg" alt="irf" /></p>

<p>One of the characteristics of the DSGE models is the importance they give to agents’ expectations.  As their philosophy has increasingly dominated in recent decades, discussion of monetary policy has become less focused on individual actions of the monetary authority than on the overal regime and set of targets.  Any more-than-casual observer of public economic debate will have noticed the importance given to discussion of the overall inflation-targetting regime.  Hence the plot above shows the modelled impact of a change in the inflation objective - with no other direct exogenous shock in the model at all.</p>

<p>Here’s the R code that produced that plot:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># set covariance matrix of the parameters to be used in shock simulation:
</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">eta_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.336</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">eta_L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3.52</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">eta_I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.085</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">eta_a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.598</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
       </span><span class="n">eta_w</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6853261</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">eta_p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.7896512</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
       </span><span class="n">eta_G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.325</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">eta_R</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.081</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">eta_pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.017</span><span class="w"> </span><span class="o">^</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">sw_gecon3</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">set_shock_cov_mat</span><span class="p">(</span><span class="n">sw_gecon2</span><span class="p">,</span><span class="w"> </span><span class="n">shock_matrix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">diag</span><span class="p">(</span><span class="n">a</span><span class="p">),</span><span class="w"> </span><span class="n">shock_order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="w">

</span><span class="c1"># compute the moments with that covariance matrix:
</span><span class="n">sw_gecon3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">compute_moments</span><span class="p">(</span><span class="n">sw_gecon3</span><span class="p">)</span><span class="w">

</span><span class="n">sw_gecon_irf</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">compute_irf</span><span class="p">(</span><span class="n">sw_gecon3</span><span class="p">,</span><span class="w"> </span><span class="n">var_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s1">'C'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Y'</span><span class="p">,</span><span class="w"> </span><span class="s1">'K'</span><span class="p">,</span><span class="w"> </span><span class="s1">'I'</span><span class="p">,</span><span class="w"> </span><span class="s1">'L'</span><span class="p">),</span><span class="w"> </span><span class="n">chol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">T</span><span class="p">,</span><span class="w">
                            </span><span class="n">shock_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="s1">'eta_pi'</span><span class="p">),</span><span class="w"> </span><span class="n">path_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">40</span><span class="p">)</span><span class="w">
</span><span class="n">plot_simulation</span><span class="p">(</span><span class="n">sw_gecon_irf</span><span class="p">,</span><span class="w"> </span><span class="n">to_tex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">)</span></code></pre></figure>

<h2 id="putting-a-dsge-model-into-shiny">Putting a DSGE model into Shiny</h2>
<p>With so many complex and mysteriously named parameters - and I’ve shown very few of them - an interactive web application seems an obvious way to explore a model of this sort.  I’ve set up a prototype which explores the impulse response functions of the model, responding to shocks to parameters like labour supply, investment, productivity and government spending:</p>

<ul>
  <li>The <a href="https://ellisp.shinyapps.io/0031-shiny/">full screen version</a>  of the web app.  Once all buttons on the screen appear, give it 90 seconds or so to solve its steady state.  Then try choosing different variables to shock by from the drop down list.</li>
  <li>The <a href="https://github.com/ellisp/ellisp.github.io/tree/source/_working/_output/0031-shiny">source code</a></li>
</ul>

<h2 id="conclusion">Conclusion</h2>
<p>I’m a way off from being able to define my own DSGE for the New Zealand and connecting economies.  In particular the important question of calibration/estimation of parameters based on actual observable data is a a mystery to me at this stage.  But I can see how the basic idea works, and the gEcon package looks very promising for its relatively simple agent-optimisation approach to specifying the model.</p>



		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2016/02/08/ggseas">ggseas package for seasonal adjustment on the fly with ggplot2</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2016/02/24/tourism-dashboard">New Zealand Tourism Dashboard pushes Shiny to the max</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
			<p>My day job is Chief Data Scientist at <a href='https://www.nousgroup.com/'>Nous Group</a>, an international management consultancy with over 400 people working across Australia, the UK and Canada. <a href='mailto:peter.ellis@nousgroup.com.au'>Contact me</a> if you are interested working with us on a grand challenge or broad agenda.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics
http://Http://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>