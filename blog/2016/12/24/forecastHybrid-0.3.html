      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>forecastHybrid 0.3.0 on CRAN</title>
      	
         
         
            <meta name ="description" content ="forecastHybrid 0.3.0 for ensemble time series forecasting is now on CRAN. Two new features are prediction intervals for the nnetar (neural network) component of the combination; and theta method models.">
            <meta property="og:description" content ="forecastHybrid 0.3.0 for ensemble time series forecasting is now on CRAN. Two new features are prediction intervals for the nnetar (neural network) component of the combination; and theta method models.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="forecastHybrid 0.3.0 on CRAN" />
         
            <meta property="og:image" content="http://ellisp.github.io/img/0074-six-forecasts.png" />
         
		 
			<meta property="og:url" content="http://freerangestats.info/blog/2016/12/24/forecastHybrid-0.3.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2021/06/14/pc-penguins>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>forecastHybrid 0.3.0 on CRAN</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>forecastHybrid 0.3.0 for ensemble time series forecasting is now on CRAN. Two new features are prediction intervals for the nnetar (neural network) component of the combination; and theta method models.</p>
	   <p class="meta">24 Dec 2016</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <h2 id="make-it-easy-to-make-ensemble-time-series-forecast">Make it easy to make ensemble time series forecast</h2>
<p><code class="highlighter-rouge">forecastHybrid</code> is an R package to make it easier to use the average predictions of ‘ensembles’ (or ‘combinations’) of time series models from Rob Hyndman’s <code class="highlighter-rouge">forecast</code> package.  It looks after the averaging, and also calculates prediction intervals by a <a href="/presentations/ellis-prediction-intervals-for-ensemble-forecasts.pptx">conservative method</a> that aims to redress the general over-optimism in forecasting prediction intervals.</p>

<p>New in version 0.3.0 is:</p>

<ul>
  <li>Following developments in the <code class="highlighter-rouge">forecast</code> package, prediction intervals are now created for <code class="highlighter-rouge">nnetar</code> objects in the ensemble. This should address one aspect of incorrect prediction intervals (e.g. <a href="https://github.com/ellisp/forecastHybrid/issues/37">issue #37</a>).</li>
  <li>theta models can be added (by including “<code class="highlighter-rouge">f</code>” in the <code class="highlighter-rouge">models =</code> argument for <code class="highlighter-rouge">hybridModel()</code>) and are indeed part of the default - so unless set otherwise, <code class="highlighter-rouge">hybridModel()</code> will now fit six models.</li>
  <li><code class="highlighter-rouge">accuracy.cvts()</code> is now exported.  It returns ra ange of summary measures of the cross-validated forecast accuracy for objects created by <code class="highlighter-rouge">cvts</code>.   Note that development on <code class="highlighter-rouge">cvts</code> for <code class="highlighter-rouge">forecastHybrid</code> has been independent of Hyndman’s work on a <a href="http://robjhyndman.com/hyndsight/tscv/">similarly purposed <code class="highlighter-rouge">tscv</code> function in <code class="highlighter-rouge">forecast</code></a> - be careful not to get the two confused.</li>
  <li><code class="highlighter-rouge">plot.hybridModel()</code> now supports <code class="highlighter-rouge">ggplot2</code> graphics when the argument <code class="highlighter-rouge">ggplot = TRUE</code> is passed.</li>
  <li>Time series must be at least four observations long.</li>
  <li>Fixed an error where <code class="highlighter-rouge">e.args</code> was passed to <code class="highlighter-rouge">tbats</code> instead of <code class="highlighter-rouge">t.args</code>.</li>
</ul>

<p>In some respects, version 0.2.0 was a more important upgrade because it introduced <code class="highlighter-rouge">cvts</code> and the use of a weighted average forecast with weights for the component models chosen by cross-validation.  I didn’t get around to writing a blog post when that happened.</p>

<h2 id="installation">Installation</h2>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Install from CRAN the usual way:
</span><span class="n">install.packages</span><span class="p">(</span><span class="s2">"forecastHybrid"</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">forecastHybrid</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">

</span><span class="n">citation</span><span class="p">(</span><span class="s2">"forecastHybrid"</span><span class="p">)</span><span class="w">

</span><span class="c1"># To cite package ‘forecastHybrid’ in publications use:
#    
#    David Shaub and Peter Ellis (2016). forecastHybrid: Convenient Functions for
# Ensemble Time Series Forecasts. R package version 0.3.0.
# https://CRAN.R-project.org/package=forecastHybrid
# 
# A BibTeX entry for LaTeX users is
# 
# @Manual{,
#    title = {forecastHybrid: Convenient Functions for Ensemble Time Series Forecasts},
#    author = {David Shaub and Peter Ellis},
#    year = {2016},
#    note = {R package version 0.3.0},
#    url = {https://CRAN.R-project.org/package=forecastHybrid},
</span><span class="err">#</span><span class="w"> </span><span class="p">}</span></code></pre></figure>

<h2 id="basic-use">Basic use</h2>

<p>The <code class="highlighter-rouge">hybridModel</code> function fits between two and six time series models to a time series, with or without <code class="highlighter-rouge">xreg</code> external regressor explanatory variables.  The default, if the <code class="highlighter-rouge">models=</code> argument is left blank, is to fit all six available models.  The modelling process also determines a set of weights to be used in subsequent forecasts.  The two options are:</p>

<ul>
  <li>equal weights ie a simple average</li>
  <li>cross validation weights ie a weighted average, with models that performed better in cross-validation given more weight.</li>
</ul>

<p>Generally, we expect cross-validation weights to perform better, but they are quite computationally intensive and we haven’t got round to implementing parallel processing yet.</p>

<p>Here’s a demo with the median duration of unemployment in weeks from the <code class="highlighter-rouge">economics</code> dataset in the <code class="highlighter-rouge">ggplot2</code> package.  This snippet demonstrates both ways of using weights and the default base plot method.  This plot method is the one provided by <code class="highlighter-rouge">forecast</code> for all objects of class <code class="highlighter-rouge">forecast</code>, including those created by forecastHybrid.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># median duration of unemployment, in weeks
</span><span class="n">uempmed</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">ts</span><span class="p">(</span><span class="n">economics</span><span class="o">$</span><span class="n">uempmed</span><span class="p">,</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1967</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">),</span><span class="w"> </span><span class="n">frequency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">12</span><span class="p">)</span><span class="w">

</span><span class="n">BoxCox.lambda</span><span class="p">(</span><span class="n">uempmed</span><span class="p">)</span><span class="w"> </span><span class="c1"># very close to zero, so use logarithm tansform
</span><span class="w">
</span><span class="n">m</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hybridModel</span><span class="p">(</span><span class="n">uempmed</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"equal"</span><span class="p">)</span><span class="w">

</span><span class="n">m</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hybridModel</span><span class="p">(</span><span class="n">uempmed</span><span class="p">,</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cv.errors"</span><span class="p">)</span><span class="w">

</span><span class="n">f</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">forecast</span><span class="p">(</span><span class="n">m</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">24</span><span class="p">)</span><span class="w">
</span><span class="n">f</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">forecast</span><span class="p">(</span><span class="n">m</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">24</span><span class="p">)</span><span class="w">

</span><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">font.main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">mar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">0.1</span><span class="p">,</span><span class="w"> </span><span class="n">cex.main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.6</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">1</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/0074-base-forecast.svg" alt="base" /></p>

<p>The cross-validation errors should be better because they give less weight to poor performing forecasts.  The forecasts from <code class="highlighter-rouge">nnetar</code> for example are often not good, and in a set of experiments for a <a href="/presentations/ellis-prediction-intervals-for-ensemble-forecasts.pptx">recent talk at the Australian Statistical Conference</a> I showed that they are sufficiently poor that they often worsen ensemble forecasts when added to the mix.  Setting weights by cross-validation should mitigate this.</p>

<p>All of the component models can be accessed individually if desired:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="o">$</span><span class="n">thetam</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="o">$</span><span class="n">ets</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="o">$</span><span class="n">stlm</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="o">$</span><span class="n">auto.arima</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="o">$</span><span class="n">nnetar</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="o">$</span><span class="n">tbats</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/0074-six-forecasts.svg" alt="six" /></p>

<p>The <code class="highlighter-rouge">ggplot2::autoplot()</code> method provided by the <code class="highlighter-rouge">forecast</code> package also works:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">autoplot</span><span class="p">(</span><span class="n">f</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Forecast median length of unemployment"</span><span class="p">,</span><span class="w">
           </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Six component models, weights chosen by cross-validation"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Weeks"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: 'economics' in ggplot2 R package,\nultimately from http://research.stlouisfed.org/fred2"</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/0074-gg-forecast.svg" alt="gg" /></p>

<h2 id="theta-models">Theta models</h2>
<p>We implemented the Theta forecast method based on <code class="highlighter-rouge">thetaf()</code> in Hyndman’s <code class="highlighter-rouge">forecast</code> (although there are alternatives).  We had to split the process into a modelling function <code class="highlighter-rouge">thetam()</code>, and an accompanying <code class="highlighter-rouge">forecast.thetam</code> method.  The results are identical to <code class="highlighter-rouge">forecast::thetaf()</code>, as demonstrated below:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">f</span><span class="m">3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">thetaf</span><span class="p">(</span><span class="n">uempmed</span><span class="p">,</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24</span><span class="p">)</span><span class="w">
</span><span class="n">f</span><span class="m">4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">forecast</span><span class="p">(</span><span class="n">thetam</span><span class="p">(</span><span class="n">uempmed</span><span class="p">),</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">24</span><span class="p">)</span><span class="w">

</span><span class="n">data.frame</span><span class="p">(</span><span class="n">thetaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="m">3</span><span class="o">$</span><span class="n">mean</span><span class="p">,</span><span class="w"> </span><span class="n">thetam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="m">3</span><span class="o">$</span><span class="n">mean</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
   </span><span class="n">mutate_each</span><span class="p">(</span><span class="s2">"as.numeric"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
   </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">thetaf</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">thetam</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">geom_abline</span><span class="p">(</span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"thetaf()"</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"forecast(thetam())"</span><span class="p">,</span><span class="w">
        </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Forecasts are of median length of unemployment in the USA"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
   </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Separating thetaf into a modelling function with a forecast method"</span><span class="p">,</span><span class="w">
           </span><span class="n">subtitle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The two methods give identical results"</span><span class="p">)</span></code></pre></figure>

<p><img src="/img/0074-theta.svg" alt="theta" /></p>

<h2 id="conservative-prediction-intervals">Conservative prediction intervals?</h2>

<p>The <code class="highlighter-rouge">forecastHybrid</code> method of setting prediction intervals is conservative.  It takes the widest range of values covered by any of the component models.  In a <a href="http://robjhyndman.com/hyndsight/forecast-combinations/">blog post on different ways of setting forecast combinations</a>, Rob Hyndman points out that, using the monthly <code class="highlighter-rouge">co2</code> dataset of Mauna Loa Atmospheric CO2 Concentration distributed with R, the prediction intervals for the <code class="highlighter-rouge">forecastHybrid</code> method with six component models look too conservative ie sufficiently wide that they look very likely to contain the correct values much more than aimed for.  In this particular case I agree - the method should be used with a bit of caution.</p>

<p>In practice, I often use only the <code class="highlighter-rouge">auto.arima</code> and <code class="highlighter-rouge">ets</code> forecasts in combination rather than all six possibilities.  Even then, the method is sometimes too conservative with data that of monthly or higher frequency, particularly at the 80% level.  Here’s the conclusions from <a href="/presentations/ellis-prediction-intervals-for-ensemble-forecasts.pptx">my recent presentation on this topic</a> (apologies for the screenshot from PowerPoint):</p>

<p><img src="/img/0074-table.png" width="500" /></p>

<p>So for annual and quarterly real world data, the method is not too conservative at all; and if you want your prediction intervals to contain the true value 95% of the time, the method checks out ok even for monthly data.</p>

<h2 id="feedback-and-suggestions">Feedback and suggestions</h2>

<p>Our preferred approach for you to provide suggestions and bug reports is to file an <a href="https://github.com/ellisp/forecastHybrid/issues">issue on GitHub</a>.  Other comments and feedback could be provided as a comment on this blog post or on <a href="https://twitter.com/ellis2013nz">Twitter</a>.</p>


		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2016/12/18/air-quality-india">Air quality in Indian cities</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2016/12/26/shadow-economy">Extracting data on shadow economy from PDF tables</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
			<p>My day job is Chief Data Scientist at <a href='https://www.nousgroup.com/'>Nous Group</a>, an international management consultancy with over 400 people working across Australia, the UK and Canada. <a href='mailto:peter.ellis@nousgroup.com.au'>Contact me</a> if you are interested working with us on a grand challenge or broad agenda.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics
http://Http://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>