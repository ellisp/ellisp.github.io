      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Trying out Processing</title>
      	
         
         
            <meta name ="description" content ="I have a go at using the Processing programming language, which was developed to help graphic designers but has a broad bunch of potential applications. While Processing proper sits on top of Java, there's a handy implementation in JavaScript.">
            <meta property="og:description" content ="I have a go at using the Processing programming language, which was developed to help graphic designers but has a broad bunch of potential applications. While Processing proper sits on top of Java, there's a handy implementation in JavaScript.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Trying out Processing" />
         
            <meta property="og:image" content="http://freerangestats.info/img/0193-pies.gif" />
         
		 
			<meta property="og:url" content="http://freerangestats.info/blog/2020/09/13/processing-language.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script src="/js/p5.min.js"></script><script src="/sketches/many-pies.js"></script>

   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2021/02/05/stock-visualizations>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Trying out Processing</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>I have a go at using the Processing programming language, which was developed to help graphic designers but has a broad bunch of potential applications. While Processing proper sits on top of Java, there's a handy implementation in JavaScript.</p>
	   <p class="meta">13 Sep 2020</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <h2>A new (to me) language for making cool graphics</h2>

<p>I've recently been reading a bit about graphic design and several things independently pointed me towards the <a href='https://processing.org/'><i>Processing</i> programming language</a>. It's really nice! In its own description:

<blockquote>
Processing is a flexible software sketchbook and a language for learning how to code within the context of the visual arts. Since 2001, Processing has promoted software literacy within the visual arts and visual literacy within technology. There are tens of thousands of students, artists, designers, researchers, and hobbyists who use Processing for learning and prototyping.
</blockquote>

<p>Processing is a compiled language that sits on top of Java. It's explicitly been designed to make it easy for someone undergoing their first programming experience to pick up and start writing simple code "draw a line from here to there", "draw a bezier curve just like so", "add an ellipse with X coloured fill, and Y coloured stroke, just where I click the mouse". The aim is to provide graphic designers with a tool to meet their computational needs that go beyond point-and-click tools, but with minimal entry and learning barriers. I'd say its creators have met their objective.<p>


<p>While Processing proper is a strongly typed Java-like language that supports object-oriented programming, there are a couple of JavaScript versions built to make it easier to embed "sketches" (ie Processing programs) into web pages. <a href='https://p5js.org/'>p5.js</a> is the best developed. Here is a sample sketch I wrote to familiarise myself with Processing, subsequently re-written in p5.js:</p>

    <div id='sketch-holder' style='width: 100%;text-align:center;'></div>

<p>Everyone loves pie charts (ok, I know we don't really), but what's cooler than a pie chart? 200 resizing, elliptical, randomly accelerating pie charts spinning in different directions! Click in the sketch (or even outside it) to reset the pie charts based on that mouse click.</p>

<p>Pointless fact - these pie charts each show the industry composition of value-add in the Australian economy in 2018-19, top seven industries plus 'other'.</p>

<h2>Walking through an example program</h2>

<p>Let's walk through this simple program. As I'm brand new to this language, and I first wrote it in pure Processing then had to convert it to JavaScript, it's very unlikely to be particularly good practice. But forcing myself to write about it here was a way to motivate me to finish it.</p>

<p>The p5.js program is all contained in a single script <code>many-pies.js</code>. The full script is <a href='https://github.com/ellisp/blog-source/blob/master/sketches/many-pies.js'>on GitHub</a>. In the Processing version I had the code split across three files. Processing uses the concept of a "sketch" to organise its files together into something like a project, with each file saved with a <code>.pde</code> suffix and all compiled together into a single program (invisible to the developer) when you hit "run" in the development environment that comes with the language. Each <code>.pde</code> file gets its own tab in the Process development environment like you'd expect. But for my purposes with this blog and the complications of mucking around also with HTML, it was easier to have the many-pies program as single JavaScript script.</p>

<h3>Data and global variables</h3>

<p>Here's the first chunk of that script. Here, I'm just:</p>

<ul>
<li>defining the data</li>
<li>scaling it so each value is mapped to zero to 360 degrees</li>
<li>defining <code>pies</code> as an array (empty for now)</li>
<li>defining three arrays of the red, green and blue components of colours to use for pie wedges.</li>
</ul>

    
<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//-----------------------Data and global variables-----------------</span>
<span class="c1">// Australian value add by industry division, top 7 divisions and 'other'</span>
<span class="c1">// Sourced from https://www.abs.gov.au/AUSSTATS/abs@.nsf/DetailsPage/8155.02018-19?OpenDocument</span>
<span class="kd">let</span> <span class="nx">the_data</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">51983</span><span class="p">,</span> <span class="mi">46153</span><span class="p">,</span> <span class="mi">32061</span><span class="p">,</span> <span class="mi">25092</span><span class="p">,</span> <span class="mi">16001</span><span class="p">,</span> <span class="mi">14240</span><span class="p">,</span> <span class="mi">13992</span><span class="p">,</span> <span class="mi">61200</span> <span class="p">];</span>

<span class="c1">// Calculate total sum of the_data so can use it for scaling:</span>
<span class="kd">let</span> <span class="nx">sum</span> <span class="o">=</span> <span class="nx">the_data</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">){</span>
    <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
<span class="p">},</span> <span class="mi">0</span><span class="p">);</span>
 
<span class="c1">// Rescale the data from 0 to 360 (for degrees):</span>
<span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">the_data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
	<span class="nx">the_data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="nx">the_data</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">/</span> <span class="nx">sum</span> <span class="o">*</span> <span class="mi">360</span>
<span class="p">}</span> 
    
<span class="kd">let</span> <span class="nx">pies</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">();</span>

<span class="c1">// Brewer colours, Set3 palette</span>
<span class="kd">let</span> <span class="nx">palr</span> <span class="o">=</span> <span class="p">[</span><span class="mi">141</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">252</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">palg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">211</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">205</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">palb</span> <span class="o">=</span> <span class="p">[</span><span class="mi">199</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">229</span><span class="p">];</span></code></pre></figure>

<p>This is definitely not a sustainable and scalable way of doing these tasks! For example, this will only work with pies of exactly eight wedges; a better approach would have the functionality to generate this palette on the fly. And the data is hard-coded into the program, obviously only the sort of thing you'd do with short illustrative examples.</p>

<h3>Setup and draw</h3>

<p>The second chunk of code is the guts of the program. Every substantial Processing sketch has two main functions: <code>setup()</code> and <code>draw()</code>. Some of the economy of the language comes from how this pre-defined structure mimics the real-world sketching workflow of a graphic designer.</p>

<p>Perhaps some of my earlier chunk above could have been included in <code>setup()</code> but I've chosen to use that function in this case just for setting up the visual elements of the page. In particular, we define the canvas that is going to appear in my web page, associate it with a div I have created in the HTML version of this post; establish that the things we are going to draw have no stroke, only fill; the framerate; and the 200 elements of the pies array. These are created with the <code>PieChart</code> constructor function which we'll come to in the third chunk of code.</p>

<p>The <code>draw()</code> function is pretty simple. It spins, moves, resizes and draws each of the pie charts in turn; then has a straightforward chunk to monitor if the mouse has been pressed and if so to relocate all the pies to wherever that location is. The <code>draw()</code> function will by default in Processing or p5.js loop indefinitely, useful for this sort of animation, games, and many other programs featuring user interaction. Note that the first thing that happens in each iteration of <code>draw()</code> is that it draws a blank black rectangle over the whole canvas with <code>background(0)</code>. The process inside <code>draw()</code> is run 60 times a second, each iteration of which is seeing the whole canvas erased and redrawn.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//--------------------------Main sketch program ('setup()' and 'draw()')-------------------</span>
<span class="kd">function</span> <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// create a canvas and move it to </span>
    <span class="c1">// inside the div with id='sketch-holder':</span>
    <span class="kd">var</span> <span class="nx">canvas</span> <span class="o">=</span> <span class="nx">createCanvas</span><span class="p">(</span><span class="mi">680</span><span class="p">,</span> <span class="mi">400</span><span class="p">);</span>
    <span class="nx">canvas</span><span class="p">.</span><span class="nx">parent</span><span class="p">(</span><span class="s1">'sketch-holder'</span><span class="p">);</span>
      
    <span class="nx">noStroke</span><span class="p">();</span>
    <span class="nx">frameRate</span><span class="p">(</span><span class="mi">60</span><span class="p">);</span>
      
	<span class="c1">// Create 200 pie objects, in the centre of the canvas:</span>
	<span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">200</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
	  
		<span class="nx">pies</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">new</span> <span class="nx">PieChart</span><span class="p">(</span><span class="nx">the_data</span><span class="p">,</span> <span class="nx">random</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">width</span> <span class="o">/</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> 
                    <span class="nx">randomGaussian</span><span class="p">()</span> <span class="o">*</span> <span class="mf">0.03</span><span class="p">,</span> <span class="nx">random</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">230</span><span class="p">)));</span>						   
	<span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Main loop</span>
<span class="kd">function</span> <span class="nx">draw</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">background</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
	<span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">pies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
		<span class="nx">pies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">spin</span><span class="p">();</span>  
		<span class="nx">pies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">move</span><span class="p">(</span><span class="mf">0.2</span><span class="p">);</span>
		<span class="nx">pies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">resize</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
		<span class="nx">pies</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">display</span><span class="p">();</span> 
	<span class="p">}</span>
	
    <span class="c1">// If mouse pressed, re-create all the pies centred in the mouse location.</span>
    <span class="c1">// Half of these will be a new, small size; half will be whatever size they</span>
    <span class="c1">// were previously:</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">mouseIsPressed</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">pies</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">random</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">){</span>
                <span class="nx">pies</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">relocate</span><span class="p">(</span><span class="nx">mouseX</span> <span class="o">-</span> <span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">mouseY</span> <span class="o">-</span> <span class="nx">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="nx">pies</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">relocate</span><span class="p">(</span><span class="nx">mouseX</span> <span class="o">-</span> <span class="nx">width</span><span class="o">/</span><span class="mi">2</span> <span class="p">,</span><span class="nx">mouseY</span> <span class="o">-</span> <span class="nx">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="nx">pies</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">diameter</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3> The PieChart class and its method</h3>

<p>Finally, in my third chunk I define the <code>PieChart</code> class and methods to <code>display()</code>, <code>spin()</code>, <code>move()</code>, <code>resize()</code> and <code>relocate()</code> an object of that class. These methods were used earlier in <code>draw()</code>. Each object of class <code>PieChart</code> has values for key parameters such as its diameter, the "startAngle" at which the first wedge of the pie is drawn (changing this gives the illusion of spinning), its current x and y position, its transparency, and the aspect ratio by which it differs from a proper circle. The various methods that act on objects of this class use and manipulate those values. This is the sort of thing that object-oriented programming is good for organising.</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="c1">//---------------PieChart objects and their methods----------------------------</span>
<span class="kr">class</span> <span class="nx">PieChart</span> <span class="p">{</span>
 
    <span class="nx">constructor</span><span class="p">(</span><span class="nx">temp_data</span><span class="p">,</span> <span class="nx">temp_diameter</span><span class="p">,</span> <span class="nx">temp_startAngle</span><span class="p">,</span> 
                <span class="nx">temp_x</span><span class="p">,</span> <span class="nx">temp_y</span><span class="p">,</span> <span class="nx">temp_ss</span><span class="p">,</span> <span class="nx">temp_alpha</span><span class="p">){</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">temp_data</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">diameter</span> <span class="o">=</span> <span class="nx">temp_diameter</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">startAngle</span> <span class="o">=</span> <span class="nx">temp_startAngle</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">temp_x</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">temp_y</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">xv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yv</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">ss</span> <span class="o">=</span> <span class="nx">temp_ss</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">alpha</span> <span class="o">=</span> <span class="nx">temp_alpha</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">aspect</span> <span class="o">=</span> <span class="nx">random</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="p">}</span>
     
    <span class="nx">display</span><span class="p">()</span> <span class="p">{</span>

        <span class="nx">push</span><span class="p">();</span>
        <span class="nx">translate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">x</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span><span class="p">);</span>

        <span class="kd">let</span> <span class="nx">segmentAngle</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">startAngle</span>

        <span class="c1">// Draw the pie, one wedge at a time</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>

        <span class="nx">fill</span><span class="p">(</span><span class="nx">palr</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">palg</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">palb</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="k">this</span><span class="p">.</span><span class="nx">alpha</span><span class="p">);</span>
        <span class="nx">arc</span><span class="p">(</span><span class="nx">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> 
            <span class="nx">height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">diameter</span> <span class="o">*</span> <span class="k">this</span><span class="p">.</span><span class="nx">aspect</span><span class="p">,</span> 
            <span class="k">this</span><span class="p">.</span><span class="nx">diameter</span><span class="p">,</span> 
            <span class="nx">segmentAngle</span><span class="p">,</span> 
            <span class="nx">segmentAngle</span> <span class="o">+</span> <span class="nx">radians</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
        <span class="nx">segmentAngle</span> <span class="o">+=</span> <span class="nx">radians</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span> 
        <span class="p">}</span>
        <span class="nx">pop</span><span class="p">();</span>
    <span class="p">}</span>
 
    <span class="c1">// spin method</span>
    <span class="nx">spin</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">startAngle</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">ss</span><span class="p">;</span>
    <span class="p">}</span>
 
    <span class="c1">// move method  with a speed argument supplied:</span>
    <span class="nx">move</span><span class="p">(</span><span class="nx">sp</span><span class="p">)</span> <span class="p">{</span>
  
        <span class="c1">// change speeds: </span>
        <span class="k">this</span><span class="p">.</span><span class="nx">xv</span> <span class="o">+=</span> <span class="nx">randomGaussian</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sp</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">yv</span> <span class="o">+=</span> <span class="nx">randomGaussian</span><span class="p">()</span> <span class="o">*</span> <span class="nx">sp</span><span class="p">;</span>

        <span class="c1">// if speed too high in one direction, or off screen, accelerate in other direction:</span>
        <span class="kd">let</span> <span class="nx">v_constraint</span> <span class="o">=</span> <span class="mi">15</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">xv</span> <span class="o">&gt;</span> <span class="nx">sp</span> <span class="o">*</span> <span class="nx">v_constraint</span> <span class="o">|</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">&gt;</span> <span class="nx">width</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">xv</span> <span class="o">-=</span><span class="nx">sp</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">xv</span> <span class="o">&lt;</span> <span class="o">-</span><span class="nx">sp</span> <span class="o">*</span> <span class="nx">v_constraint</span> <span class="o">|</span> <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="nx">width</span><span class="p">)){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">xv</span> <span class="o">+=</span> <span class="nx">sp</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">yv</span> <span class="o">&gt;</span> <span class="nx">sp</span> <span class="o">*</span> <span class="nx">v_constraint</span> <span class="o">|</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&gt;</span> <span class="nx">height</span><span class="p">){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yv</span> <span class="o">-=</span> <span class="nx">sp</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">yv</span> <span class="o">&lt;</span> <span class="o">-</span><span class="nx">sp</span> <span class="o">*</span> <span class="nx">v_constraint</span> <span class="o">|</span> <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">&lt;</span> <span class="p">(</span><span class="o">-</span><span class="nx">height</span><span class="p">)){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">yv</span> <span class="o">+=</span> <span class="nx">sp</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// Change location based on the speed</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">xv</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">+=</span> <span class="k">this</span><span class="p">.</span><span class="nx">yv</span><span class="p">;</span>
    <span class="p">}</span>
 
    <span class="c1">// resize method with a scaling for how much to resize by (roughly):</span>
    <span class="nx">resize</span><span class="p">(</span><span class="nx">z</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">diameter</span> <span class="o">+=</span> <span class="nx">randomGaussian</span><span class="p">()</span> <span class="o">*</span> <span class="nx">z</span><span class="p">;</span>
        <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">diameter</span> <span class="o">&lt;</span> <span class="p">(</span><span class="nx">z</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)){</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">diameter</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nx">z</span> <span class="p">;</span> 
        <span class="p">}</span>
    <span class="p">}</span>
 
    <span class="c1">// relocate to new position and diameter:</span>
    <span class="nx">relocate</span><span class="p">(</span><span class="nx">newx</span><span class="p">,</span> <span class="nx">newy</span><span class="p">,</span> <span class="nx">newd</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">newx</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">newy</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">diameter</span> <span class="o">=</span> <span class="nx">newd</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2>Translating from Processing (Java) to p5.js (JavaScript)</h2>

<p>I mentioned earlier that I first wrote this program in Processing and then re-wrote it in p5.js. There's an ok <a href='https://github.com/processing/p5.js/wiki/Processing-transition'>Processing transition tutorial</a> on how to do this. I found it a bit of a pain and I think in future I will try to decide early on which dialect I am writing in. If a sketch is going to end up in my blog I will start developing it in p5.js directly.</p>

<p>The three main changes I had to make in translating from Processing to p5.js were:</p>

<ul>
<li>Add <code>this.</code> to the front of variables within methods that refer to the object the method is manipulating.</li>
<li>Removing the type specifications (<code>float</code>, <code>int</code>, etc) and replacing them with <code>let</code>. Such a shame - having got a program working with strict typing, it feels positively dirty dropping the strictness.</li>
<li>A few specific changes relating to rendering on the screen, for example <code>pushMatrix()</code> becomes <code>push()</code>, we explicitly define the screen as an HTML5 <code>Canvas</code>, etc.</li>
</ul>

<p>
For actually embedding the sketch in this blog post, I found this useful <a href='https://github.com/processing/p5.js/wiki/Positioning-your-canvas'>guidance on how to integrate a sketch into a webpage</a>. Most of the other random guidance on doing this on the web - at least when aimed at beginners - seems to be for publishing the sketch as a stand-alone page rather than embedded with other content.</p>

<p>
I had to write this post in HTML directly rather than markdown, but that's not that difficult - quite a few pages on my website I have handcoded in HTML, whenever I want to do anything like explicitly define divs, create tabs, etc. In this case, there were two things I needed to do with my Jekyll setup which I note here (so I remember for next time, and in case someone else is interested!):
</p>

<ul>
<li>A webpage with a processing sketch needs to load in the program for the sketch and p5.js library in the <code>&ltheader&gt</code> of the webpage. The p5.js library itself is about 800kb and I only wanted it loaded if the user was looking at a page that needs it. So I added to my <code>_includes/header.html</code> file, which is included in the header of everything on this website, the jekyll snippet <code>{{ page.extraheader }}</code>. And to the YAML at the top of the script for this blog post I added <code>extraheader: &ltscript src="/js/p5.min.js"&gt&lt/script&gt&ltscript src="/sketches/many-pies.js"&gt&lt/script&gt</code>. Together, these additions mean that for this page, and this page alone (so far), the p5.js library and the many-pies.js program are loaded in.</li>
<li>In the body of the post I included <code>&ltdiv id='sketch-holder' style='width: 100%;text-align:center;'&gt&lt/div&gt</code> so the sketch can appear in the midst of my other text of the post. Note that this only worked because of the line <code>canvas.parent('sketch-holder')</code> in the p5.js script, telling it to place the canvas inside the 'sketch-holder' div in the HTML page.</li>
</ul>

<h2>Processing and R!</h2>

<p>After I'd written all the above, I discovered there is currently in development a <a href='https://github.com/processing-r/Processing.R'>Processing R package</a> which enables users to write Processing sketches in R. Here's an example from its GitHub page:</p>

<img src='/img/0193-cube.gif'>

<p>I haven't looked into this yet. There's also a Python implementation. I'm not sure what value these alternative implementations offer over using either the Java or JavaScript versions. But no harm in people giving it a go, and I will probably find time to have a look at some point.</p>

	


		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2020/09/06/mixture-distributions">Mixture distributions and reporting times for Covid-19 deaths in Florida</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2020/09/26/nzes-issues">Free text in surveys - important issues in the 2017 New Zealand Election Study</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
			<p>My day job is Chief Data Scientist at <a href='https://www.nousgroup.com/'>Nous Group</a>, an international management consultancy with over 400 people working across Australia, the UK and Canada. <a href='mailto:peter.ellis@nousgroup.com.au'>Contact me</a> if you are interested working with us on a grand challenge or broad agenda.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics
http://Http://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>