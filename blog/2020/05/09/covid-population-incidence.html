      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Test positivity rates and actual incidence and growth of diseases</title>
      	
         
         
            <meta name ="description" content ="I look at several different ways of accounting for the information given us by high positive testing rates for COVID-19 and look at the impact on estimates of effective reproduction number at a point in time.">
            <meta property="og:description" content ="I look at several different ways of accounting for the information given us by high positive testing rates for COVID-19 and look at the impact on estimates of effective reproduction number at a point in time.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Test positivity rates and actual incidence and growth of diseases" />
         
            <meta property="og:image" content="http://freerangestats.info/img/0178-smoothed-test-rates.svg" />
         
		 
			<meta property="og:url" content="http://freerangestats.info/blog/2020/05/09/covid-population-incidence.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
				  <li><a href = /blog/2020/06/06/nz-2020-forecasts>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">election forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/elections/nz-2020/index.html">NZ 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Test positivity rates and actual incidence and growth of diseases</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>I look at several different ways of accounting for the information given us by high positive testing rates for COVID-19 and look at the impact on estimates of effective reproduction number at a point in time.</p>
	   <p class="meta">09 May 2020</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <h2 id="test-positivity-rates-and-disease-incidence">Test positivity rates and disease incidence</h2>

<p>OK, lets talk about test positivity rates ie the proportion of administered tests that conclude the subject has the disease being tested for. These are in the news, with COVID-19 test positivity being used as an informal indicator of COVID-19 incidence and the quality of the confirmed case data, for example in <a href="https://twitter.com/NateSilver538/status/1258870023545860101">Nate Silver’s daily commentaries</a>. There’s a good <a href="https://www.theatlantic.com/technology/archive/2020/04/us-coronavirus-outbreak-out-control-test-positivity-rate/610132/">recent piece in <em>The Atlantic</em></a> on why high test positivity rates are a particular problem for understanding incidence in the US where tests have been scarce. With a lack of random samples from populations, and very partial coverage of the symptom-based testing, it’s really hard to estimate population incidence, prevalence or even its growth and <a href="https://www.healthknowledge.org.uk/public-health-textbook/research-methods/1a-epidemiology/epidemic-theory">effective reproduction number</a>.</p>

<blockquote>
  <p>Terminology point - incidence is the rate of new (or newly diagnosed) cases of a disease, and prevalence is the total cases at a point in time. Obviously the difficulties in measuring either are closely related.</p>
</blockquote>

<p>We know from other situations, particularly malaria in relatively poor countries with limited health surveillance capabilities, that test positivity rate itself can be used as an indicator of incidence. In fact, it’s one of the <a href="https://www.who.int/data/gho/indicator-metadata-registry/imr-details/3151">official metrics</a> from the World Health Organisation for monitoring malaria. The rationale is that there is an ongoing background rate of people presenting for tests with fever symptoms, and the proportion of these people who turn out to have malaria is an imperfect but useful indicator of how much malaria there is in the population. If it gets low enough, you can even start thinking about elimination.</p>

<p>There’s a small recent academic literature on the relationship between malaria test positivity rates and actual incidence. For example, a nice 2016 piece by Boyce and others in open access PLoS One about <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4809590/">Practical Implications of the Non-Linear Relationship between the Test Positivity Rate and Malaria Incidence</a>. Because the data is included in a supplementary table (albeit as a 265 page long PDF!) I was able to reproduce and enhance one of their key charts:</p>

<object type="image/svg+xml" data="/img/0178-malaria.svg" width="100%"><img src="/img/0178-malaria.png" width="100%" /></object>

<p><em>All R code is <a href="https://github.com/ellisp/blog-source/blob/master/_working/0178-covid-prevalence-inference.R">on GitHub</a> rather than in the post itself today.</em></p>

<p>One implication of this is that if tests are the only indicator you have of a disease’s incidence, if the number of positives in the tests <em>double</em> but the number of tests hasn’t doubled, it is probable that the number of actual infections has <em>more than doubled</em>. This is relevant for how we interpret the reported COVID-19 cases. In fact, it just confirms the common sense that higher test positivity rates probably mean not just that we’ve got more cases from those observed in the test, but we’re more likely to be missing cases through rationing or other reasons of tests not being available. Bottom line - if you were able to do more tests, you’d find more cases.</p>

<h2 id="could-we-adjust-incidence-estimates-based-on-test-positivity-rates">Could we adjust incidence estimates based on test positivity rates?</h2>

<p>In late March and early April of this year, fully 50% of tests in New Jersey and New York were positive, according to data from covidtracking.com:</p>

<object type="image/svg+xml" data="/img/0178-smoothed-test-rates.svg" width="100%"><img src="/img/0178-smoothed-test-rates.png" width="100%" /></object>

<p>We strongly suspect both that:</p>

<ul>
  <li>the number of confirmed cases at those times was a big underestimate of the number of actual cases, and</li>
  <li>this underestimate was more of an issue than more recently when the tests seemed to have wider coverage.</li>
</ul>

<p>Can we do anything about this when estimating population values?</p>

<p>The statistical conundrum here can be illustrated by a simple numeric example. Suppose we have two locations, Ambrosia and Ruritania. Both have 10 confirmed cases, but for Ambrosia these are based on 20 tests (test positivity of 50%) and in Ruritania they are based on 1,000 tests (1%, approximately the rate <a href="https://www.health.gov.au/news/health-alerts/novel-coronavirus-2019-ncov-health-alert/coronavirus-covid-19-current-situation-and-case-numbers">here in Australia</a> at the time of writing). We can imagine several unrealistic extreme approaches in how we treat the inference from these confirmed case numbers to the number of people in the population with the disease:</p>

<ol type="A">
<li>We can accept them on face value and say each location has 10 cases.</li>
<li>We can multiply them both by some common factor ("10" is commonly thrown around) to represent undiagnosed cases (whether these are unsymptomatic, not-yet-symptomatic, or symptomatic and can't get a test) and say each location has 100 cases.</li>
<li>We can treat the tests as a sample from the population and multiply the cases in Ambrosia by 50 to bring its cases up to "what they would be if they'd done as many tests as Ruritania", giving us 500 cases in Ambrosia and 10 in Ruritania. In situations with more diverse numbers, this can be generalized by multiplying confirmed cases by the test positivity rate and also by some arbitrary constant that is at least as large as the inverse of the lowest test positivity of any location.</li>
</ol>

<p>I should stress at this point that as far as I am aware, no serious commentator proposes any of these methods to be satisfactory. However, the revealed preference is either to use method A and simply write a caveat (“only confirmed cases are shown”), or method B as a crude “this is the best adjustment for now” pragmatic alternative.</p>

<p>Method C has more intuitive appeal to me than either of the others. For example, it seems extraordinary to suggest that when New York had a test positivity rate of 50% that there weren’t many, many more people who would have been confirmed if tests were as widely available per sick person as is the case in Australia today. However, method C has problems too. In particular, there is an implicit assumption that increasing the testing ‘sample’ would see a steady test positivity rate; whereas surely as more people were tested, the testing would be extended eventually to marginal cases and the rate of positives would start to decline.</p>

<p>All of this is a consequence of the difficulties of inference to an unseen population without a random sample, or at least a sample generated by a known process. Because the selection of the sample in this case is inextricably tied up with the variable we want to measure, we would need a very very good model indeed of the testing process to be able to meaningfully draw inferences from confirmed cases to population prevalence.</p>

<p>We can actually generalise all three methods into a model:</p>

<script type="math/tex; mode=display">y = mxq^k\epsilon</script>

<p>where</p>

<ul>
  <li><code class="highlighter-rouge">y</code> is the population prevalence</li>
  <li><code class="highlighter-rouge">x</code> is the confirmed cases</li>
  <li><code class="highlighter-rouge">m</code> is an unknown constant multiplier of <code class="highlighter-rouge">x</code></li>
  <li><code class="highlighter-rouge">q</code> is the test positivity rate</li>
  <li><code class="highlighter-rouge">k</code> is an unknown constant exponent of <code class="highlighter-rouge">q</code>, between zero and one.</li>
  <li>\(\epsilon\) is a random error term of unknown distribution</li>
</ul>

<p>When <code class="highlighter-rouge">k</code> is zero we get method B - just multiply the confirmed cases by a constant to get your estimated population cases. If <code class="highlighter-rouge">m</code> is one and <code class="highlighter-rouge">k</code> is zero, then you are right down to method A.</p>

<p>On the other hand, when <code class="highlighter-rouge">k</code> is 1 we get method C, ie assuming the number of confirmed cases would increase poportionately if tests were hypothetically increased.</p>

<p>There’s something nice about this generalisation - which often happens when we can identify a general equation that are current methods are all special cases of - which is that a new alternative D emerges. Any value of <code class="highlighter-rouge">k</code> between the extremes of zero and one is a nice compromise between the two. This compromise concedes the commonsense notion that the higher the test positivity, the more cases this suggests are out there, without going to the extreme of method C.</p>

<h2 id="adjusting-confirmed-cases-for-test-positivity-using-new-york-as-an-example">Adjusting confirmed cases for test positivity using New York as an example</h2>

<p>The problem of course is that we don’t know what either <code class="highlighter-rouge">m</code> or <code class="highlighter-rouge">k</code> are, nor is there any obvious means of estimating them. To make things worse, there is no reason at all for them to be constant across different locations or even the same location at different times. They will be driven by factors such as availability and criteria for testing, amongst others.</p>

<p>If we had an independent estimate of population incidence we could estimate values, but we don’t yet have such a measure of any reliability, certainly not a time series by location. Random samples for testing from the population is the way to get prevalence rates (and if you did it often enough you could estimate incidence too), but you need <a href="https://www.statschat.org.nz/2020/04/25/why-new-york-is-different/">large samples and tests with very low false-positive rates to do this reliably</a> if the disease is rare.</p>

<p>One alternative method is to take the number of deaths “later” as an indicator of the number of actual cases now. Deaths from COVID-19 are more reliably counted than cases, although there is still <a href="https://www.newscientist.com/article/mg24632804-100-how-many-people-have-really-died-from-covid-19-so-far/">almost certainly a significant undercount</a>. There is also the problem that we don’t know the infection fatality rate to any degree of precision (although expert opinion, not without dissent, is converging on a range of of around 0.5% to 1%). Anyway, it turns out we can get a face-plausible estimate of actual cases in New York by multiplying deaths seven days later by 100.</p>

<p>The chart below shows estimates of total cases in New York based on my three methods enumerated above, a “generalized” method D where I use <code class="highlighter-rouge">k = 0.5</code>, and the “deaths seven days later multiplied by 100” methods.</p>

<object type="image/svg+xml" data="/img/0178-diff-methods.svg" width="100%"><img src="/img/0178-diff-methods.png" width="100%" /></object>

<p>To reduce the chance of focusing on the wrong thing, I have removed the labels from the vertical axis in these charts.</p>

<p>I chose 7 days (rather than 14 or 4, for example) for the deaths-multiplier method just by eyeballing variants of this chart. I then chose values of <code class="highlighter-rouge">m</code> specifically so totals from all methods (other than simply “confirmed cases”) delivered similar totals to the around 2.1 million total cases in New York delivered by the crude “multiply deaths by 100” method. Please note that I choose the word “crude” very deliberately here - I am not saying that the number of cases in New York is 2.1 million although it might be - I am just going to be using this as ballpark figure to compare the impact on analysis based on growth-rate of different methods of estimating population prevalence that give similar totals.</p>

<p>Here is an alternative version showing just the two methods I think are worth focusing on:</p>

<object type="image/svg+xml" data="/img/0178-two-methods-smoothed.svg" width="100%"><img src="/img/0178-two-methods-smoothed.png" width="100%" /></object>

<p>The illustration here is of how the ‘generalized adjustment’ method has slightly higher numbers earlier in the outbreak (adjusting upbecause of the high test positivity rates), and lower towards the end. However, both methods of course suffer from the very noisy data; and both have unrealistically small numbers and high growth rates in the first 20 days of March.</p>

<h2 id="implications-for-growth-rates-and-effective-reproduction-number">Implications for growth rates and effective reproduction number</h2>

<p>For some purposes - including forecasting so long as total cases are well below herd immunity levels (which they certainly are) - growth rates are more important than the absolute level. If we had to choose between methods A, B and C or my generalized method D in converting our confirmed cases to population estimates, what is the impact on estimates of the effective reproduction number (R) at a point in time?</p>

<p>The excellent <a href="https://cbdrh.github.io/ozcoviz/">Oz COVID 19 Visualisations</a> site is a joint effort of researchers at four different universities in New South Wales and Victoria and built as an RMarkdown dashboard. It estimates effective R for NSW with both methods A (reported case numbers) and B (multiplying by 10). The observation is made that it makes very little difference.</p>

<p>I wanted to try my methods C and D and see the impact on estimated effective reproduction number at a point in time. Adjusting figures upwards when test positivity is high (typically early in the outbreak) would lead to higher values of R earlier, and lower later, relative to methods that just take the confirmed cases as proportionate to the total cases.</p>

<p>So using the methods in Thompson et al’s <a href="https://www.sciencedirect.com/science/article/pii/S1755436519300350?via%3Dihub">Improved inference of time-varying reproduction numbers during infectious disease outbreaks</a> as implemented in the excellent EpiEstim R package, I estimated effective reproduction numbers based on each of my five sets of case numbers. These estimates draw on data on the distribution of the serial interval (ie the time between infections in a chain of infections) in <a href="https://www.medrxiv.org/content/10.1101/2020.02.03.20019497v2">this article by Nishiura et al</a> and I have copied my code to do this almost exactly from the <a href="https://github.com/CBDRH/ozcoviz/blob/master/nsw_eff_R_data_and_plot_prep.R">Oz COVID 19 Visualizations’ source code</a> for similar estimates for NSW. Here’s the result:</p>

<object type="image/svg+xml" data="/img/0178-r-methods.svg" width="100%"><img src="/img/0178-r-methods.png" width="100%" /></object>

<p>Pleasingly, my methods for correcting for test positivity rate (the bottom row of two plots) make a small improvement to the shape of the effective reproduction number over time. By ‘improvement’ I mean the estimated reproduction number doesn’t exceed the implausibly high value of 6, as happens when using the unadjusted or simple multiplier case counts. However, the improvement isn’t enough to make the first few weeks of estimates realistic. Basically, there just wasn’t enough testing (less than 50 per day being reported) for reliable estimates at that point, and I doubt any statistical wizadry could help much.</p>

<p>Here is a more readable version of the chart with just the two most important methods tried:</p>

<object type="image/svg+xml" data="/img/0178-two-r-methods.svg" width="100%"><img src="/img/0178-two-r-methods.png" width="100%" /></object>

<p>So, in conclusion, I think my method D isn’t bad as a means of adjusting incidence levels for test positivity rates. I think it will lead to better estimates of growth and of effective reproduction number. But it can’t work miracles - we don’t know how to calibrate it so it’s not going to be good for estimating the absolute value. And we still can’t get reliable estimates of growth or effective reproduction number when the data just aren’t there to support it.</p>

<h2 id="code">Code</h2>

<p>All the R code for today’s post is <a href="https://github.com/ellisp/blog-source/blob/master/_working/0178-covid-prevalence-inference.R">on GitHub</a> rather than in the post itself.</p>



		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2020/04/18/pred-interval-from-log-linear">Pragmatic prediction intervals from a quasi-likelihood GLM</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2020/05/17/covid-texas-incidence">Incidence of COVID-19 in Texas after adjusting for test positivity</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics
http://Http://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>