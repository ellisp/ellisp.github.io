      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Using svglite with web fonts</title>
      	
         
         
            <meta name ="description" content ="svglite is a great way for producing good graphics for the web but there's a small hack needed if you want to use web fonts with it.">
            <meta property="og:description" content ="svglite is a great way for producing good graphics for the web but there's a small hack needed if you want to use web fonts with it.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Using svglite with web fonts" />
         
            <meta property="og:image" content="https:/freerangestats.info/img/ozpolls/0150-svglite-with-fonts.png" />
         
		 
			<meta property="og:url" content="https://freerangestats.info/blog/2019/04/07/fonts-and-stuff.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2024/08/30/australian-economy>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Using svglite with web fonts</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>svglite is a great way for producing good graphics for the web but there's a small hack needed if you want to use web fonts with it.</p>
	   <p class="meta">07 Apr 2019</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <p>OK, no stats today, just fidgeting about with graphics devices and type faces. Caveat - the details of graphics formats and typefaces is not my area of real expertise, this blog post is me noting down things that I found useful and others might too. As always, corrections and comments are very welcome.</p>

<p>There are two main types of computer graphic formats:</p>

<ul>
  <li><em>vector</em> graphics, where the file is basically a set of instructions (start at x, draw a line at 30 degrees angle for y units, draw a circle of radius w centred at z, etc). Like something you generated with Inkscape or Adobe Illustrator.</li>
  <li><em>raster</em> or <em>bitmap</em> graphics which are basically an array of numbers telling the computer which how to colour each pixel. Like a digital photograph.</li>
</ul>

<p>Generally vector formats are far superior if you have the choice but large complex graphics (eg with millions of points, or maps with many fiddly bits) can be slow to render (and large to store). And until relatively recently many users’ web browsers could only show bitmap graphics. <a href="https://en.wikipedia.org/wiki/Internet_Explorer_8">Internet Explorer 8</a> was the last high-use browser of this sort we had to worry about.</p>

<p>For my blog I work almost purely with Scalable Vector Graphic (SVG) format by choice, and PNG (a relatively efficient and high quality bitmap format) when I have to.</p>

<p>My graphics workflow for this blog is generally:</p>

<ol>
  <li>Write the graphic to a Scalable Vector Graphic (SVG)</li>
  <li>Convert the SVGs to PNGs in batches using <a href="https://www.imagemagick.org/">ImageMagick</a></li>
</ol>

<p>I use the SVGs on the web pages that make up this blog; I need the PNG copies for posting on Twitter, Facebook and LinkedIn which don’t take SVGs, and also for some complex objects that would be too large as SVGs.</p>

<h2 id="a-quick-aside-on-anti-aliasing">A quick aside on anti-aliasing</h2>

<p>To get in the groove of thinking about graphics I’m going to start with the concept of <a href="https://www.webopedia.com/TERM/A/antialiasing.html">anti-aliasing</a>. Here are three closeups of a straight line in a computer graphic, generated in R by three different graphics devices. From left to right these were generated by <code class="language-plaintext highlighter-rouge">CairoSVG()</code>, <code class="language-plaintext highlighter-rouge">CairoPNG()</code> and <code class="language-plaintext highlighter-rouge">png()</code>.</p>

<p><img src="/img/0150-compare-anti-aliasing.png" width="100%" /></p>

<p>Aliasing (in graphics) refers to the jagged staircase-like bits of an image from approximating an ideal shape with crude collections of pixels. Anti-aliasing is basically the smoothing or blurring process to try to make the problem less obvious.</p>

<p>On a Windows machine (where I spend nearly all my working time), the <code class="language-plaintext highlighter-rouge">png()</code> device, no matter high a resolution you specify, will not use anti-aliasing and close ups of the image will reveal jagged bits like that in the right of the three options above. At the opposite end, a graphic that has been saved as SVG won’t have any aliasing at all coming from the file format itself; any jaggedness comes from the final rendering of the information in the file onto the screen (in the end, everything has to become pixels to get on the screen), not from how you generated the file.</p>

<p>The Cairo option in the middle has anti-aliasing taking place when the PNG file itself was generated. Files generated with <code class="language-plaintext highlighter-rouge">CairoPNG()</code> look much better than those from <code class="language-plaintext highlighter-rouge">png()</code>, but still can’t compete with the vector format even when the PNG is high resolution (eg 720 or more dots per inch).</p>

<p>Here’s the code that generated these examples</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">Cairo</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">svglite</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">frs</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">clipr</span><span class="p">)</span><span class="w">

</span><span class="n">png</span><span class="p">(</span><span class="s2">"0150-antialias-none.png"</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">res</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"No anti-alias png() device"</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">

</span><span class="n">CairoPNG</span><span class="p">(</span><span class="s2">"0150-antialias-cairo.png"</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">600</span><span class="p">,</span><span class="w"> </span><span class="n">dpi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">600</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Anti-aliased CairoPNG device"</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">

</span><span class="n">CairoSVG</span><span class="p">(</span><span class="s2">"0150-antialias-cairo.svg"</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">plot</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"l"</span><span class="p">,</span><span class="w"> </span><span class="n">bty</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"n"</span><span class="p">,</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"CairoSVG device"</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span></code></pre></figure>

<blockquote>
  <p>Potentially useful whimsical tip: once your awareness is raised about the need for anti-aliasing, you might become painfully aware of those unprofessional looking jagged bits in graphics. When working interactively in RStudio on Windows, all the graphics in your plot pane will look this way. If this hurts you like it hurts me, you can bring up a anti-aliased window with <code class="language-plaintext highlighter-rouge">CairoWin()</code> and plots will be rendered nicely on that window, and look much better than the crude default renditions. If you’re using two screens it’s also convenient for placing on your second screen.</p>
</blockquote>

<h2 id="different-flavours-of-svg">Different flavours of SVG</h2>

<p>Until recently I’ve been generating my SVG files with <code class="language-plaintext highlighter-rouge">CairoSVG()</code>. However, I’ve gotten very disatisfied with how text is rendered by that format. It’s hard to put my finger on what is wrong, but it looks blurry, particularly when it’s about 10 point in size which of course is nearly all the time in statistical graphics. Sometimes the problem goes away when you zoom in, but that isn’t really the point.</p>

<p>I eventually solved this problem by moving to the excellent <code class="language-plaintext highlighter-rouge">svglite</code> package by Hadley Wickham, Lionel Henry, T Jake Luciani, Matthieu Decorde and Vaudor Lis. <code class="language-plaintext highlighter-rouge">svglite</code> creates smaller and faster SVGs and has a much better treatment of text in particular. But <code class="language-plaintext highlighter-rouge">svglite</code> alone wasn’t enough for the way I needed typefaces treated - I’ll get to that later.</p>

<p>To go into this further, here are three different SVG files, rendered in this web page as images, created by <code class="language-plaintext highlighter-rouge">Cairo::CairoSVG()</code>, <code class="language-plaintext highlighter-rouge">grDevices::svg()</code> and <code class="language-plaintext highlighter-rouge">svglite::svglite()</code>.</p>

<p><img src="/img/0150-cairo-svg.svg" width="30%" />
<img src="/img/0150-svg.svg" width="30%" />
<img src="/img/0150-svglite.svg" width="30%" /></p>

<p>The first two approaches are very similar, but the <code class="language-plaintext highlighter-rouge">svglite</code> philosophy is quite different. <code class="language-plaintext highlighter-rouge">CairoSVG</code> and <code class="language-plaintext highlighter-rouge">svg</code> take text and turn it into many tiny shapes to draw; whereas <code class="language-plaintext highlighter-rouge">svglite</code> keeps the text as text in the SVG file and leaves it to the end user’s computer to render it. Zoom in close on any of those images above and the text will magnify nicely; but something about the relatively complicated approach of the first two makes them look a little blurred and complex when they’re looked at from a distance. This is the process of turning the text into individual shapes, interacting with the final rendering on the screen in some way that I don’t want to have to understand.</p>

<p>SVG files are just text files (in XML format) so we can look at the actual code (a huge advantage of SVG over other formats). Here’s the full text of the SVG generated by <code class="language-plaintext highlighter-rouge">CairoSVG</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;svg</span> <span class="na">xmlns=</span><span class="s">"http://www.w3.org/2000/svg"</span> <span class="na">xmlns:xlink=</span><span class="s">"http://www.w3.org/1999/xlink"</span> <span class="na">width=</span><span class="s">"432pt"</span> <span class="na">height=</span><span class="s">"432pt"</span> <span class="na">viewBox=</span><span class="s">"0 0 432 432"</span> <span class="na">version=</span><span class="s">"1.1"</span><span class="nt">&gt;</span>
<span class="nt">&lt;defs&gt;</span>
<span class="nt">&lt;g&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-0"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">"M 2.921875 0 L 2.921875 -26.128906 L 6.378906 -26.128906 L 6.378906 -15.398438 L 19.960938 -15.398438 L 19.960938 -26.128906 L 23.417969 -26.128906 L 23.417969 0 L 19.960938 0 L 19.960938 -12.316406 L 6.378906 -12.316406 L 6.378906 0 Z M 2.921875 0 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-1"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">"M 15.363281 -6.09375 L 18.679688 -5.683594 C 18.15625 -3.746094 17.1875 -2.242188 15.773438 -1.175781 C 14.359375 -0.105469 12.550781 0.425781 10.355469 0.429688 C 7.582031 0.425781 5.386719 -0.421875 3.769531 -2.128906 C 2.144531 -3.832031 1.335938 -6.226563 1.335938 -9.304688 C 1.335938 -12.484375 2.152344 -14.953125 3.792969 -16.714844 C 5.429688 -18.472656 7.558594 -19.351563 10.175781 -19.355469 C 12.703125 -19.351563 14.769531 -18.492188 16.378906 -16.769531 C 17.980469 -15.046875 18.785156 -12.621094 18.785156 -9.5 C 18.785156 -9.304688 18.777344 -9.019531 18.765625 -8.644531 L 4.652344 -8.644531 C 4.769531 -6.558594 5.355469 -4.96875 6.414063 -3.867188 C 7.472656 -2.761719 8.792969 -2.207031 10.371094 -2.210938 C 11.546875 -2.207031 12.550781 -2.515625 13.382813 -3.136719 C 14.214844 -3.75 14.875 -4.738281 15.363281 -6.09375 Z M 4.828125 -11.28125 L 15.398438 -11.28125 C 15.253906 -12.867188 14.847656 -14.0625 14.1875 -14.863281 C 13.160156 -16.097656 11.835938 -16.714844 10.210938 -16.71875 C 8.738281 -16.714844 7.5 -16.222656 6.496094 -15.238281 C 5.492188 -14.25 4.9375 -12.929688 4.828125 -11.28125 Z M 4.828125 -11.28125 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-2"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">"M 2.335938 0 L 2.335938 -26.128906 L 5.542969 -26.128906 L 5.542969 0 Z M 2.335938 0 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-3"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">"M 1.210938 -9.464844 C 1.207031 -12.964844 2.179688 -15.5625 4.132813 -17.25 C 5.757813 -18.652344 7.742188 -19.351563 10.085938 -19.355469 C 12.6875 -19.351563 14.816406 -18.5 16.46875 -16.796875 C 18.117188 -15.089844 18.941406 -12.734375 18.945313 -9.730469 C 18.941406 -7.292969 18.578125 -5.378906 17.847656 -3.984375 C 17.117188 -2.585938 16.054688 -1.5 14.660156 -0.730469 C 13.261719 0.0429688 11.734375 0.425781 10.085938 0.429688 C 7.433594 0.425781 5.292969 -0.417969 3.660156 -2.117188 C 2.023438 -3.8125 1.207031 -6.261719 1.210938 -9.464844 Z M 4.507813 -9.464844 C 4.503906 -7.035156 5.035156 -5.222656 6.09375 -4.019531 C 7.148438 -2.8125 8.476563 -2.207031 10.085938 -2.210938 C 11.675781 -2.207031 13.003906 -2.8125 14.0625 -4.027344 C 15.117188 -5.234375 15.644531 -7.082031 15.648438 -9.570313 C 15.644531 -11.90625 15.113281 -13.679688 14.050781 -14.890625 C 12.988281 -16.09375 11.664063 -16.699219 10.085938 -16.699219 C 8.476563 -16.699219 7.148438 -16.097656 6.09375 -14.898438 C 5.035156 -13.695313 4.503906 -11.882813 4.507813 -9.464844 Z M 4.507813 -9.464844 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-4"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">""</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-5"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">"M 5.898438 0 L 0.105469 -18.925781 L 3.421875 -18.925781 L 6.433594 -8.003906 L 7.554688 -3.9375 C 7.601563 -4.140625 7.929688 -5.441406 8.535156 -7.84375 L 11.546875 -18.925781 L 14.847656 -18.925781 L 17.679688 -7.949219 L 18.625 -4.332031 L 19.710938 -7.984375 L 22.953125 -18.925781 L 26.074219 -18.925781 L 20.15625 0 L 16.824219 0 L 13.8125 -11.335938 L 13.082031 -14.5625 L 9.25 0 Z M 5.898438 0 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-6"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">"M 2.371094 0 L 2.371094 -18.925781 L 5.257813 -18.925781 L 5.257813 -16.058594 C 5.992188 -17.398438 6.671875 -18.28125 7.296875 -18.710938 C 7.917969 -19.136719 8.605469 -19.351563 9.355469 -19.355469 C 10.433594 -19.351563 11.53125 -19.007813 12.652344 -18.320313 L 11.546875 -15.34375 C 10.761719 -15.804688 9.976563 -16.035156 9.195313 -16.039063 C 8.492188 -16.035156 7.863281 -15.824219 7.304688 -15.40625 C 6.746094 -14.980469 6.347656 -14.398438 6.113281 -13.652344 C 5.753906 -12.511719 5.578125 -11.261719 5.578125 -9.910156 L 5.578125 0 Z M 2.371094 0 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;symbol</span> <span class="na">overflow=</span><span class="s">"visible"</span> <span class="na">id=</span><span class="s">"glyph0-7"</span><span class="nt">&gt;</span>
<span class="nt">&lt;path</span> <span class="na">style=</span><span class="s">"stroke:none;"</span> <span class="na">d=</span><span class="s">"M 14.6875 0 L 14.6875 -2.386719 C 13.484375 -0.507813 11.71875 0.425781 9.390625 0.429688 C 7.878906 0.425781 6.492188 0.015625 5.230469 -0.816406 C 3.960938 -1.644531 2.980469 -2.808594 2.289063 -4.300781 C 1.589844 -5.792969 1.242188 -7.507813 1.246094 -9.445313 C 1.242188 -11.335938 1.558594 -13.046875 2.191406 -14.585938 C 2.820313 -16.121094 3.761719 -17.300781 5.023438 -18.125 C 6.28125 -18.941406 7.691406 -19.351563 9.25 -19.355469 C 10.386719 -19.351563 11.402344 -19.113281 12.296875 -18.632813 C 13.183594 -18.148438 13.910156 -17.519531 14.472656 -16.753906 L 14.472656 -26.128906 L 17.660156 -26.128906 L 17.660156 0 Z M 4.542969 -9.445313 C 4.539063 -7.019531 5.050781 -5.207031 6.074219 -4.007813 C 7.09375 -2.808594 8.300781 -2.207031 9.695313 -2.210938 C 11.09375 -2.207031 12.285156 -2.78125 13.265625 -3.929688 C 14.246094 -5.074219 14.734375 -6.824219 14.738281 -9.179688 C 14.734375 -11.765625 14.238281 -13.664063 13.242188 -14.878906 C 12.242188 -16.089844 11.011719 -16.699219 9.554688 -16.699219 C 8.125 -16.699219 6.933594 -16.117188 5.976563 -14.953125 C 5.019531 -13.789063 4.539063 -11.953125 4.542969 -9.445313 Z M 4.542969 -9.445313 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/symbol&gt;</span>
<span class="nt">&lt;/g&gt;</span>
<span class="nt">&lt;clipPath</span> <span class="na">id=</span><span class="s">"clip1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;path</span> <span class="na">d=</span><span class="s">"M 177.121094 177.121094 L 342.28125 177.121094 L 342.28125 212.679688 L 177.121094 212.679688 Z M 177.121094 177.121094 "</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/clipPath&gt;</span>
<span class="nt">&lt;/defs&gt;</span>
<span class="nt">&lt;g</span> <span class="na">id=</span><span class="s">"surface16"</span><span class="nt">&gt;</span>
<span class="nt">&lt;g</span> <span class="na">clip-path=</span><span class="s">"url(#clip1)"</span> <span class="na">clip-rule=</span><span class="s">"nonzero"</span><span class="nt">&gt;</span>
<span class="nt">&lt;g</span> <span class="na">style=</span><span class="s">"fill:rgb(0%,0%,0%);fill-opacity:1;"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-0"</span> <span class="na">x=</span><span class="s">"168.929688"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-1"</span> <span class="na">x=</span><span class="s">"195.288818"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-2"</span> <span class="na">x=</span><span class="s">"215.588379"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-2"</span> <span class="na">x=</span><span class="s">"223.69751"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-3"</span> <span class="na">x=</span><span class="s">"231.806641"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-4"</span> <span class="na">x=</span><span class="s">"252.106201"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-5"</span> <span class="na">x=</span><span class="s">"262.24707"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-3"</span> <span class="na">x=</span><span class="s">"288.606201"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-6"</span> <span class="na">x=</span><span class="s">"308.905762"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-2"</span> <span class="na">x=</span><span class="s">"321.060547"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;use</span> <span class="na">xlink:href=</span><span class="s">"#glyph0-7"</span> <span class="na">x=</span><span class="s">"329.169678"</span> <span class="na">y=</span><span class="s">"207.25"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/g&gt;</span>
<span class="nt">&lt;/g&gt;</span>
<span class="nt">&lt;/g&gt;</span>
<span class="nt">&lt;/svg&gt;</span></code></pre></figure>

<p>… and here it is for the SVG generated by <code class="language-plaintext highlighter-rouge">svglite</code>:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span>
<span class="nt">&lt;svg</span> <span class="na">xmlns=</span><span class="s">'http://www.w3.org/2000/svg'</span> <span class="na">xmlns:xlink=</span><span class="s">'http://www.w3.org/1999/xlink'</span> <span class="na">viewBox=</span><span class="s">'0 0 720.00 576.00'</span><span class="nt">&gt;</span>
<span class="nt">&lt;defs&gt;</span>
  <span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[
    line, polyline, path, rect, circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
  ]]&gt;</span><span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/defs&gt;</span>
<span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">'100%'</span> <span class="na">height=</span><span class="s">'100%'</span> <span class="na">style=</span><span class="s">'stroke: none; fill: #FFFFFF;'</span><span class="nt">/&gt;</span>
<span class="nt">&lt;defs&gt;</span>
  <span class="nt">&lt;clipPath</span> <span class="na">id=</span><span class="s">'cpMTc3LjEyfDYyOS4yOHwzNTUuNjh8MTc3LjEy'</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rect</span> <span class="na">x=</span><span class="s">'177.12'</span> <span class="na">y=</span><span class="s">'177.12'</span> <span class="na">width=</span><span class="s">'452.16'</span> <span class="na">height=</span><span class="s">'178.56'</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/clipPath&gt;</span>
<span class="nt">&lt;/defs&gt;</span>
<span class="nt">&lt;g</span> <span class="na">clip-path=</span><span class="s">'url(#cpMTc3LjEyfDYyOS4yOHwzNTUuNjh8MTc3LjEy)'</span><span class="nt">&gt;&lt;text</span> <span class="na">x=</span><span class="s">'318.96'</span> <span class="na">y=</span><span class="s">'278.15'</span> <span class="na">style=</span><span class="s">'font-size: 60.00px; font-family: Indie Flower;'</span> <span class="na">textLength=</span><span class="s">'168.48px'</span> <span class="na">lengthAdjust=</span><span class="s">'spacingAndGlyphs'</span><span class="nt">&gt;</span>Hello world<span class="nt">&lt;/text&gt;&lt;/g&gt;</span>
<span class="nt">&lt;/svg&gt;</span></code></pre></figure>

<p>The <code class="language-plaintext highlighter-rouge">svglite</code> version is <em>much</em> shorter because instead of describing exactly how each character looks, it just says “write ‘Hello world’ in the middle of the graphic, at 60 points in size, using the Indie Flower font family”.</p>

<p>That last point - “using the Indie Flower font family” is important too. It means that this font family needs to be available at the point the SVG file is rendered on-screen ie the end user’s machine. Whereas in <code class="language-plaintext highlighter-rouge">CairoSVG</code> and <code class="language-plaintext highlighter-rouge">svg</code>, no font family is recorded in the SVG file itself, the font family is taken into account at the generation of the SVG and has to be available on the developer’s machine.</p>

<p>As it happens, the “Indie Flower” type face isn’t installed on my computer and probably isn’t on yours either. When R encountered an instruction to use a typeface it didn’t know, it fell back on Arial and that’s how the two images on the left were generated. When a web browser encounters such an instruction, it falls back (at least if it’s Chrome or Edge) on Times New Roman or equivalent. This is why the image on the right looks different to the other two - it’s a question of a web browsers fall-back type face, compared to R’s.</p>

<p>Here’s the code that produced those three images and got the code from the SVG files to put in this blog post:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">CairoSVG</span><span class="p">(</span><span class="s2">"0150-cairo-svg.svg"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indie Flower"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
</span><span class="n">plot.new</span><span class="p">()</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"Hello world"</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">

</span><span class="n">svg</span><span class="p">(</span><span class="s2">"0150-svg.svg"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indie Flower"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
</span><span class="n">plot.new</span><span class="p">()</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"Hello world"</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">

</span><span class="n">svglite</span><span class="p">(</span><span class="s2">"0150-svglite.svg"</span><span class="p">)</span><span class="w">
</span><span class="n">par</span><span class="p">(</span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Indie Flower"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w">
</span><span class="n">plot.new</span><span class="p">()</span><span class="w">
</span><span class="n">text</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"Hello world"</span><span class="p">)</span><span class="w">
</span><span class="n">dev.off</span><span class="p">()</span><span class="w">


</span><span class="n">print_to_screen</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">fn</span><span class="p">){</span><span class="w">
  </span><span class="n">txt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">readChar</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span><span class="w"> </span><span class="n">file.info</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span><span class="o">$</span><span class="n">size</span><span class="p">)</span><span class="w">
  </span><span class="n">write_clip</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">print_to_screen</span><span class="p">(</span><span class="s2">"../img/0150-cairo-svg.svg"</span><span class="p">)</span><span class="w">
</span><span class="n">print_to_screen</span><span class="p">(</span><span class="s2">"../img/0150-svglite.svg"</span><span class="p">)</span></code></pre></figure>

<h2 id="solving-the-web-font-problem-for-svglite">Solving the web font problem for svglite</h2>

<p>So, I much preferred the smaller size, faster creation and download, and better look for text from <code class="language-plaintext highlighter-rouge">svglite</code> - but I had a new problem, of how to get custom fonts rendering reliably. I use web fonts from Google for my web page to get my HTML/CSS consistent with the graphic images, so in practice I need a way to render Google web fonts in SVGs, regardless of whether the user has them on their end computer or not.</p>

<p><code class="language-plaintext highlighter-rouge">svglite</code> has a <code class="language-plaintext highlighter-rouge">user_fonts</code> argument that is meant to embed fonts that are on the developer’s machine inside the SVG if desired, but <a href="https://github.com/r-lib/svglite/issues/95">as far as I can tell it doesn’t work</a>. So I forced myself to look a bit into how the SVG format works, and after wading through a number of out of date bits of info on the web eventually realised that I just needed the line <code class="language-plaintext highlighter-rouge">@import url('https://fonts.googleapis.com/css?family=Indie Flower:400,400i,700,700i');</code> added (for the Indie Flower case). So the <code class="language-plaintext highlighter-rouge">svglite</code> file above just needs to become as follows:</p>

<figure class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version='1.0' encoding='UTF-8' ?&gt;</span>
<span class="nt">&lt;svg</span> <span class="na">xmlns=</span><span class="s">'http://www.w3.org/2000/svg'</span> <span class="na">xmlns:xlink=</span><span class="s">'http://www.w3.org/1999/xlink'</span> <span class="na">viewBox=</span><span class="s">'0 0 720.00 576.00'</span><span class="nt">&gt;</span>
<span class="nt">&lt;defs&gt;</span>
  <span class="nt">&lt;style</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span><span class="cp">&lt;![CDATA[
    line, polyline, path, rect, circle {
      fill: none;
      stroke: #000000;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-miterlimit: 10.00;
    }
  ]]&gt;</span><span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;style&gt;</span>
  @import url('https://fonts.googleapis.com/css?family=Indie Flower:400,400i,700,700i');
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/defs&gt;</span>
<span class="nt">&lt;rect</span> <span class="na">width=</span><span class="s">'100%'</span> <span class="na">height=</span><span class="s">'100%'</span> <span class="na">style=</span><span class="s">'stroke: none; fill: #FFFFFF;'</span><span class="nt">/&gt;</span>
<span class="nt">&lt;defs&gt;</span>
  <span class="nt">&lt;clipPath</span> <span class="na">id=</span><span class="s">'cpMTc3LjEyfDYyOS4yOHwzNTUuNjh8MTc3LjEy'</span><span class="nt">&gt;</span>
    <span class="nt">&lt;rect</span> <span class="na">x=</span><span class="s">'177.12'</span> <span class="na">y=</span><span class="s">'177.12'</span> <span class="na">width=</span><span class="s">'452.16'</span> <span class="na">height=</span><span class="s">'178.56'</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;/clipPath&gt;</span>
<span class="nt">&lt;/defs&gt;</span>
<span class="nt">&lt;g</span> <span class="na">clip-path=</span><span class="s">'url(#cpMTc3LjEyfDYyOS4yOHwzNTUuNjh8MTc3LjEy)'</span><span class="nt">&gt;&lt;text</span> <span class="na">x=</span><span class="s">'318.96'</span> <span class="na">y=</span><span class="s">'278.15'</span> <span class="na">style=</span><span class="s">'font-size: 60.00px; font-family: Indie Flower;'</span> <span class="na">textLength=</span><span class="s">'168.48px'</span> <span class="na">lengthAdjust=</span><span class="s">'spacingAndGlyphs'</span><span class="nt">&gt;</span>Hello world<span class="nt">&lt;/text&gt;&lt;/g&gt;</span>
<span class="nt">&lt;/svg&gt;</span></code></pre></figure>

<p>This renders nicely, with the correct typeface and all:</p>

<object type="image/svg+xml" data="/img/0150-svglite-with-fonts.svg" width="50%"></object>

<p>… albeit with one last change necessary to how I organise my blog. I used to include my SVG files in the blog using the <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> tag, such as:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">'/img/0150-svglite-with-fonts.svg'</span> <span class="na">width=</span><span class="s">'50%'</span><span class="nt">&gt;</span></code></pre></figure>

<p>An SVG file that is called into a webpage by <code class="language-plaintext highlighter-rouge">&lt;img&gt;</code> is not allowed to get information from external sites. It has to instead be included with an <code class="language-plaintext highlighter-rouge">&lt;object&gt;</code> tag as follows:</p>

<figure class="highlight"><pre><code class="language-html" data-lang="html"><span class="nt">&lt;object</span> <span class="na">type=</span><span class="s">"image/svg+xml"</span> <span class="na">data=</span><span class="s">'/img/0150-svglite-with-fonts.svg'</span> <span class="na">width=</span><span class="s">'50%'</span><span class="nt">&gt;&lt;/object&gt;</span></code></pre></figure>

<p>This has the disadvantage that a user can no longer right-click on the image and save it. They can still view the “frame source”, copy it into a text editor and save it from there, but that’s going to put off a lot of users who aren’t used to thinking of an image as being fully represented by a bunch of code that can be pasted into Notepad! I imagine I’ll think of something to get around this.</p>

<p>Embedding my SVGs with <code class="language-plaintext highlighter-rouge">&lt;object&gt;</code> is also necessary if I want to incorporate interactivity (eg tooltips or more), so it’s probably a good habit to get into.</p>

<p>I knocked up a <a href="https://github.com/ellisp/frs-r-package/blob/master/pkg/R/svg_googlefonts.R">quick and probably non-robust hack of a function <code class="language-plaintext highlighter-rouge">svg_googlefonts()</code></a> to add the necessary font imports in <code class="language-plaintext highlighter-rouge">&lt;style&gt;</code> tags to an SVG generated by <code class="language-plaintext highlighter-rouge">svglite</code>. Usage is exceptionally simple. It takes a previously created SVG file (in this case, the “0150-svglite.svg” file created earlier in this post), the name of the Google fonts (one or more) to insert, and saves as a new version (or over the original, which is the convenient default for how I’ll be using it):</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">svg_googlefonts</span><span class="p">(</span><span class="s2">"0150-svglite.svg"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Indie Flower"</span><span class="p">,</span><span class="w"> </span><span class="n">new_svgfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"0150-svglite-with-fonts.svg"</span><span class="p">)</span></code></pre></figure>

<p>That’s now in my <code class="language-plaintext highlighter-rouge">frs</code> R package of convenient utilities associated with this blog.</p>

<p>That’s all for now. In summary:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">svglite</code> makes fast, small, well-rendered SVG images which treat text the way SVG is designed to</li>
  <li>but if you want to use typefaces that aren’t going to be on every user’s machine you need to embed them in the SVG or have the SVG import them. My <code class="language-plaintext highlighter-rouge">svg_googlefonts()</code> function helps you with the latter, and the resulting SVG files need to be included in web pages with the <code class="language-plaintext highlighter-rouge">&lt;object&gt;</code> tag.</li>
</ul>


		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2019/03/31/fed-election-page">Website with Australian federal election forecasts</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2019/04/20/yield-curve">Animating the US Treasury yield curve rates</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
			<p>My day job is Director of the <a href='https://sdd.spc.int/'>Statistics for Development Division</a> at the Pacific Community, the principal scientific and technical organisation in the Pacific region, proudly supporting development since 1947. We are an international development organisation owned and governed by our 27 country and territory members. This blog is not part of my role there and contains my personal views only.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="https://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="https://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics https://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>