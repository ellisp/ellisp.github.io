      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Familiarisation with the Australian Election Study</title>
      	
         
         
            <meta name ="description" content ="I familiarise myself with the 2016 Australian Election Study, a wonderful source of individual level data on attitudes and behaviour relating to voting.">
            <meta property="og:description" content ="I familiarise myself with the 2016 Australian Election Study, a wonderful source of individual level data on attitudes and behaviour relating to voting.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Familiarisation with the Australian Election Study" />
         
            <meta property="og:image" content="http://freerangestats.info/img/ozpolls/0152-change.png" />
         
		 
			<meta property="og:url" content="http://freerangestats.info/blog/2019/04/22/AES-intro.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2020/10/11/hamlet>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Familiarisation with the Australian Election Study</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>I familiarise myself with the 2016 Australian Election Study, a wonderful source of individual level data on attitudes and behaviour relating to voting.</p>
	   <p class="meta">22 Apr 2019</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <p>The <a href="https://australianelectionstudy.org/">Australian Election Study</a> is an impressive long term research project that has collected the attitudes and behaviours of a sample of individual voters after each Australian federal election since 1987. All the datasets and documentation are freely available. An individual survey of this sort is a vital complement to the necessarily aggregate results provided by the Australian Electoral Commission, and is essential for coming closer to understanding political and social change. Many countries have a comparable data source.</p>

<p>Many thanks to the original researchers:</p>

<blockquote>
  <p>McAllister, Ian; Makkai, Toni; Bean, Clive; Gibson, Rachel Kay, 2017, “Australian Election Study, 2016”, doi:10.4225/87/7OZCZA, ADA Dataverse, V2, UNF:6:TNnUHDn0ZNSlIM94TQphWw==; 1. Australian Election Study December 2016 Technical Report.pdf</p>
</blockquote>

<p>In this blog post I just scratch the surface of the latest available data, from the time of the 2016 federal election. In later posts I’ll get into modelling it a bit deeper, and hopefully get a chance to look at some changes over time. Some of the code I use in this post for preparing the data might find its way into the <code class="highlighter-rouge">ozfedelect</code> R package, but not the data itself.</p>

<h2 id="getting-the-data">Getting the data</h2>

<p>The data need to be downloaded by hand from the Australian Data Archive via <a href="https://dataverse.ada.edu.au/dataset.xhtml?persistentId=doi:10.4225/87/7OZCZA">the Dataverse</a> (an international open source research data repository) in order to agree to the terms and conditions of use. The following code requires the SPSS version of the data and the Excel version of the data dictionary to have been saved in an <code class="highlighter-rouge">./aes/</code> subfolder of the working directory.</p>

<p>The SPSS data has column names truncated at eight characters long, which means that some of the variables in the data don’t match those in the data dictionary. The code below makes the necessary manual adjustments to variable names from the dictionary to deal with this, and re-classes the categorical responses as factors with the correct level labels in the correct order. I do this by importing and joining to the data dictionary rather than extracting the attributes information from the SPSS import, which might have also worked; I prefer my manual approach so I can deal with some anomalies explicitly (for example, many of the values listed as 999 “skipped” in the data dictionary are NA in the SPSS data).</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#====================Preparation=============
</span><span class="w">
</span><span class="c1">#----------------------------packages---------------
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">rio</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">svglite</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">frs</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">readxl</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">testthat</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">survey</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">vcd</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">RColorBrewer</span><span class="p">)</span><span class="w">

</span><span class="c1">#---------------------Import and tidy data-----------------
# Download by hand from https://dataverse.ada.edu.au/dataset.xhtml?persistentId=doi:10.4225/87/7OZCZA
</span><span class="w">
</span><span class="n">aes2016_orig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">import</span><span class="p">(</span><span class="s2">"aes/2. Australian Election Study, 2016.sav"</span><span class="p">)</span><span class="w">
</span><span class="n">aes2016_code_orig</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">read_excel</span><span class="p">(</span><span class="s2">"aes/1. Australian Election Study, 2016 - Codebook.xlsx"</span><span class="p">,</span><span class="w">
                                </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Data Dictionary"</span><span class="p">)</span><span class="w">

</span><span class="n">aes2016_code</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016_code_orig</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rename</span><span class="p">(</span><span class="n">question_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Label...3</span><span class="p">,</span><span class="w">
         </span><span class="n">answer_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Label...5</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rename_all</span><span class="p">(</span><span class="n">tolower</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">fill</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">var_abb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">substring</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">var_abb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"H19_STAT"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"H19STATE"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"H19_PCOD"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"H19pcoRV"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"H20_othe"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"H20_oth"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"H25_othe"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"H25_oth"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Final_ST"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"finSTATE"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Samp_STA"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"SamSTATE"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"detailed"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"doutcome"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Responde"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"responID"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Start_Ti"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Sta_time"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Samp_PCO"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"SampcoRV"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Final_PC"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"finpcoRV"</span><span class="p">,</span><span class="w">
    </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Total_Du"</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"totaldur"</span><span class="p">,</span><span class="w">
    </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">var_abb</span><span class="w">
  </span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rbind</span><span class="p">(</span><span class="n">tibble</span><span class="p">(</span><span class="w">
    </span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"StateMap"</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Unidentified state variable"</span><span class="p">,</span><span class="w">
    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="m">8</span><span class="p">,</span><span class="w"> 
  </span><span class="n">answer_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"New South Wales"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Victoria"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Queensland"</span><span class="p">,</span><span class="w"> </span><span class="s2">"South Australia"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Western Australia"</span><span class="p">,</span><span class="w">
                   </span><span class="s2">"Tasmania"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Northern Territory"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Australian Capital Territory"</span><span class="p">),</span><span class="w">
  </span><span class="n">var_abb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"StateMap"</span><span class="w">
  </span><span class="p">))</span><span class="w">

</span><span class="n">aes2016_questions</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">distinct</span><span class="p">(</span><span class="n">aes2016_code</span><span class="p">,</span><span class="w"> </span><span class="n">var_abb</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">)</span><span class="w">

</span><span class="n">aes2016_answers</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016_code</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">var_abb</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">answer_label</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w">

</span><span class="c1"># Check all the names in the data now match those in the data dictionary:  
</span><span class="n">expect_equal</span><span class="p">(</span><span class="w">
  </span><span class="nf">names</span><span class="p">(</span><span class="n">aes2016_orig</span><span class="p">)[</span><span class="o">!</span><span class="nf">names</span><span class="p">(</span><span class="n">aes2016_orig</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">aes2016_questions</span><span class="o">$</span><span class="n">var_abb</span><span class="p">],</span><span class="w">
  </span><span class="n">character</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="c1"># ... and vice versa:
</span><span class="n">expect_equal</span><span class="p">(</span><span class="w">
  </span><span class="n">unique</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="o">$</span><span class="n">var_abb</span><span class="p">)[</span><span class="o">!</span><span class="n">unique</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="o">$</span><span class="n">var_abb</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">aes2016_orig</span><span class="p">)],</span><span class="w">
  </span><span class="n">character</span><span class="p">(</span><span class="m">0</span><span class="p">)</span><span class="w">
</span><span class="p">)</span><span class="w">

</span><span class="n">aes2016</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016_orig</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">as_tibble</span><span class="p">()</span><span class="w"> 

</span><span class="nf">attributes</span><span class="p">(</span><span class="n">aes2016</span><span class="p">)</span><span class="o">$</span><span class="n">question_labels</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">aes2016</span><span class="p">)</span><span class="w">

</span><span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">ncol</span><span class="p">(</span><span class="n">aes2016</span><span class="p">)){</span><span class="w">
  </span><span class="n">this_q</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">aes2016</span><span class="p">)[</span><span class="n">i</span><span class="p">])</span><span class="w">
  
  
  </span><span class="c1"># Sometimes a code like 999 'Skipped' is not present in the data but has already
</span><span class="w">  </span><span class="c1"># been replaced with an NA, so we don't want it in our factor level. So we need
</span><span class="w">  </span><span class="c1"># to find out what answers are actually used in the i'th column
</span><span class="w">  </span><span class="n">used_a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">pull</span><span class="p">(</span><span class="n">aes2016</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">))</span><span class="w">
  
  </span><span class="c1"># the answer labels for this particular question
</span><span class="w">  </span><span class="n">these_a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016_code</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">filter</span><span class="p">(</span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">aes2016</span><span class="p">)[</span><span class="n">i</span><span class="p">])</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">filter</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">used_a</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">arrange</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="w">
  
  </span><span class="nf">attributes</span><span class="p">(</span><span class="n">aes2016</span><span class="p">)</span><span class="o">$</span><span class="n">question_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">pull</span><span class="p">(</span><span class="n">this_q</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">)</span><span class="w">
  
  </span><span class="c1"># half a dozen open text questions don't match to the data dictionary so we exclude those:
</span><span class="w">  </span><span class="k">if</span><span class="p">(</span><span class="n">nrow</span><span class="p">(</span><span class="n">these_a</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> 
     </span><span class="o">!</span><span class="n">pull</span><span class="p">(</span><span class="n">this_q</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">)</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"What kind of work do you do? Full job title"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"What are (or were) the main tasks that you usually perform(ed)?"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"What kind of business or industry is (or was) that in?"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"What was your partner's main activity last week? (other specify)"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"What kind of work does (or did) your partner do? Provide job title"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Generally speaking, does your partner usually think of himself or herself as Liberal, Labor, National or what? (other specify)"</span><span class="p">)</span><span class="w">
     </span><span class="p">){</span><span class="w">
	 </span><span class="c1"># for the rest, we turn the response into a factor with the correct labels
</span><span class="w">    </span><span class="n">aes2016</span><span class="p">[</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">pull</span><span class="p">(</span><span class="n">aes2016</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pull</span><span class="p">(</span><span class="n">these_a</span><span class="p">,</span><span class="w"> </span><span class="n">answer_label</span><span class="p">))</span><span class="w">  
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="n">aes2016</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">age_2016</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2016</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">H</span><span class="m">2</span><span class="p">,</span><span class="w">
         </span><span class="n">agegrp_2016</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cut</span><span class="p">(</span><span class="n">age_2016</span><span class="p">,</span><span class="w"> 
                           </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">17.5</span><span class="p">,</span><span class="w"> </span><span class="m">24.5</span><span class="p">,</span><span class="w"> </span><span class="m">34.5</span><span class="p">,</span><span class="w"> </span><span class="m">44.5</span><span class="p">,</span><span class="w"> </span><span class="m">54.5</span><span class="p">,</span><span class="w"> </span><span class="m">64.5</span><span class="p">,</span><span class="w"> </span><span class="kc">Inf</span><span class="p">),</span><span class="w">
                           </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"0-17"</span><span class="p">,</span><span class="w"> </span><span class="s2">"18-24"</span><span class="p">,</span><span class="w"> </span><span class="s2">"25-34"</span><span class="p">,</span><span class="w"> </span><span class="s2">"35-44"</span><span class="p">,</span><span class="w"> </span><span class="s2">"45-54"</span><span class="p">,</span><span class="w"> </span><span class="s2">"55-64"</span><span class="p">,</span><span class="w"> </span><span class="s2">"65+"</span><span class="p">)),</span><span class="w">
         </span><span class="n">agegrp_2016</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">as.factor</span><span class="p">(</span><span class="n">replace_na</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">agegrp_2016</span><span class="p">),</span><span class="w"> </span><span class="s2">"Age unknown"</span><span class="p">)),</span><span class="w">
         </span><span class="n">sex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">replace_na</span><span class="p">(</span><span class="nf">as.character</span><span class="p">(</span><span class="n">H</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="s2">"Sex unknown"</span><span class="p">),</span><span class="w">
         </span><span class="n">first_pref_hr_grp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">1</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Liberal Party"</span><span class="p">,</span><span class="w"> </span><span class="s2">"National (Country) Party"</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Coalition"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Labor Party (ALP)"</span><span class="w">                              </span><span class="o">~</span><span class="w"> </span><span class="s2">"Labor"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Greens"</span><span class="w">                                         </span><span class="o">~</span><span class="w"> </span><span class="s2">"Greens"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Voted informal"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">1</span><span class="p">)</span><span class="w">                   </span><span class="o">~</span><span class="w"> </span><span class="s2">"Did not vote/voted informal"</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w">                                                     </span><span class="o">~</span><span class="w"> </span><span class="s2">"Other"</span><span class="w">
         </span><span class="p">),</span><span class="w">
         </span><span class="n">first_pref_sen_grp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Liberal Party"</span><span class="p">,</span><span class="w"> </span><span class="s2">"National (Country) Party"</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s2">"Coalition"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Labor Party (ALP)"</span><span class="w">                              </span><span class="o">~</span><span class="w"> </span><span class="s2">"Labor"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Greens"</span><span class="w">                                         </span><span class="o">~</span><span class="w"> </span><span class="s2">"Greens"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Voted informal"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nf">is.na</span><span class="p">(</span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="p">)</span><span class="w">                   </span><span class="o">~</span><span class="w"> </span><span class="s2">"Did not vote/voted informal"</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w">                                                     </span><span class="o">~</span><span class="w"> </span><span class="s2">"Other"</span><span class="w">
         </span><span class="p">),</span><span class="w">
         </span><span class="n">first_pref_sen_grp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Liberal Party"</span><span class="w">                                  </span><span class="o">~</span><span class="w"> </span><span class="s2">"Liberal"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"National (Country) Party"</span><span class="w">                       </span><span class="o">~</span><span class="w"> </span><span class="s2">"National"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"One Nation"</span><span class="w">                                     </span><span class="o">~</span><span class="w"> </span><span class="s2">"One Nation"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Labor Party (ALP)"</span><span class="w">                              </span><span class="o">~</span><span class="w"> </span><span class="s2">"Labor"</span><span class="p">,</span><span class="w">
           </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"Greens"</span><span class="w">                                         </span><span class="o">~</span><span class="w"> </span><span class="s2">"Greens"</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w">                                                     </span><span class="o">~</span><span class="w"> </span><span class="s2">"Other (including did not vote)"</span><span class="w">
         </span><span class="p">)</span><span class="w">
  </span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">first_pref_sen_grp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">toupper</span><span class="p">(</span><span class="n">first_pref_sen_grp2</span><span class="p">),</span><span class="w">
         </span><span class="n">first_pref_sen_grp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"^OTHER"</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">),</span><span class="w">
                                      </span><span class="s2">"OTHER (incl. did not vote)"</span><span class="p">,</span><span class="w">
                                      </span><span class="n">first_pref_sen_grp2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">first_pref_sen_grp2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_relevel</span><span class="p">(</span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w">
                                           </span><span class="n">toupper</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"Greens"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Labor"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Liberal"</span><span class="p">,</span><span class="w">
                                                     </span><span class="s2">"National"</span><span class="p">,</span><span class="w"> </span><span class="s2">"One Nation"</span><span class="p">))))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">tpp_alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">B</span><span class="m">11</span><span class="err">_</span><span class="m">1</span><span class="w">  </span><span class="o">%in%</span><span class="w"> </span><span class="s2">"Labor Party (ALP)"</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">B</span><span class="m">9</span><span class="err">_</span><span class="m">1</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="s2">"Labor Party (ALP)"</span><span class="p">)</span></code></pre></figure>

<p>The last few lines of that code also defines some summarised variables that lump various parties or non-votes together and will be useful in later analysis.</p>

<h2 id="survey-design-and-weights">Survey design and weights</h2>

<p>The AES in 2016 used two separate sampling frames: one provided by the <a href="https://www.aec.gov.au/">Australian Electoral Commission</a>, and one from the <a href="https://data.gov.au/dataset/ds-dga-19432f89-dc3a-4ef3-b943-5326ef1dbecc/details?q=">Geo-coded National Address File or GNAF</a>, a large, authoritative open data source of every address in Australia. For inference about Australian adults on the election roll (enrolment is required of all resident adult citizens by legislation), the AES team recommend using a combination of the two samples, and weights are provided in the <code class="highlighter-rouge">wt_enrol</code> column to do so.</p>

<p>The <a href="https://dataverse.ada.edu.au/file.xhtml?fileId=151&amp;version=2.1">technical report</a> describes data collection as mixed-mode (hard copy and online versions), with a solid system of managing contacts, reminders and non-returns.</p>

<p>The AEC sample is stratified by state, and the GNAF sample by Greater Capital City (GCC) statistical areas (which divide states into two eg “Greater Sydney” and “Rest of New South Wales”).  As far as I can see no GCC variable is provided for end-use analysts such as myself. Nor are the various postcode variables populated, and I can’t see a variable for electorate/division (presumably for statistical disclosure control purposes) which is a shame as it would be an important variable to use for a variety of multi-level analyses. So we have to use “state” as our best regional variable.</p>

<p>Post-stratification weighting (raking) was used by the AES to match the population proportions by sex, age group, state, and first preference vote in the House of Representatives. This latter calibration is particularly important to ensure that analysis gives appropriate weight to the supporters of the various parties; it is highly likely that non-response is related to political views (or non-views).</p>

<p>The weights have been scaled to add up to the sample size, rather than to population numbers (as would be the approach of eg a national statistical office). This is presumably out of deference for SPSS’ behaviour of treating survey weights as frequencies, which leads to appalling results if they add up to anything other than the sample size (and still sub-optimal results even then).</p>

<p>Table 16 of the technical report is meant to provide the weighting benchmarks for the post-stratification weighting, but the state, age and sex totals given are only for the GNAF sample; and the benchmarks given for which party voted for appear to be simply incorrect in a way I cannot determine. They add up to much more than either the AEC or GNAF sample, but much less than their combined total; and I can’t match their results with any of the plausible combinations of filters I’ve tried. I’d be happy for anyone to point out if I’m doing something wrong, but my working hypothesis is that Table 16 simply contains some mistakes, whereas the weights in the actual data are correct.</p>

<p>The code below explores the three sets of weights provided, and defines a survey design object (using Thomas Lumley’s <code class="highlighter-rouge">survey</code> package) that treats state as the strata for sampling, and sex, state, age and House of Representatives vote as post-stratification variables. Although I won’t make much use of the <code class="highlighter-rouge">survey</code> package today, I’ll almost certainly want it for more sophisticated analysis in a later post.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#--------------------Weighting-----------------------
# The sample has two parts - addresses supplied by the AEC, and addresses from 
# the GNAF (Geocoded National Address File). There are separate weights for each,
# so they can be analysed as two separate surveys or you can use the combined set of weights:
</span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">wt_aec</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'always'</span><span class="p">)</span><span class="w">    </span><span class="c1"># for comparison to previous waves of AES
</span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">wt_gnaf</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'always'</span><span class="p">)</span><span class="w">   </span><span class="c1"># inference about Australian adults
</span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">wt_enrol</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'always'</span><span class="p">)</span><span class="w">  </span><span class="c1"># inference about enrolled Australian adults
# There are 107 cases from the GNAF sample that have zero weight in the final combined sample:
</span><span class="n">filter</span><span class="p">(</span><span class="n">aes2016</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">wt_aec</span><span class="p">,</span><span class="w"> </span><span class="n">wt_gnaf</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="p">)</span><span class="w">

</span><span class="c1"># wt_enrol had been raked for age group, sex, state and first preference vote. See pages 32-33
# of the technical guide.
</span><span class="w">
</span><span class="c1"># These three state variables seem identical, and are all different from those in Table 16
# of the technical report:
</span><span class="n">cbind</span><span class="p">(</span><span class="w">
  </span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">finSTATE</span><span class="p">),</span><span class="w">
  </span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">StateMap</span><span class="p">),</span><span class="w">
  </span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">SamSTATE</span><span class="p">)</span><span class="w">
  </span><span class="p">)</span><span class="w">

</span><span class="c1"># In fact, Table 16 has the state, age and sex only of the GNAF sample, not the whole sample:
</span><span class="n">table</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">aes2016</span><span class="p">,</span><span class="w"> </span><span class="n">wt_gnaf</span><span class="w"> </span><span class="o">&gt;</span><span class="m">0</span><span class="p">)</span><span class="o">$</span><span class="n">finSTATE</span><span class="p">)</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">aes2016</span><span class="p">,</span><span class="w"> </span><span class="n">wt_gnaf</span><span class="w"> </span><span class="o">&gt;</span><span class="m">0</span><span class="p">)</span><span class="o">$</span><span class="n">agegrp_2016</span><span class="p">)</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">filter</span><span class="p">(</span><span class="n">aes2016</span><span class="p">,</span><span class="w"> </span><span class="n">wt_gnaf</span><span class="w"> </span><span class="o">&gt;</span><span class="m">0</span><span class="p">)</span><span class="o">$</span><span class="n">H</span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="c1"># The first pref party vote in Table 16 looks to be just wrong. The results below match those
# in the code book, but not in Table 16
</span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">first_pref_hr_grp</span><span class="p">,</span><span class="w"> </span><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'always'</span><span class="p">)</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">first_pref_sen_grp</span><span class="p">,</span><span class="w"> </span><span class="n">useNA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'always'</span><span class="p">)</span><span class="w">

</span><span class="c1"># Well, we'll assume that wt_enrol has actually been weighted as described, and ignore
# the problems in Table 16.
</span><span class="w">
</span><span class="c1"># Set up survey design:
</span><span class="n">aes2016_svy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">svydesign</span><span class="p">(</span><span class="o">~</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">strata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">SamSTATE</span><span class="p">,</span><span class="w"> </span><span class="n">weights</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">~</span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">aes2016</span><span class="p">)</span><span class="w">

</span><span class="c1"># Deduce population totals from the sums of weights (if weights were raked to match pop totals,
# then the sum of the weights should reveal what they were)
</span><span class="n">age_pop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">agegrp_2016</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">Freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w">

</span><span class="n">sex_pop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">sex</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">Freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w">

</span><span class="n">state_pop</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">SamSTATE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">Freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w">

</span><span class="n">age2016_svy</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rake</span><span class="p">(</span><span class="n">aes2016_svy</span><span class="p">,</span><span class="w"> </span><span class="n">sample.margins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="o">~</span><span class="n">sex</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="n">agegrp_2016</span><span class="p">,</span><span class="w"> </span><span class="o">~</span><span class="n">SamSTATE</span><span class="p">),</span><span class="w">
                    </span><span class="n">population.margins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">sex_pop</span><span class="p">,</span><span class="w"> </span><span class="n">age_pop</span><span class="p">,</span><span class="w"> </span><span class="n">state_pop</span><span class="p">))</span><span class="w">


</span><span class="c1"># Compare the weighted and unweighted response to a survey question
</span><span class="n">filter</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">var_abb</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"H14_2"</span><span class="p">)</span><span class="w">
</span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="n">H</span><span class="m">14</span><span class="err">_</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">)</span><span class="w">
</span><span class="n">table</span><span class="p">(</span><span class="n">aes2016</span><span class="o">$</span><span class="n">H</span><span class="m">14</span><span class="err">_</span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="c1"># Many more "yes" posted answers to the Internet when weighted. So people active on the internet
</span><span class="err">#</span><span class="w"> </span><span class="n">needed</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="p">(</span><span class="n">probably</span><span class="w"> </span><span class="n">younger</span><span class="p">)</span></code></pre></figure>

<h2 id="analysis---vote-and-one-question">Analysis - vote and one question</h2>

<p>Now we’re ready for some exploratory analysis. In Australia, the Senate is elected by proportional representation, a wider range of small parties stand candidates, and the first preference vote for that house is less subject to gaming by voters than is the single-transferrable-vote system in the House of Representatives. So I prefer to use Senate vote when examining the range of political opinion, particularly of supporters of the smaller parties. Here is one of the graphics that I love during exploration but which I despair of using for communication purposes - a mosaic plot, which beautifully visualises a contingency table of counts (or, in this case, weighted counts). This particular graphic shows the views of people who voted for different parties in the Senate on the trade off between reducing taxes and spening more on social services:</p>

<object type="image/svg+xml" data="/img/0152-tax-mosaic.svg" width="100%"></object>

<p>As any casual observer of Australian politics would have predicted, disproportionately large numbers (coloured blue to show the positive discrepency from the no-interaction null hypothesis) of Greens voters (and to a less extent Labor) are mildly or strongly in favour of spending more on social services. Correspondingly these parties’ supporters have relatively few people counted in the top left corner (coloured red to show a negative discrepancy from the null hypothesis) supporting reducing tax as the priority.</p>

<p>In contrast, there are relatively few Liberal voters in the social services camp, and disproportionately high numbers who favour reducing taxes.</p>

<p>The “other” voters - which includes those who did not vote, could not remember, or did not vote for one of the five most prominent parties - are disproportionately likely to sit on the fence or not have a view on the trade-off between social services and tax cuts, which again is consistent with expectations.</p>

<p>What about a different angle - what influences people when they decide their vote?</p>

<object type="image/svg+xml" data="/img/0152-decidin-vote-mosaic.svg" width="100%"></object>

<p>We see that Greens voters decided their vote disproportionately on the basis of “the policy issues”. Liberal voters have less people in the “policy” box than would be expected under the no-interaction null hypothesis and were more likely to decide based on either “the party leaders” or “the parties taken as a whole”. National voters stand out as the only party with a noticeable disproportionate count (high, in their case) in the “candidates in your electorate” box, emphasising the known spatially-specific nature of National’s support.</p>

<p>Here’s the code for drawing those mosaic plots, using the <code class="highlighter-rouge">vcd</code> R package that implements some useful ways of visualising categorical data.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#======================selected bivariate============
</span><span class="w">
</span><span class="c1">#------------------tax/social services-------------
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="n">E</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">)</span><span class="w">
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"OTHER"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"OTHER"</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">str_wrap</span><span class="p">(</span><span class="n">rownames</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="m">20</span><span class="p">))</span><span class="w">

</span><span class="n">mosaic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">shade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey70"</span><span class="p">,</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"v"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">legend_resbased</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">fontfamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roboto"</span><span class="p">,</span><span class="w"> </span><span class="n">pvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
       </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"y"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">labeling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">labeling_values</span><span class="p">(</span><span class="w">
         </span><span class="n">suppress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">),</span><span class="w">
         </span><span class="n">gp_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpar</span><span class="p">(</span><span class="n">fontfamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roboto"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">),</span><span class="w">
         </span><span class="n">gp_varnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpar</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"transparent"</span><span class="p">),</span><span class="w">
         </span><span class="n">just_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"center"</span><span class="p">,</span><span class="w"> </span><span class="s2">"right"</span><span class="p">),</span><span class="w">
         </span><span class="n">alternate_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
         </span><span class="n">rot_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">90</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span><span class="w">
         </span><span class="n">offset_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1.5</span><span class="p">,</span><span class="m">0</span><span class="p">),</span><span class="w">
         </span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">
       </span><span class="p">))</span><span class="w">
</span><span class="c1">#--------------how decide vote------------
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="n">B</span><span class="m">5</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">)</span><span class="w">
</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w">
</span><span class="n">colnames</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">grepl</span><span class="p">(</span><span class="s2">"OTHER"</span><span class="p">,</span><span class="w"> </span><span class="n">colnames</span><span class="p">(</span><span class="n">x</span><span class="p">))]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"OTHER"</span><span class="w">
</span><span class="n">rownames</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">paste0</span><span class="p">(</span><span class="n">str_wrap</span><span class="p">(</span><span class="n">rownames</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="m">20</span><span class="p">))</span><span class="w">

</span><span class="n">mosaic</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">shade</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">border</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey70"</span><span class="p">,</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"v"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">legend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">legend_resbased</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">fontfamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roboto"</span><span class="p">,</span><span class="w"> </span><span class="n">pvalue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
       </span><span class="n">xlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w"> </span><span class="n">ylab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"y"</span><span class="p">,</span><span class="w"> 
       </span><span class="n">labeling</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">labeling_values</span><span class="p">(</span><span class="w">
         </span><span class="n">suppress</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1000</span><span class="p">),</span><span class="w">
         </span><span class="n">gp_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpar</span><span class="p">(</span><span class="n">fontfamily</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Roboto"</span><span class="p">,</span><span class="w"> </span><span class="n">cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">),</span><span class="w">
         </span><span class="n">gp_varnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gpar</span><span class="p">(</span><span class="n">col</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"transparent"</span><span class="p">),</span><span class="w">
         </span><span class="n">just_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"center"</span><span class="p">,</span><span class="w"> </span><span class="s2">"right"</span><span class="p">),</span><span class="w">
         </span><span class="n">alternate_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
         </span><span class="n">rot_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">90</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">0</span><span class="p">),</span><span class="w">
         </span><span class="n">offset_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">0</span><span class="p">,</span><span class="m">1.5</span><span class="p">,</span><span class="m">0</span><span class="p">),</span><span class="w">
         </span><span class="n">digits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w">
       </span><span class="p">))</span></code></pre></figure>

<h2 id="analysis---vote-and-a-battery-of-questions">Analysis - vote and a battery of questions</h2>

<p>Like many social sciences surveys, the AES contains a number of batteries of questions with similar response sets. An advantage of this, both for an analyst and the consumer of their results, is that we can set up a common approach to comparing the responses to those questions. Here is a selection of diverging likert plots depicting interesting results from these questions:</p>

<object type="image/svg+xml" data="/img/0152-change.svg" width="100%"></object>

<p>Above, we see that Greens voters disproportionately think that Australia hasn’t gone far enough in allowing more migrants into the country, and One Nation voters unsurprisingly tend to think the opposite. Views on change in Australia relating to Aboriginal assistance and land rights follow a similar pattern. Interestingly, there is less partisan difference on some other issues such as “equal opportunities for women”. Overall, the pattern is clear of increasing tendency to think that “things have gone to far” as we move across the spectrum (Greens-Labor-Liberal-National-One Nation).</p>

<object type="image/svg+xml" data="/img/0152-agree-economic.svg" width="100%"></object>

<p>When it comes to attitudes on the left-right economic issues, we see subtle but expected party differences (chart above). Liberal supporters are particularly inclined to think trade unions have too much power and should be regulated; but to disagree with the statement that income and wealth should be distributed towards ordinary working people.</p>

<object type="image/svg+xml" data="/img/0152-agree-social.svg" width="100%"></object>

<p>In the social issues chart above, we see the Greens’ voters strongly disagreeing with turning back boats of asylum seekers, and reintroducing the death penalty - issues where One Nation voters tend to agree with the statement. Again, the clear sequencing of parties’ supporters (Greens-Labor-Liberal-National-One Nation) is most obvious on these social/cultural touchpoint issues, in contrast to the left-right economic debate.</p>

<object type="image/svg+xml" data="/img/0152-trust.svg" width="100%"></object>

<p>In the above, we see high levels of confidence in the armed forces, police and universities across all parties’ supporters, and distrust in the press, television (what does it even mean to trust the television?) and political parties. Differences by party in trust in institutions varies along predictable party lines eg voters of the Liberal party tend to have less confidence in unions. One Nation voters have particularly low trust in the Australian political system, consistent with the mainstream interpretation in political science of the rise of socially conservative populist parties of this sort.</p>

<object type="image/svg+xml" data="/img/0152-spend.svg" width="100%"></object>

<p>Attitudes to public spend are fairly consistent across parties, with subtle but unsurprising differences in a few value-based touch points such as defence (Greens favour spending less) and unemployment benefits (Greens favour spending more but the three conservative parties favour spending less; Labor voters are in the middle).</p>

<object type="image/svg+xml" data="/img/0152-knowledge.svg" width="100%"></object>

<p>Finally, when it comes to factual knowledge of election law and constitutional issues, there is little to say from a party perspective. Many people don’t know the maximum period between federal elections for the lower house (the correct answer is three); and doubtless niether know nor care about the need to pay a deposit to stand for election. But there is no obvious difference by party voted for.</p>

<p>In summary, on many of the key social variables of the day, we see the expected greatest contrast between supporters of the Greens on one hand and One Nation on the other, with the ALP, Liberal and National voters strung out between. Economic issues indicate another but closely related dimension, with One Nation closer to the Greens than they are to the other socially conservative parties on statements such as “big business in this country has too much power”, “the government should take measures to reduce differences in income levels”  and “trade unions in this country have too much power”.</p>

<p>Here’s the code for drawing those diverging-Likert plots. I’m not particularly proud of it, it’s a bit repetitive (I hadn’t realised I’d be doing six of these), but it get’s the job done. There are some specialist R packages for drawing these charts, but I prefer (at this point) build them with the standard grammar of graphics tools in <code class="highlighter-rouge">ggplot2</code> rather learn a new specific API.</p>

<ul>
  <li>Post continues after code extract*</li>
</ul>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#=================Batteries of similar questions========================
</span><span class="w">

</span><span class="c1">#------------------Exploration---------------------
</span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="nb">F</span><span class="m">7</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">first_pref_sen_grp</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">,</span><span class="w"> </span><span class="n">Ntotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">round</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">   </span><span class="c1"># Immigration
</span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="nb">F</span><span class="m">6</span><span class="err">_</span><span class="m">4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">first_pref_sen_grp</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">,</span><span class="w"> </span><span class="n">Ntotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">round</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="c1"># war on terror
</span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="nb">F</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">first_pref_sen_grp</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">,</span><span class="w"> </span><span class="n">Ntotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">round</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">   </span><span class="c1"># Republic
</span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">E</span><span class="m">9</span><span class="err">_</span><span class="m">13</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">first_pref_sen_grp</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">,</span><span class="w"> </span><span class="n">Ntotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">round</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">   </span><span class="c1"># trust universities
</span><span class="n">svytable</span><span class="p">(</span><span class="o">~</span><span class="w"> </span><span class="n">E</span><span class="m">9</span><span class="err">_</span><span class="m">14</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">first_pref_sen_grp</span><span class="p">,</span><span class="w"> </span><span class="n">aes2016_svy</span><span class="p">,</span><span class="w"> </span><span class="n">Ntotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="n">round</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w">   </span><span class="c1"># trust political system
</span><span class="w">

</span><span class="c1">#-----------Confidence in institutions----------------------
</span><span class="n">d</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">E</span><span class="m">9</span><span class="err">_</span><span class="m">1</span><span class="o">:</span><span class="n">E</span><span class="m">9</span><span class="err">_</span><span class="m">14</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"variable"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"var_abb"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">institution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"How much .+\\? "</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">institution</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Not very much confidence"</span><span class="p">,</span><span class="w"> </span><span class="s2">"None at all"</span><span class="p">),</span><span class="w">
         </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freq</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">negative</span><span class="p">,</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"None at all"</span><span class="p">,</span><span class="w"> 
                                          </span><span class="s2">"Not very much confidence"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"A great deal of confidence"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Quite a lot of confidence"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">institution</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">institution</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">))</span><span class="w">

</span><span class="n">pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="s2">"RdYlGn"</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">1</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)]</span><span class="w">

</span><span class="n">d</span><span class="m">1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">institution</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">negative</span><span class="p">),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="o">!</span><span class="n">negative</span><span class="p">),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal</span><span class="p">,</span><span class="w">
                    </span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
                    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"None at all"</span><span class="p">,</span><span class="w"> 
                                  </span><span class="s2">"Not very much confidence"</span><span class="p">,</span><span class="w">
                                  </span><span class="s2">"Quite a lot of confidence"</span><span class="p">,</span><span class="w">
                                  </span><span class="s2">"A great deal of confidence"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"100%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">expand_limits</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.spacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"lines"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Attitudes to institutions, by first preference Senate vote in 2016"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"How much confidence do you have in the following organisation? ..."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: Australian Election Study 2016; analysis by freerangestats.info."</span><span class="p">)</span><span class="w">

</span><span class="c1">#-----------more or less expenditure than now----------------------
</span><span class="n">d</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">D</span><span class="m">8</span><span class="err">_</span><span class="m">1</span><span class="o">:</span><span class="n">D</span><span class="m">8</span><span class="err">_</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"variable"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"var_abb"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"Should there be .+\\? "</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Much less than now"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Somewhat less than now"</span><span class="p">),</span><span class="w">
         </span><span class="n">positive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Much more than now"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Somewhat more than now"</span><span class="p">),</span><span class="w">
         </span><span class="n">same</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">negative</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">positive</span><span class="p">,</span><span class="w">
         </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freq</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">negative</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w">
           </span><span class="n">positive</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Much less than now"</span><span class="p">,</span><span class="w"> 
                                          </span><span class="s2">"Somewhat less than now"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Much more than now"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Somewhat more than now"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"The same as now"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">))</span><span class="w">

</span><span class="n">pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="s2">"RdYlGn"</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">2</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)]</span><span class="w">

</span><span class="n">d</span><span class="m">2</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="m">2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">abs</span><span class="p">(</span><span class="n">prop</span><span class="p">))</span><span class="w">

</span><span class="n">d</span><span class="m">2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="m">2</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="m">2</span><span class="p">,</span><span class="n">positive</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal</span><span class="p">,</span><span class="w">
                    </span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
                    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">2</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)])</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"100%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">expand_limits</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.spacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"lines"</span><span class="p">))</span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Attitudes to public spend, by first preference Senate vote in 2016"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Should there be more or less public expenditure in the following area? ..."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: Australian Election Study 2016; analysis by freerangestats.info."</span><span class="p">)</span><span class="w">

</span><span class="c1">#----------change gone far enough----------
</span><span class="n">d</span><span class="m">3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">E</span><span class="m">2</span><span class="err">_</span><span class="m">1</span><span class="o">:</span><span class="n">E</span><span class="m">2</span><span class="err">_</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"variable"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"var_abb"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"Do you think .+\\? "</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Gone much too far"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Gone too far"</span><span class="p">),</span><span class="w">
         </span><span class="n">positive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Not gone nearly far enough"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Not gone far enough"</span><span class="p">),</span><span class="w">
         </span><span class="n">same</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">negative</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">positive</span><span class="p">,</span><span class="w">
         </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freq</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">negative</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w">
           </span><span class="n">positive</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Gone much too far"</span><span class="p">,</span><span class="w"> 
                                          </span><span class="s2">"Gone too far"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Not gone nearly far enough"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Not gone far enough"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"About right"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">))</span><span class="w">

</span><span class="n">pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="s2">"RdYlGn"</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">3</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)]</span><span class="w">

</span><span class="n">d</span><span class="m">3</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="m">3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">abs</span><span class="p">(</span><span class="n">prop</span><span class="p">))</span><span class="w">

</span><span class="n">d</span><span class="m">3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="m">3</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal</span><span class="p">,</span><span class="w">
                    </span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
                    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">3</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)])</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"100%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.spacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"lines"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">expand_limits</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Attitudes to change, by first preference Senate vote in 2016"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Do you think the following change that has been happening in Australia over the years has gone...?"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: Australian Election Study 2016; analysis by freerangestats.info."</span><span class="p">)</span><span class="w">

</span><span class="c1">#----------agree with various economic statements----------
</span><span class="n">d</span><span class="m">4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">D</span><span class="m">13</span><span class="err">_</span><span class="m">1</span><span class="o">:</span><span class="n">D</span><span class="m">13</span><span class="err">_</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"variable"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"var_abb"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"Do you strongly .+\\? "</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Disagree"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Strongly disagree"</span><span class="p">),</span><span class="w">
         </span><span class="n">positive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Agree"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Strongly agree"</span><span class="p">),</span><span class="w">
         </span><span class="n">same</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">negative</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">positive</span><span class="p">,</span><span class="w">
         </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freq</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">negative</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w">
           </span><span class="n">positive</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Strongly disagree"</span><span class="p">,</span><span class="w"> 
                                          </span><span class="s2">"Disagree"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Strongly agree"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Agree"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Neither agree nor disagree"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">))</span><span class="w">

</span><span class="n">pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="s2">"RdYlGn"</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">4</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)]</span><span class="w">

</span><span class="n">d</span><span class="m">4</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="m">4</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">abs</span><span class="p">(</span><span class="n">prop</span><span class="p">))</span><span class="w">

</span><span class="n">d</span><span class="m">4</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="m">4</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal</span><span class="p">,</span><span class="w">
                    </span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
                    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">4</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)])</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"100%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.spacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"lines"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">expand_limits</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Attitudes to left-right economic issues, by first preference Senate vote in 2016"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Do you strongly agree ... or strongly disagree with the following statement?"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: Australian Election Study 2016; analysis by freerangestats.info."</span><span class="p">)</span><span class="w">

</span><span class="c1">#----------agree with various social statements----------
</span><span class="n">d</span><span class="m">5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">E</span><span class="m">6</span><span class="err">_</span><span class="m">1</span><span class="o">:</span><span class="n">E</span><span class="m">6</span><span class="err">_</span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"variable"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"var_abb"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"Do you strongly .+\\? "</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Disagree"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Strongly disagree"</span><span class="p">),</span><span class="w">
         </span><span class="n">positive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Agree"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Strongly agree"</span><span class="p">),</span><span class="w">
         </span><span class="n">same</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">negative</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">positive</span><span class="p">,</span><span class="w">
         </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freq</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">negative</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w">
           </span><span class="n">positive</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"Strongly disagree"</span><span class="p">,</span><span class="w"> 
                                          </span><span class="s2">"Disagree"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Strongly agree"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Agree"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Neither agree nor disagree"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">))</span><span class="w">

</span><span class="n">pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="s2">"RdYlGn"</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">5</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)]</span><span class="w">

</span><span class="n">d</span><span class="m">5</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="m">5</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">abs</span><span class="p">(</span><span class="n">prop</span><span class="p">))</span><span class="w">

</span><span class="n">d</span><span class="m">5</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="m">5</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal</span><span class="p">,</span><span class="w">
                    </span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
                    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">5</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">3</span><span class="p">)])</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"100%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.spacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"lines"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">expand_limits</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Attitudes to liberal-conservative social issues, by first preference Senate vote in 2016"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Do you strongly agree ... or strongly disagree with the following statement?"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: Australian Election Study 2016; analysis by freerangestats.info."</span><span class="p">)</span><span class="w">

</span><span class="c1">#----------constitutional knowledge----------
</span><span class="n">d</span><span class="m">6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">aes2016</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="nb">F</span><span class="m">10</span><span class="err">_</span><span class="m">1</span><span class="o">:</span><span class="nb">F</span><span class="m">10</span><span class="err">_</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">wt_enrol</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">freq</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">wt_enrol</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">aes2016_questions</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"variable"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"var_abb"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"Do you think .+\\? "</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">question_label</span><span class="p">),</span><span class="w">
         </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str_wrap</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"False"</span><span class="p">),</span><span class="w">
         </span><span class="n">positive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"True"</span><span class="p">),</span><span class="w">
         </span><span class="n">same</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">negative</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">positive</span><span class="p">,</span><span class="w">
         </span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">freq</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">case_when</span><span class="p">(</span><span class="w">
           </span><span class="n">negative</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w">
           </span><span class="n">positive</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
           </span><span class="kc">TRUE</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">0.5</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">levels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"False"</span><span class="p">,</span><span class="w"> 
                                          </span><span class="s2">"True"</span><span class="p">,</span><span class="w">
                                          </span><span class="s2">"Don't know"</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">prop</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sum</span><span class="p">))</span><span class="w">

</span><span class="n">pal</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">brewer.pal</span><span class="p">(</span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="s2">"RdYlGn"</span><span class="p">)</span><span class="w">
</span><span class="nf">names</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">levels</span><span class="p">(</span><span class="n">d</span><span class="m">6</span><span class="o">$</span><span class="n">value</span><span class="p">)[</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">2</span><span class="p">)]</span><span class="w">

</span><span class="n">d</span><span class="m">6</span><span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="m">6</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">filter</span><span class="p">(</span><span class="n">negative</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="nf">abs</span><span class="p">(</span><span class="n">prop</span><span class="p">))</span><span class="w">

</span><span class="n">d</span><span class="m">6</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">item</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">weight</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">prop</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="m">6</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_bar</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">d</span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="n">positive</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">same</span><span class="p">),</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"stack"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">first_pref_sen_grp2</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">coord_flip</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_fill_manual</span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pal</span><span class="p">,</span><span class="w">
                    </span><span class="n">guide</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">guide_legend</span><span class="p">(</span><span class="n">reverse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
                    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">names</span><span class="p">(</span><span class="n">pal</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">-0.5</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"100%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="s2">"50%"</span><span class="p">,</span><span class="w"> </span><span class="s2">"100%"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">theme</span><span class="p">(</span><span class="n">panel.spacing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unit</span><span class="p">(</span><span class="m">1.5</span><span class="p">,</span><span class="w"> </span><span class="s2">"lines"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">expand_limits</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Knowledge of constitutional issues"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Do you think the following statement is true or false?
(correct answers in order from 'federation in 1901' to '75 members' are True, True, False, False, True, False)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: Australian Election Study 2016; analysis by freerangestats.info."</span><span class="p">)</span></code></pre></figure>

<h2 id="final-word">Final word</h2>

<p>OK, watch this space for more analysis using the AES (2016 and other years), if and when I get time.</p>

<p>Note - I have no affiliation or contact with the Australian Election Study, and the AES researchers bear no responsibility for my analysis or interpretation of their data. Use of the AES data by me is solely at my risk and I indemnify the Australian Data Archive and its host institution, The Australian National University. The Australian Data Archive and its host institution, The Australian National University, are not responsible for the accuracy and completeness of the material supplied. Similarly, if you use my analysis, it is at your risk. Don’t blame me for anything that goes wrong, even if I made a mistake. But it would be nice if you let me know.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">thankr</span><span class="o">::</span><span class="n">shoulders</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">maintainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str_squish</span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"&lt;.+&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">maintainer</span><span class="p">)),</span><span class="w">
         </span><span class="n">maintainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">maintainer</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"R-core"</span><span class="p">,</span><span class="w"> </span><span class="s2">"R Core Team"</span><span class="p">,</span><span class="w"> </span><span class="n">maintainer</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">maintainer</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">`Number packages`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">no_packages</span><span class="p">),</span><span class="w">
            </span><span class="n">packages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="n">packages</span><span class="p">,</span><span class="w"> </span><span class="n">collapse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">", "</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">`Number packages`</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">knitr</span><span class="o">::</span><span class="n">kable</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">clipr</span><span class="o">::</span><span class="n">write_clip</span><span class="p">()</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th style="text-align: left">maintainer</th>
      <th style="text-align: right">Number packages</th>
      <th style="text-align: left">packages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Hadley Wickham</td>
      <td style="text-align: right">17</td>
      <td style="text-align: left">assertthat, dplyr, ellipsis, forcats, ggplot2, gtable, haven, httr, lazyeval, modelr, plyr, rvest, scales, stringr, testthat, tidyr, tidyverse</td>
    </tr>
    <tr>
      <td style="text-align: left">R Core Team</td>
      <td style="text-align: right">13</td>
      <td style="text-align: left">base, compiler, datasets, graphics, grDevices, grid, methods, splines, stats, tools, utils, nlme, foreign</td>
    </tr>
    <tr>
      <td style="text-align: left">Gábor Csárdi</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">cli, crayon, pkgconfig, zip</td>
    </tr>
    <tr>
      <td style="text-align: left">Kirill Müller</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">DBI, hms, pillar, tibble</td>
    </tr>
    <tr>
      <td style="text-align: left">Lionel Henry</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">purrr, rlang, svglite, tidyselect</td>
    </tr>
    <tr>
      <td style="text-align: left">Winston Chang</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">extrafont, extrafontdb, R6, Rttf2pt1</td>
    </tr>
    <tr>
      <td style="text-align: left">Yihui Xie</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">evaluate, knitr, rmarkdown, xfun</td>
    </tr>
    <tr>
      <td style="text-align: left">Achim Zeileis</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">colorspace, lmtest, zoo</td>
    </tr>
    <tr>
      <td style="text-align: left">Jim Hester</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">glue, withr, readr</td>
    </tr>
    <tr>
      <td style="text-align: left">Yixuan Qiu</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">showtext, showtextdb, sysfonts</td>
    </tr>
    <tr>
      <td style="text-align: left">Dirk Eddelbuettel</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">digest, Rcpp</td>
    </tr>
    <tr>
      <td style="text-align: left">Jennifer Bryan</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">readxl, cellranger</td>
    </tr>
    <tr>
      <td style="text-align: left">Jeroen Ooms</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">curl, jsonlite</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Urbanek</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">Cairo, audio</td>
    </tr>
    <tr>
      <td style="text-align: left">“Thomas Lumley”</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">survey</td>
    </tr>
    <tr>
      <td style="text-align: left">Alex Hayes</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">broom</td>
    </tr>
    <tr>
      <td style="text-align: left">Alexander Walker</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">openxlsx</td>
    </tr>
    <tr>
      <td style="text-align: left">Brian Ripley</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">MASS</td>
    </tr>
    <tr>
      <td style="text-align: left">Brodie Gaslam</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">fansi</td>
    </tr>
    <tr>
      <td style="text-align: left">Charlotte Wickham</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">munsell</td>
    </tr>
    <tr>
      <td style="text-align: left">David Gohel</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">gdtools</td>
    </tr>
    <tr>
      <td style="text-align: left">David Meyer</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">vcd</td>
    </tr>
    <tr>
      <td style="text-align: left">Deepayan Sarkar</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">lattice</td>
    </tr>
    <tr>
      <td style="text-align: left">Erich Neuwirth</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">RColorBrewer</td>
    </tr>
    <tr>
      <td style="text-align: left">James Hester</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">xml2</td>
    </tr>
    <tr>
      <td style="text-align: left">Jeremy Stephens</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">yaml</td>
    </tr>
    <tr>
      <td style="text-align: left">Joe Cheng</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">htmltools</td>
    </tr>
    <tr>
      <td style="text-align: left">Justin Talbot</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">labeling</td>
    </tr>
    <tr>
      <td style="text-align: left">Kamil Slowikowski</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">ggrepel</td>
    </tr>
    <tr>
      <td style="text-align: left">Kevin Ushey</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">rstudioapi</td>
    </tr>
    <tr>
      <td style="text-align: left">Marek Gagolewski</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">stringi</td>
    </tr>
    <tr>
      <td style="text-align: left">Martin Maechler</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Matrix</td>
    </tr>
    <tr>
      <td style="text-align: left">Matt Dowle</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">data.table</td>
    </tr>
    <tr>
      <td style="text-align: left">Max Kuhn</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">generics</td>
    </tr>
    <tr>
      <td style="text-align: left">Michel Lang</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">backports</td>
    </tr>
    <tr>
      <td style="text-align: left">Patrick O. Perry</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">utf8</td>
    </tr>
    <tr>
      <td style="text-align: left">Peter Ellis</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">frs</td>
    </tr>
    <tr>
      <td style="text-align: left">Rasmus Bååth</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">beepr</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Garnier</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">viridisLite</td>
    </tr>
    <tr>
      <td style="text-align: left">Stefan Milton Bache</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">magrittr</td>
    </tr>
    <tr>
      <td style="text-align: left">Terry M Therneau</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">survival</td>
    </tr>
    <tr>
      <td style="text-align: left">Thomas J. Leeper</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">rio</td>
    </tr>
    <tr>
      <td style="text-align: left">Vitalie Spinu</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">lubridate</td>
    </tr>
  </tbody>
</table>


		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2019/04/20/yield-curve">Animating the US Treasury yield curve rates</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2019/05/15/polls-misc">House effects, herding, and the last few days before the election</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
			<p>My day job is Chief Data Scientist at <a href='https://www.nousgroup.com/'>Nous Group</a>, an international management consultancy with over 400 people working across Australia, the UK and Canada. <a href='mailto:peter.ellis@nousgroup.com.au'>Contact me</a> if you are interested working with us on a grand challenge or broad agenda.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics
http://Http://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>