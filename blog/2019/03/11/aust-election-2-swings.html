      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>Exploring swings in Australian federal elections</title>
      	
         
         
            <meta name ="description" content ="I explore the data on two-party-preferred voting swings in Australian federal elections and tentatively introduce the ozfedelect R package.">
            <meta property="og:description" content ="I explore the data on two-party-preferred voting swings in Australian federal elections and tentatively introduce the ozfedelect R package.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="Exploring swings in Australian federal elections" />
         
            <meta property="og:image" content="http://freerangestats.info/img/0146-2pp-swing-2016.png" />
         
		 
			<meta property="og:url" content="http://freerangestats.info/blog/2019/03/11/aust-election-2-swings.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
				  <li><a href = /blog/2019/11/09/sampling-from-urns>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">election forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href = "/elections/oz/index.html">Australia federal 2019</a></li>
				  <li><a href = "/elections/combined.html">NZ 2016</a></li>
                  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>Exploring swings in Australian federal elections</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>I explore the data on two-party-preferred voting swings in Australian federal elections and tentatively introduce the ozfedelect R package.</p>
	   <p class="meta">11 Mar 2019</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <h2 id="swings-are-far-from-uniform">Swings are far from uniform</h2>

<p>Last week I introduced a <a href="/blog/2019/03/02/aust-election-1">Bayesian state space model of two-party-preferred voting intention</a> for Australian federal elections. It treats the surveys from various polling firms as imperfect (potentially systematically imperfect) measurements of an unobserved latent variable of “true” voting intention, which manifests itself only every few years in the form of election results. The model estimates that latent value for every day that measurements exist, and going forward with increasing uncertainty past when there are measurements.</p>

<p>The most likely day for the next federal election seems to be 18 May 2019. In theory the House of Representatives election could be as late as November, but as half the Senate needs to go to the polls by end of May and most people prefer to have fewer elections not more the government is highly likely to opt for a simultaneous election of the House and Senate in May.</p>

<p>To turn my model into an actual election forecast I need a way of converting the distribution of probable two-party-preferred results on a given day into seats in the House of Representatives and hence probabilities for who will form a new government. In doing this we come up against the issue of the moderately high degree of spatial variation in voting behaviour in Australia (as elsewhere), in combination with the spatially-based conversion of vote into seats (ie regional divisions).</p>

<p>A key tool used in election analysis is to think in terms of the “swing” in vote in each division of the electorate, comparing vote in the last election to that in the next. This is just a practical application of a standard method in longitudinal statistical analysis. Analysis based on differential “swings” is basically the same idea as “difference in differences” analysis in econometrics and other social sciences.</p>

<p>It’s common as we come towards an election for pundits to project how a given swing would impact on seats if the swing were “uniform” ie the same across all divisions. But of course everyone knows swings are far from uniform. Here we can look at all the swings since the 1993 election (Australian Labor Party (ALP) victory - <a href="https://speakola.com/political/paul-keating-sweetest-victory-1993">Paul Keating’s “the sweetest victory of all” moment</a>) to 2016 (Liberal-National Coalition under Malcolm Turnbull hanging on to government by the skin of their teeth with help from the cross bench):</p>

<p><img src="/img/0146-incumbency.svg" width="100%" /></p>

<p>It’s interesting to see in this way how John Howard lost nearly all of his substantial 1996 gains in the 1998 election, the biggest average anti-government swing in this data to not result in a change of government. Then regained a lot in the 2001 election (those of us who lived through it will need <a href="https://en.wikipedia.org/wiki/2001_Australian_federal_election">little reminder</a> that this was the election of the September 11 attacks in the USA, and the ‘Children Overboard’ and Tampa incidents). Whether one thinks it good or bad, we can agree that if Beazley had snuck in in 1998 and Howard had been a one-term Prime Minister, Australian history would have gone down quite a different path.</p>

<p>This highlights one of the obvious issues with swings - big swings in one direction are predictive of a swing back to the centre. But the main aim of the chart above is to show how the individual divisions’ swings vary more than the average (of course).</p>

<p>After controlling for the average swing, the standard deviation of swings is still 3.2 percentage points. This adds a big chunk of uncertainty to how an average swing will translate into seats. A sitting member could reasonably expect their own swing (for or against) to be within plus or minus six percentage points of the overall swing, but in any given election we’d expect several division-level swings to be even more divergent than that.</p>

<p>Here’s the R code that produces that chart and that conclusion of 3.2 percentage points. It uses my new <code class="highlighter-rouge">ozfedelect</code> R package which is the workhorse I intend to use for re-usable functionality and data for Australian federal election analysis. So far it includes tidied polling data from 2007 to present (updated 11 March 2019), division-level two-party-preferred election results back to 1993, and “simple features” versions of electoral boundaries back to 2010 (simplified to 10% of their original size). Thanks to Wikipedia (and the polling firms of course), the Australian Electoral Commission, and the Australian Bureau of Statistics respectively for making the original data available.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Install the ozfedelect R package
</span><span class="n">devtools</span><span class="o">::</span><span class="n">install_github</span><span class="p">(</span><span class="s2">"ellisp/ozfedelect/pkg"</span><span class="p">)</span><span class="w">

</span><span class="n">library</span><span class="p">(</span><span class="n">ozfedelect</span><span class="p">)</span><span class="w"> </span><span class="c1"># with data
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">Cairo</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span><span class="w">

</span><span class="c1"># Some checks.
# -7.5 for Aston in 2013 meant a swing against the Labor govt
# - 10.1 for Bass in 2016 meant a swing against the Lib/Nat govt
</span><span class="n">results_2pp_div</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">division_nm</span><span class="p">,</span><span class="w"> </span><span class="n">swing_to_govt</span><span class="p">,</span><span class="w"> </span><span class="n">election_year</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">spread</span><span class="p">(</span><span class="n">election_year</span><span class="p">,</span><span class="w"> </span><span class="n">swing_to_govt</span><span class="p">)</span><span class="w">


</span><span class="c1">#---------------------------explore distribution of swings---------
</span><span class="w">
</span><span class="c1"># Let's try to understand those historical swings
</span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">results_2pp_div</span><span class="w">  </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">election_year</span><span class="p">,</span><span class="w"> </span><span class="n">incumbent</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">avg_swing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">swing_to_govt</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">total_votes</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">total_votes</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">swing_to_govt</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="m">20</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">as.ordered</span><span class="p">(</span><span class="n">election_year</span><span class="p">),</span><span class="w"> </span><span class="n">avg_swing</span><span class="p">))</span><span class="w">

</span><span class="c1"># We are interested for future forecasting models in the variance of division-level swings
# that are not explained by the nation-wide swing
</span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">swing_to_govt</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">avg_swing</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w">
</span><span class="n">confint</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">
</span><span class="n">coef</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="c1"># of course the slope is 1 and the intercept is 0, basically - by design
# the interesting thing is actually the residual standard error:
</span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="w">

</span><span class="c1"># what's the residual standard deviation of division-level swings?
</span><span class="n">residual_sd</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">summary</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="o">$</span><span class="n">sigma</span><span class="w">


</span><span class="n">avgs</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">distinct</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">avg_swing</span><span class="p">,</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">incumbent</span><span class="p">)</span><span class="w">

</span><span class="n">annotation_col</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"grey50"</span><span class="w">
</span><span class="n">update_geom_defaults</span><span class="p">(</span><span class="s2">"label"</span><span class="p">,</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">main_font</span><span class="p">,</span><span class="w"> </span><span class="n">fill</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"white"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">annotation_col</span><span class="p">,</span><span class="w"> </span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.8</span><span class="p">))</span><span class="w">

</span><span class="c1"># Main chart:
</span><span class="n">d</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_swing</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">swing_to_govt</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">se</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"lm"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">annotation_col</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_hline</span><span class="p">(</span><span class="n">yintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">annotation_col</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incumbent</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_text</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avgs</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.18</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">incumbent</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: Australian Electoral Commission data, analysed by freerangestats.info."</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="s2">"Overall swing towards incumbent government"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_format</span><span class="p">(</span><span class="n">accuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="s2">"Division level swings to government"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_format</span><span class="p">(</span><span class="n">accuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">annotate</span><span class="p">(</span><span class="s2">"label"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.053</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.06</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Strongly change\ngovernment"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">annotate</span><span class="p">(</span><span class="s2">"label"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.045</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-0.065</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Narrow escape for\nHoward in 1998"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">annotate</span><span class="p">(</span><span class="s2">"label"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.0055</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.04</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Strongly retain\ngovernment"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_colour_manual</span><span class="p">(</span><span class="s2">"Incumbent government:"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">values</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"ALP"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#e53440"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Lib/Nat"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#1c4f9c"</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Individual seats face more voting uncertainty than Australia as a whole"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Each point represents the swing in a single seat; residual standard deviation of about 3.2 percentage points around the nation-wide swing."</span><span class="p">)</span></code></pre></figure>

<h2 id="swings-vary-spatially-as-well-as-over-time">Swings vary spatially as well as over time</h2>

<p>Election analysts love our choropleth maps, but they pose a challenge because of the uneven distribution of people over land. This is a particularly acute problem for Australia.</p>

<p>In trying to draw a meaningful electorate choropleth map for Australia I first tried a cartogram (to distort borders so each electorate is represented as visually equal while retaining some of its basic shape) but this was too big a job for the algorithm in the <code class="highlighter-rouge">cartogram</code> R package. Fair enough. Some of those divisions are pretty large, including Durack in northern Western Australia, at 1.6 million square kilometres for its 100,000 electors the <a href="https://en.wikipedia.org/wiki/Division_of_Durack">second largest (by area) single-seat electoral division in the world</a>.</p>

<p>So instead of a cartogram, I’ve opted instead for a bunch of call-outs of the five largest cities. Here we can see the two-party-preferred <em>votes</em> in the 2016 election:</p>

<p><a href="/img/0146-2pp-votes-2016.svg" target="_blank"><img src="/img/0146-2pp-votes-2016.png" width="100%" /></a></p>

<p><em>Clicking on the image will open a scalable vector graphics version in a new tab.</em></p>

<p>This call-out method seems effective in counteracting the big sea of blue that one gets from looking at the simple map of Australia, with Liberal-National Coalition support dominant in rural areas outside the Northern Territory.</p>

<p><em>Note for those more used to American politics. In Australia, the centre-left party (ALP) has red as its colour, and the right use blue, unlike in the USA where <a href="https://www.washingtonpost.com/news/the-fix/wp/2016/11/08/red-vs-blue-a-brief-history-of-how-we-use-political-colors/?utm_term=.4cf331d7f14d">since the 1990s</a> the colours have opposite connotations, to the <a href="https://www.quora.com/Why-are-Democrats-blue-and-Republicans-red-if-its-the-other-way-around-in-most-other-countries">puzzlement of the rest of the world</a>. Unlike in many other countries the Democrats in the USA did not grow out of a nineteenth and twentieth century socialist movement and hence never self-identified with the colour red, and when TV stations got to allocate colours they seemingly did it arbitrarily. Also, while we’re talking about such things, the Liberal Party in Australia is a party of the right or centre-right, and historically referred to economic, individual/family liberalism in contrast to the collective action advocated by the labor movement and their party. End of digression.</em></p>

<p>So, here’s how this mapping approach looks with today’s issue of interest, division-level variation in swings.</p>

<p>In 2010, we see the ALP under Julia Gillard taking a thumping and retaining government only as a minority in the House, with support from three independents and an Australian Green. Counter-swings to the ALP in the Melbourne and Adelaide areas (the two call-outs at the bottom of the map) saved the ALP from an outright loss:</p>

<p><a href="/img/0146-2pp-swing-2010.svg" target="_blank"><img src="/img/0146-2pp-swing-2010.png" width="100%" /></a></p>

<p>Then we see ALP under Kevin Rudd comprehensively losing their remaining wafer-thin hold of government nearly across the board in 2013. The average swing here was less than that against Howard in 1998, but the government had no buffer at all so the result was a clear win for the Liberal-National Coalition under Tony Abbott:</p>

<p><a href="/img/0146-2pp-swing-2013.svg" target="_blank"><img src="/img/0146-2pp-swing-2013.png" width="100%" /></a></p>

<p>Then in 2016 we saw most areas swing back, with Malcolm Turnbull’s narrow retain on government already mentioned:</p>

<p><a href="/img/0146-2pp-swing-2016.svg" target="_blank"><img src="/img/0146-2pp-swing-2016.png" width="100%" /></a></p>

<p>The <code class="highlighter-rouge">ozfedelect</code> package includes a function that does all the grunt work of these maps, so the end-user code that produces them is extremely simple:</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ozpol_infographic</span><span class="p">(</span><span class="m">2016</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"swing_to_govt"</span><span class="p">)</span><span class="w">
</span><span class="n">ozpol_infographic</span><span class="p">(</span><span class="m">2013</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"swing_to_govt"</span><span class="p">)</span><span class="w">
</span><span class="n">ozpol_infographic</span><span class="p">(</span><span class="m">2010</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"swing_to_govt"</span><span class="p">)</span><span class="w">

</span><span class="n">ozpol_infographic</span><span class="p">(</span><span class="m">2016</span><span class="p">)</span><span class="w">
</span><span class="n">ozpol_infographic</span><span class="p">(</span><span class="m">2013</span><span class="p">)</span><span class="w">
</span><span class="n">ozpol_infographic</span><span class="p">(</span><span class="m">2010</span><span class="p">)</span></code></pre></figure>

<h2 id="swing-and-vote-each-have-a-relationship-with-division-level-census-variables">Swing and vote each have a relationship with division-level census variables</h2>

<p>A common thing to do with either swing or vote variables is to compare them to division-level indicators of social, economic and demographic variables, typically available from the Census. Hugh Parsonage’s invaluable <code class="highlighter-rouge">Census2016.DataPack</code> contains tidied versions of the ABS’ Census Data Packs, and I’ve further summarised a small subset of the variables available into a one-row-per-division collation in <code class="highlighter-rouge">ozfedelect</code>.  Here’s what we see when we compare those variables to the most recent swing in 2016:</p>

<p><img src="/img/0146-census-swing.svg" width="100%" /></p>

<p>The clearest thing to see here is that divisions with a high proportion of young persons (aged 19 and under) tended to swing away from the Liberal-National Coalition. If we put these variables, and the state territory (as a factor) into a simple model, we can see that there is a distinct state-based flavour to the swings, that divisions with a high number of people born in Australia tended to swing towards the government, and that those with many young people (which might be a proxy for either or both of students or young families) swung against it.</p>

<p><img src="/img/0146-mod-results.svg" width="100%" /></p>

<p>Don’t take these results too seriously; to understand the trends properly here we really need individual data from the <a href="https://australianelectionstudy.org/voter_studies.html">Australian Election Study</a> which we could put in a multi-level model like <a href="https://www.sciencedirect.com/science/article/pii/S0261379497000309?via%3Dihub">this one by David Charnock</a> way back in the 1990s.</p>

<p>In addition to addressing the individual/regional problem or ecological fallacy, ideally, I would be comparing “swing” (which is effectively the first-difference in the “vote” time series) not against absolute levels of such variables but changes in them - so we were looking at the first-difference for both variables, and could see if a change in number of young people was leading to a change in vote. But this would need more data tidying than I’ve done yet.</p>

<p>For the record, here is how these same seven variables compare to the more natural comparator, the simple two-party-preferred vote:</p>

<p><img src="/img/0146-census-vote.svg" width="100%" /></p>

<p>As might be expected from a casual observation of Australian politics where the class origins of the main parties remain stubbornly persistent, areas with these characteristics are more likely to vote for Liberal-National Coalition:</p>

<ul>
  <li>Higher proportion of adults have year 10 or more education</li>
  <li>Higher proportion of people were born in Australia</li>
  <li>Higher proportion of people speak only English at home</li>
  <li>Higher average personal income</li>
</ul>

<p>Again, don’t mistake these area-based findings for individual-level conclusions. That may come later if I have time (this is just a hobby project after all; but I note the AES data is freely downloadable and will be hard to keep my hands off!).</p>

<p>Code for all these comparisons to Census data. Again, the hard yards have been done by Parsonage’s <code class="highlighter-rouge">Census2016.DataPack</code> and my <code class="highlighter-rouge">ozfedelect</code>.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#----------------------- explore relationship to census variables------------
# a tiny bit of munging data together, into wide form for modelling:
</span><span class="n">d</span><span class="m">1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">results_2pp_div</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">election_year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2016</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">div_census_2016</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"division_nm"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">division_nm</span><span class="p">,</span><span class="w"> </span><span class="n">state_ab</span><span class="p">,</span><span class="w"> </span><span class="n">lib_nat_percentage</span><span class="p">,</span><span class="w"> </span><span class="n">swing_to_govt</span><span class="p">,</span><span class="w"> </span><span class="n">young_persons</span><span class="o">:</span><span class="n">only_english_spoken_home</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">state_ab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_relevel</span><span class="p">(</span><span class="n">state_ab</span><span class="p">,</span><span class="w"> </span><span class="s2">"NSW"</span><span class="p">))</span><span class="w">

</span><span class="c1"># and narrow form for plotting:  
</span><span class="n">d</span><span class="m">2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="m">1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">division_nm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">lib_nat_percentage</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">swing_to_govt</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">state_ab</span><span class="p">)</span><span class="w">

</span><span class="c1">#------------charts--------------  
# chart of vote:
</span><span class="n">d</span><span class="m">2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lib_nat_percentage</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"free_x"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="s2">"Two-party-preferred vote for Liberal/National Coalition"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gam"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state_ab</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Vote compared to census variables by electoral division"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"2016 federal election"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">

</span><span class="c1"># chart of swing:  
</span><span class="n">d</span><span class="m">2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">swing_to_govt</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"free_x"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="s2">"Two-party-preferred swing towards Liberal/National Coalition\n(incumbent government)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gam"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">state_ab</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Swing compared to census variables by electoral division"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"2016 federal election"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">)</span><span class="w">

  
</span><span class="c1">#----------Modelling  -----------
</span><span class="n">d</span><span class="m">3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">d</span><span class="m">1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="w"> </span><span class="o">-</span><span class="n">division_nm</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lib_nat_percentage</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate_at</span><span class="p">(</span><span class="n">vars</span><span class="p">(</span><span class="n">young_persons</span><span class="o">:</span><span class="n">only_english_spoken_home</span><span class="p">),</span><span class="w"> </span><span class="n">scale</span><span class="p">)</span><span class="w">

</span><span class="n">mod1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">I</span><span class="p">(</span><span class="n">swing_to_govt</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">100</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">.</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="m">3</span><span class="p">)</span><span class="w">

</span><span class="c1"># chart of results:
</span><span class="n">confint</span><span class="p">(</span><span class="n">mod1</span><span class="p">)[</span><span class="m">-1</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">as.data.frame</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rownames</span><span class="p">(</span><span class="n">.</span><span class="p">),</span><span class="w">
         </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"state_ab"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">),</span><span class="w">
         </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"_"</span><span class="p">,</span><span class="w"> </span><span class="s2">" "</span><span class="p">,</span><span class="w"> </span><span class="n">var</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rename</span><span class="p">(</span><span class="n">lower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">`2.5 %`</span><span class="p">,</span><span class="w">
         </span><span class="n">upper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">`97.5 %`</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">mid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lower</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">upper</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w">
         </span><span class="n">var</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">mid</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lower</span><span class="p">,</span><span class="w"> </span><span class="n">xend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">upper</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var</span><span class="p">,</span><span class="w"> </span><span class="n">yend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">var</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"steelblue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_segment</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="s2">"Impact of change in one standard deviation in census variable on swing"</span><span class="p">,</span><span class="w">
                     </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> 
       </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Source: ABS Census data, AES election results, analysis by http://freerangestats.info"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Division-level variables related to a swing to the Liberal-National Coalition"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Comparing the 2016 results to 2013 by electoral division (or 'seat').
          Conclusions about individual characteristics relating to vote should be drawn only with great caution."</span><span class="p">)</span></code></pre></figure>

<h2 id="and-the-answer-is">And the answer is…</h2>

<p>Finally, enough exploring, and on to the answer. What’s the probability of an ALP government after the election, if it is in late May? The latest version of the model, with one more poll than my last blog post, and now extending only to late May not to November, looks like this:</p>

<p><img src="/img/0146-latest-model-results.svg" width="100%" /></p>

<p>The mean predicted two-party preferred vote for ALP at end of May is 52.48 percent and the standard deviation is 2.08 percentage points. We can combine the expected distribution of votes at the time, with the historical distribution of individual divisions’ swings on top of that, to get an estimate of the chance of a change of government.</p>

<p>So here’s my current best effort at converting modelled two-party-preferred vote into seats:</p>

<p><img src="/img/0146-histogram.svg" width="100%" /></p>

<p>This gives the ALP a healthy 83% chance of winning; better than my stab in the dark a week ago on social media of 71%, when I had been thinking in terms of a November election which I now realise is unlikely.</p>

<p>Beware that this is a <em>very</em> simple model of seat allocation, and one I’m a bit untrusting of. For example, it doesn’t consider redistributions in electoral boundaries since 2016 at all. And I haven’t taken into account at all the <em>six</em> current independents or members of minor parties, which surely has an impact; never mind other seats where high profile independents might have a chance of knocking out a major party member that would not happen under straight two-party-preferred dominance.</p>

<p>So treat this carefully for now, this is just a first step towards a proper model. Over the next few weeks I hope to robustify it and productionise into something that can easily update itself as we move towards election day.</p>

<p>Final snippet of R code that did this simulation, based on a swing from the 2016 division results.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#==============crude simulation===============
# so plausible to 
# a) model the overall swing to the govt
# b) simulate for individual seats a randomness of N(0, 3.2) on top of that overall swing
# c) add those swings to the 2016 results
</span><span class="w">
</span><span class="c1"># Important - this misses out on two things that are needed:
# a) 2 new electorates this time around
# b) seats held by other parties
</span><span class="w">
</span><span class="n">last_result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">results_2pp_div</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">election_year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2016</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">alp_2pp_2016</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">alp_votes</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">total_votes</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">pull</span><span class="p">(</span><span class="n">alp_2pp_2016</span><span class="p">)</span><span class="w">

</span><span class="c1"># last election the ALP got 49.6% of the 2pp. Currently on track to about 52.48 with sd of about 2.08.
# So an average swing against the govt of N(2.88, 2.08), and division-level randomness on top of that.
</span><span class="w">
</span><span class="n">baseline</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">results_2pp_div</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">election_year</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2016</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">division_nm</span><span class="p">,</span><span class="w"> </span><span class="n">alp_percentage</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="n">nsims</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1e5</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">321</span><span class="p">)</span><span class="w">
</span><span class="n">sims</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">tibble</span><span class="p">(</span><span class="n">sim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nsims</span><span class="p">,</span><span class="w"> </span><span class="n">link</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">avg_swing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">(),</span><span class="w"> </span><span class="m">-2.88</span><span class="p">,</span><span class="w"> </span><span class="m">2.08</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">full_join</span><span class="p">(</span><span class="n">baseline</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"link"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">link</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">extra_swing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">(),</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">residual_sd</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># we scale the extra_swing to be mean zero so we aren't accidentally changing the average swing:
</span><span class="w">  </span><span class="n">mutate</span><span class="p">(</span><span class="n">extra_swing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">extra_swing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">extra_swing</span><span class="p">),</span><span class="w">
         </span><span class="n">total_swing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">avg_swing</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">extra_swing</span><span class="p">,</span><span class="w">
         </span><span class="n">alp_percentage_2019</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">alp_percentage</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">total_swing</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w">


</span><span class="n">sims_by_div</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sims</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">avg_swing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">avg_swing</span><span class="p">),</span><span class="w">
            </span><span class="n">number_seats_alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="n">alp_percentage_2019</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">50</span><span class="p">),</span><span class="w">
            </span><span class="n">prop_seats_alp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">alp_percentage_2019</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">50</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w">

</span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sims_by_div</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">mean</span><span class="p">(</span><span class="n">prop_seats_alp</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">100</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">pull</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w">

</span><span class="c1"># draw histogram of results  
</span><span class="n">sims_by_div</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">number_seats_alp</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_histogram</span><span class="p">(</span><span class="n">alpha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">binwidth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"grey"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_vline</span><span class="p">(</span><span class="n">xintercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">75.5</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"steelblue"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="s2">"Number of House of Representative seats won by ALP"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="s2">"Number of simulations\n(out of 100,000)"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">comma</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="n">paste0</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="s2">"% probability of ALP win in the 2019 Federal Election"</span><span class="p">))</span></code></pre></figure>

<p>That’s all for now. Comments are very welcome, including spotting any mistakes; I’ve been working through this at some pace and there’s no doubt the checking and testing is inadequate so I would be surprised if something isn’t wrong somewhere, so I’ll be pleased, not upset, if someone tells me what!</p>

<p>As usual, here are the contributors to R that made all this possible:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">thankr</span><span class="o">::</span><span class="n">shoulders</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">maintainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str_squish</span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"&lt;.+&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">maintainer</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">knitr</span><span class="o">::</span><span class="n">kable</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">clipr</span><span class="o">::</span><span class="n">write_clip</span><span class="p">()</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th style="text-align: left">maintainer</th>
      <th style="text-align: right">no_packages</th>
      <th style="text-align: left">packages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Hadley Wickham</td>
      <td style="text-align: right">18</td>
      <td style="text-align: left">assertthat, dplyr, ellipsis, forcats, ggplot2, gtable, haven, httr, lazyeval, modelr, plyr, rvest, scales, stringr, testthat, tidyr, tidyverse, usethis</td>
    </tr>
    <tr>
      <td style="text-align: left">R Core Team</td>
      <td style="text-align: right">11</td>
      <td style="text-align: left">base, compiler, datasets, graphics, grDevices, grid, methods, splines, stats, tools, utils</td>
    </tr>
    <tr>
      <td style="text-align: left">Gábor Csárdi</td>
      <td style="text-align: right">9</td>
      <td style="text-align: left">callr, cli, crayon, desc, pkgconfig, processx, ps, remotes, sessioninfo</td>
    </tr>
    <tr>
      <td style="text-align: left">Kirill Müller</td>
      <td style="text-align: right">5</td>
      <td style="text-align: left">DBI, hms, pillar, rprojroot, tibble</td>
    </tr>
    <tr>
      <td style="text-align: left">Jim Hester</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">devtools, pkgbuild, pkgload, readr</td>
    </tr>
    <tr>
      <td style="text-align: left">Winston Chang</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">extrafont, extrafontdb, R6, Rttf2pt1</td>
    </tr>
    <tr>
      <td style="text-align: left">Jim Hester</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">fs, glue, withr</td>
    </tr>
    <tr>
      <td style="text-align: left">Lionel Henry</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">purrr, rlang, tidyselect</td>
    </tr>
    <tr>
      <td style="text-align: left">Yixuan Qiu</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">showtext, showtextdb, sysfonts</td>
    </tr>
    <tr>
      <td style="text-align: left">Yihui Xie</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">highr, knitr, xfun</td>
    </tr>
    <tr>
      <td style="text-align: left">Edzer Pebesma</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">sf, units</td>
    </tr>
    <tr>
      <td style="text-align: left">Jeroen Ooms</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">curl, jsonlite</td>
    </tr>
    <tr>
      <td style="text-align: left">Dirk Eddelbuettel</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">digest, Rcpp</td>
    </tr>
    <tr>
      <td style="text-align: left">R-core</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">nlme</td>
    </tr>
    <tr>
      <td style="text-align: left">Vitalie Spinu</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">lubridate</td>
    </tr>
    <tr>
      <td style="text-align: left">Michel Lang</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">backports</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Wood</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">mgcv</td>
    </tr>
    <tr>
      <td style="text-align: left">Achim Zeileis</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">colorspace</td>
    </tr>
    <tr>
      <td style="text-align: left">Gabor Csardi</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">prettyunits</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Urbanek</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Cairo</td>
    </tr>
    <tr>
      <td style="text-align: left">James Hester</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">xml2</td>
    </tr>
    <tr>
      <td style="text-align: left">Justin Talbot</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">labeling</td>
    </tr>
    <tr>
      <td style="text-align: left">Roger Bivand</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">classInt</td>
    </tr>
    <tr>
      <td style="text-align: left">Jennifer Bryan</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">readxl</td>
    </tr>
    <tr>
      <td style="text-align: left">Kevin Ushey</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">rstudioapi</td>
    </tr>
    <tr>
      <td style="text-align: left">Max Kuhn</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">generics</td>
    </tr>
    <tr>
      <td style="text-align: left">Stefan Milton Bache</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">magrittr</td>
    </tr>
    <tr>
      <td style="text-align: left">Martin Maechler</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Matrix</td>
    </tr>
    <tr>
      <td style="text-align: left">Charlotte Wickham</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">munsell</td>
    </tr>
    <tr>
      <td style="text-align: left">Matthew Lincoln</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">clipr</td>
    </tr>
    <tr>
      <td style="text-align: left">Marek Gagolewski</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">stringi</td>
    </tr>
    <tr>
      <td style="text-align: left">Jeremy Stephens</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">yaml</td>
    </tr>
    <tr>
      <td style="text-align: left">Deepayan Sarkar</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">lattice</td>
    </tr>
    <tr>
      <td style="text-align: left">Claus O. Wilke</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">cowplot</td>
    </tr>
    <tr>
      <td style="text-align: left">Rasmus Bååth</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">beepr</td>
    </tr>
    <tr>
      <td style="text-align: left">Jennifer Bryan</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">cellranger</td>
    </tr>
    <tr>
      <td style="text-align: left">Hugh Parsonage</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Census2016.DataPack</td>
    </tr>
    <tr>
      <td style="text-align: left">Alex Hayes</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">broom</td>
    </tr>
    <tr>
      <td style="text-align: left">Peter Ellis</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">ozfedelect</td>
    </tr>
    <tr>
      <td style="text-align: left">David Meyer</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">e1071</td>
    </tr>
    <tr>
      <td style="text-align: left">Brian Ripley</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">class</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Urbanek</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">audio</td>
    </tr>
    <tr>
      <td style="text-align: left">Jim Hester</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">memoise</td>
    </tr>
  </tbody>
</table>


		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2019/03/02/aust-election-1">Bayesian state space modelling of the Australian 2019 election</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2019/03/23/afl-elo">AFL teams Elo ratings and footy-tipping</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="http://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="http://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics
http://Http://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="http://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>