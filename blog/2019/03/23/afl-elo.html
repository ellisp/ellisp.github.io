      <!DOCTYPE html>
	<html lang="en">
		<head>
      <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
			<title>AFL teams Elo ratings and footy-tipping</title>
      	
         
         
            <meta name ="description" content ="I use Elo ratings from 12 months or from 120 years of AFL results to predict the results in the next round. Predictions based on just the past 12 months do better than those using the full history.">
            <meta property="og:description" content ="I use Elo ratings from 12 months or from 120 years of AFL results to predict the results in the next round. Predictions based on just the past 12 months do better than those using the full history.">
         
         <meta property="og:site_name" content="free range statistics" />
         <meta property="og:title" content="AFL teams Elo ratings and footy-tipping" />
         
            <meta property="og:image" content="https:/freerangestats.info/img/0147-success-rates.png" />
         
		 
			<meta property="og:url" content="https://freerangestats.info/blog/2019/03/23/afl-elo.html" />
		 
         <meta property="og:author" content= "https://www.facebook.com/peterstats" />
         <meta property="og:type" content="article" />
      

<link href='https://fonts.googleapis.com/css?family=Sarala' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Prosto+One' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Roboto' rel='stylesheet'>
<link href='https://fonts.googleapis.com/css?family=Ubuntu+Mono' rel='stylesheet'>
	  
          <link href="/css/bootstrap.min.css" rel ="stylesheet" type="text/css">
          <link href="/css/bootstrap-theme.min.css" rel ="stylesheet" type="text/css">
            <link href="/css/custom.css" rel ="stylesheet" type="text/css">     
		<link href="/css/syntax.css" rel ="stylesheet" type="text/css">     			
                 
            
   <script>
     (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
     (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
     m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
     })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

     ga('create', 'UA-65886313-1', 'auto');
     ga('send', 'pageview');

   </script>
   
   <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



   <style>
    ul li { margin-bottom: 9px; }
    ol li { margin-bottom: 9px; }
   </style>
   
   <link rel="alternate" type="application/rss+xml" title="free range statistics by Peter Ellis"
      href="/feed.xml">

	  

      
		</head>
      
  <body role = "document">
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        
		<div id="fb-root"></div>
		<script>(function(d, s, id) {
		  var js, fjs = d.getElementsByTagName(s)[0];
		  if (d.getElementById(id)) return;
		  js = d.createElement(s); js.id = id;
		  js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.6";
		  fjs.parentNode.insertBefore(js, fjs);
		}(document, 'script', 'facebook-jssdk'));</script>
  
  <script>
  (function() {
    var cx = '015640467633673901770:pk3v2c95baw';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>

  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">free range statistics</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/about">about</a></li>
            <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">all posts <span class="caret"></span></a>
                <ul class="dropdown-menu">
                  <li><a href="/blog">ordered by date</a></li>
				  <li><a href="/blog/most-popular.html">ordered by popularity</a></li>
                  <li><a href="/blog/index_by_tag.html">grouped by subject matter</a></li>
                  <li><a href="/blog/nz.html">all posts with data about new zealand</a></li>
				  <li><a href="/blog/voting.html">all posts on voting behaviour</a></li>
                  <li><a href="/blog/surveys.html">all posts on surveys</a></li> 
				  <li><a href = /blog/2025/06/14/more-on-fragile-p-values>most recent post</a></li>
				</ul>
            </li>
              <li><a href="/blog/showcase.html">showcase</a></li>
              <li><a href="/presentations/index.html">presentations</a></li>
			  <li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">forecasts<span class="caret"></span></a>
                <ul class="dropdown-menu">
				  <li><a href = "/covid-tracking/index.html">Covid-19 in Australia</a></li>
                  <li><a href = "/elections/nz-2020/index.html">NZ election 2020</a></li>
                  <li><a href = "/elections/oz-2019/index.html">Australia federal election 2019</a></li>
				  <li><a href = "/elections/nz-2017/combined.html">NZ election 2017</a></li>
                  <li><a href="/blog/voting.html">all blog posts on voting behaviour</a></li>
                </ul>				
			  </li>
			  
			  
			  
		    </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
  
  
      
			<div class="container">
			
			<div class="jumbotron">
  <div class="container">
	<center><h1>AFL teams Elo ratings and footy-tipping</h1></center>
  </div>
</div>



	<div class = "post-summary">
	<h2>At a glance:</h2>
	   <p>I use Elo ratings from 12 months or from 120 years of AFL results to predict the results in the next round. Predictions based on just the past 12 months do better than those using the full history.</p>
	   <p class="meta">23 Mar 2019</p>
	   <hr></hr>
	</div>


<div class="col-md-7">

	<div class="post">
		
	  <p>So now that I live in Melbourne, to blend in with the locals I need to at least vaguely follow the AFL (Australian Football League). For instance, my work like many others has an AFL footy-tipping competition. I was initially going to choose my tips based on wisdom of the crowds (ie choose the favourite) but decided that this was a good occasion to try something a bit more scientific.</p>

<p>As is the case for most organised sports these days, there is rich data available on AFL results and other metrics. After wasting 20 minutes trying to locate and scrape various websites I remembered “someone must have already done this”, and sure enough found Jimmy Day’s highly effective <a href="https://github.com/jimmyday12/fitzRoy"><code class="language-plaintext highlighter-rouge">fitzRoy</code> R package</a>.</p>

<h2 id="elo-ratings-over-the-long-term">Elo ratings over the long term</h2>

<p>An easy way to generate predictions of the likely winner in a head to head game is by comparing Elo ratings based on past performance. I’ve written a bit about Elo ratings in the <a href="https:/freerangestats.info/blog/2015/08/07/fibs-elo-ratings-basics">context of backgammon</a>, and my <code class="language-plaintext highlighter-rouge">frs</code> R package has a couple of functions to make it easy to help generate and analyse them (for example, turning two ratings into a probability of winning).</p>

<p>Here’s the Elo ratings of present and past AFL (and its predecessor, the Victorian Football League) teams, treating them continuously from 1897 to the present:</p>

<p><img src="/img/0147-long-history.svg" width="100%" /></p>

<p>Amongst other things, this provides at least <em>an</em> answer to the vexed question of which AFL team is the best overall - apparently Geelong (prepares to duck). Interesting to see that sustained period of Collinwood dominance in the 1930s too. Also suprising (to me, showing how little attention I’ve paid) is Sydney sitting on the second highest Elo rating today based on the full history of the game. When I last paid attention to the footy in the late 1990s, the Sydney Swans were literally the punchline of an evening comedy show on TV, which adopted them out of the pure humour of supporting such a perpetually losing team. Obviously they’ve recovered, no doubt in part due to the support of their fans through the tough patch.</p>

<p>I can’t remember the name of the TV show.</p>

<p>Anyway, before we get on to thinking about predictions, here’s the R code to bring in those results and draw the chart of Elo ratings.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># devtools::install_github("jimmyday12/fitzRoy")</span><span class="w">
</span><span class="c1"># devtools::install_github("ellisp/frs-r-package/pkg")</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">fitzRoy</span><span class="p">)</span><span class="w">   </span><span class="c1"># for reading AFL scores</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">frs</span><span class="p">)</span><span class="w">       </span><span class="c1"># for Elo functions</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">Cairo</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ggrepel</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">lubridate</span><span class="p">)</span><span class="w">

</span><span class="c1"># some parameters for graphics:</span><span class="w">
</span><span class="n">update_geom_defaults</span><span class="p">(</span><span class="s2">"text_repel"</span><span class="p">,</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"brown"</span><span class="p">))</span><span class="w">
</span><span class="n">the_caption</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"Source: afltables via fitZroy; analysis by freerangestats.info"</span><span class="w">

</span><span class="c1"># download AFL results:</span><span class="w">
</span><span class="n">results</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">get_match_results</span><span class="p">()</span><span class="w">

</span><span class="c1"># set up a data frame in the right shape to sort through the games one at a time</span><span class="w">
</span><span class="n">r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">results</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rename_all</span><span class="p">(</span><span class="n">tolower</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rename_all</span><span class="p">(</span><span class="k">function</span><span class="p">(</span><span class="n">x</span><span class="p">){</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"\\."</span><span class="p">,</span><span class="w"> </span><span class="s2">"_"</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">)})</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># limit to 2018 season and earlier:</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">date</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="s2">"2019-01-01"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">home_team</span><span class="p">,</span><span class="w"> </span><span class="n">away_team</span><span class="p">,</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">game</span><span class="p">,</span><span class="w"> </span><span class="n">margin</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">location</span><span class="p">,</span><span class="w"> </span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">game</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">margin</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gsub</span><span class="p">(</span><span class="s2">"_team"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="p">),</span><span class="w">
         </span><span class="n">margin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ifelse</span><span class="p">(</span><span class="n">location</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">"home"</span><span class="p">,</span><span class="w"> </span><span class="n">margin</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">margin</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">winner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">margin</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">starting_elo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1500</span><span class="p">,</span><span class="w">
         </span><span class="n">new_elo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1500</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">game</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="c1"># sequence so the winner is the first listed each time for each game:</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">game</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">winner</span><span class="p">))</span><span class="w">

</span><span class="cd">#' Calculate Elo ratings for a data frame of AFL results</span><span class="w">
</span><span class="cd">#' </span><span class="w">
</span><span class="cd">#' @param r a data frame with columns including date, team, game, starting_elo, new_elo</span><span class="w">
</span><span class="n">afl_elos</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="k">function</span><span class="p">(</span><span class="n">r</span><span class="p">){</span><span class="w">
  </span><span class="n">r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">group_by</span><span class="p">(</span><span class="n">game</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">arrange</span><span class="p">(</span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">game</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">winner</span><span class="p">))</span><span class="w">
  
  </span><span class="n">all_games</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">r</span><span class="o">$</span><span class="n">game</span><span class="p">)</span><span class="w">
  
  </span><span class="c1"># This loop will give some tidyverse advocates conniptions but it works for me; and</span><span class="w">
  </span><span class="c1"># it seems inherently iterative so perhaps a loop is the logical way to do it:</span><span class="w">
  </span><span class="k">for</span><span class="p">(</span><span class="n">g</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">all_games</span><span class="p">){</span><span class="w">
    </span><span class="n">this_game</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="p">[</span><span class="n">r</span><span class="o">$</span><span class="n">game</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="p">]</span><span class="w"> 
    </span><span class="n">er</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">elo_rating</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this_game</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"starting_elo"</span><span class="p">],</span><span class="w"> 
                     </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">this_game</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="s2">"starting_elo"</span><span class="p">],</span><span class="w">
                     </span><span class="n">winner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w">
                     </span><span class="n">ml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">this_game</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="s2">"margin"</span><span class="p">]</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">6</span><span class="p">))</span><span class="w">
    
    </span><span class="n">r</span><span class="p">[</span><span class="n">r</span><span class="o">$</span><span class="n">game</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">g</span><span class="p">,</span><span class="w"> </span><span class="s2">"new_elo"</span><span class="p">]</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unlist</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">er</span><span class="o">$</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">er</span><span class="o">$</span><span class="n">b</span><span class="p">))</span><span class="w">
    </span><span class="n">r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">group_by</span><span class="p">(</span><span class="n">team</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">mutate</span><span class="p">(</span><span class="n">starting_elo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lag</span><span class="p">(</span><span class="n">new_elo</span><span class="p">,</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1500</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
      </span><span class="n">ungroup</span><span class="p">()</span><span class="w">
  </span><span class="p">}</span><span class="w">
  </span><span class="n">r</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">mutate</span><span class="p">(</span><span class="n">season</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lubridate</span><span class="o">::</span><span class="n">year</span><span class="p">(</span><span class="n">date</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">group_by</span><span class="p">(</span><span class="n">game</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">arrange</span><span class="p">(</span><span class="n">game</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="p">(</span><span class="n">starting_elo</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">mutate</span><span class="p">(</span><span class="n">predicted_winner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">),</span><span class="w">
           </span><span class="n">successful_prediction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">predicted_winner</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">winner</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
    </span><span class="n">ungroup</span><span class="p">()</span><span class="w">
    
  </span><span class="nf">return</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="c1"># Elo ratings if we started back in 1897 (takes a couple of minutes):</span><span class="w">
</span><span class="n">elos_all</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">afl_elos</span><span class="p">(</span><span class="n">r</span><span class="p">)</span><span class="w">

</span><span class="c1"># Plot of Elo ratings over all of history</span><span class="w">
</span><span class="n">elos_all</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">team</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">new_elo</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">last</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_elo</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">team</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"right"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elo rating"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
       </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">the_caption</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Elo ratings of AFL / VFL teams, 1897 to present"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Elo rating calculated by modified FIBS method. Gaps in lines are the inter-season breaks."</span><span class="p">)</span></code></pre></figure>

<h2 id="ratings-change-depending-on-when-you-start-from">Ratings change depending on when you start from</h2>

<p>What happens if we base our ratings only on recent performance? As an example, the chart below shows team ratings for the 2018 season if all teams were reset to 1500 at the beginning of the year:</p>

<p><img src="/img/0147-2018-only.svg" width="100%" /></p>

<p>The rankings differ quite noticeably from those based on the full history.</p>

<p>2018’s top ranked team, Richmond, was only seventh when the full history was used. They didn’t make the grand final - such is the luck inherent in this sort of tournament - but the eventual premiers West Coast (my own team, for what it’s worth, as a result of growing up in Perth) were ranked a solid second. The four top teams were those in the semi-finals, so that system works to a degree.</p>

<p>So that’s ratings based on one year, what if we choose a dozen years? A very interesting story of Geelong’s complete dominance up to about 2014, caught up in the past five years or so by Hawthorn and Sydney. Richmond is much less prominent in this view, reflecting how suprisingly well it went in 2018 (despite missing out on the final) compared to form in the previous ten years:</p>

<p><img src="/img/0147-2007-on.svg" width="100%" /></p>

<p>The ratings based on 2007 and onwards end up in a very similar position to those based on 1897 and onwards; it looks like there is about 10 years of momentum stored up in a rolling Elo rating.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># Elo ratings if we did them only for last year:</span><span class="w">
</span><span class="n">elos_2018</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">date</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="s2">"2018-01-01"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">afl_elos</span><span class="p">()</span><span class="w">

</span><span class="c1"># Elo ratings if we did them only from 2007 onwards</span><span class="w">
</span><span class="n">elos_2007</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">date</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">as.Date</span><span class="p">(</span><span class="s2">"2007-01-01"</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">afl_elos</span><span class="p">()</span><span class="w">

</span><span class="c1"># Plot of Elo ratings if done just from 2018</span><span class="w">
</span><span class="n">elos_2018</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">team</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">new_elo</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">last</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_elo</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">team</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"right"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elo rating"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
       </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">the_caption</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Elo ratings of AFL / VFL teams, 2018 season"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Elo rating calculated by modified FIBS method, ignoring pre-2018 performance."</span><span class="p">)</span><span class="w">
  

</span><span class="c1"># Plot of Elo ratings if done from 2007</span><span class="w">
</span><span class="n">elos_2007</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">team</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fct_reorder</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">new_elo</span><span class="p">,</span><span class="w"> </span><span class="n">.fun</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">last</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">date</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_elo</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">paste</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="n">season</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">theme</span><span class="p">(</span><span class="n">legend.position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"right"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elo rating"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
       </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">the_caption</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Elo ratings of AFL / VFL teams, 2007 to present"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Elo rating calculated by modified FIBS method, ignoring pre-2007 performance."</span><span class="p">)</span></code></pre></figure>

<h2 id="recent-performance-is-a-better-guide-for-predictions-than-the-full-history">Recent performance is a better guide for predictions than the full history</h2>

<p>Let’s turn to the question of using Elo ratings, whether based on 12 months of performance or 120 years, to predict winners in the coming season. This next chart compares the teams’ ratings at the end of 2018 (having been reset to 1500 at the beginning of the  year) with two candidate explanatory variables with predictive power - Elo rating based just on the 2017 season, and Elo rating based on 120 years of performance to end of 2017. Both sets of ratings have predictive power, but the ratings based on only 12 months are slightly better.</p>

<p><img src="/img/0147-starting-points.svg" width="100%" /></p>

<p>Finally, here’s a chart of how well we would have gone in a 120 year footy-tipping competition if we simply tipped the team with the higher Elo rating, based on performance to date, to win. Our success rate in the red line (using full history of performance) hovers around 65%, which isn’t stellar but is clearly better than chance.</p>

<p><img src="/img/0147-success-rates.svg" width="100%" /></p>

<p>The short blue line is success rate when using just performance from 2017 onwards to predict. We see its slightly better than the predictions that used full history. Ideally, I would calculate Elo ratings based on the past 12, 24 and 36 months only for every season to find the best level of history to include, but that’s more rigour than I’m interested in at the moment. I’m going to use Elo ratings based on the 2018 and 2019 seasons for my footy tips.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#----------------is it best just to use recent Elo, or all history---------</span><span class="w">
</span><span class="c1"># Elo ratings if we did them only for 2017</span><span class="w">
</span><span class="n">elos_2017_final</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">r</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">year</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2017</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">afl_elos</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">team</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">date</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="n">elo_2017</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_elo</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w">

</span><span class="c1"># based on all history up to 2017 (already calculated this so can just filter to get it)</span><span class="w">
</span><span class="n">elos_2017_and_earlier</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="n">elos_all</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">year</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2017</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">team</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">date</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="n">elo_up_to_2017</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_elo</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> 

</span><span class="n">elos_2018_final</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">elos_2018</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">team</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">date</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="n">elo_2018</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new_elo</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> 

</span><span class="n">elos_two_types</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">elos_2017_final</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">left_join</span><span class="p">(</span><span class="n">elos_2017_and_earlier</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"team"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">inner_join</span><span class="p">(</span><span class="n">elos_2018_final</span><span class="p">,</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"team"</span><span class="p">)</span><span class="w">

</span><span class="n">elos_two_types</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">gather</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">elo_2018</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elo_2018</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">team</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gam"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">variable</span><span class="p">,</span><span class="w"> </span><span class="n">scales</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"free_x"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_text_repel</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elo rating before the 2018 season"</span><span class="p">,</span><span class="w">
       </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Elo rating at end of 2018"</span><span class="p">,</span><span class="w">
       </span><span class="n">caption</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">the_caption</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Elo ratings at end of 2018 compared to two alternative starting points"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"Horizontal axis for panel on left shows rating based on just 2017; on right is based on 1897 to 2017"</span><span class="p">)</span><span class="w">

</span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lm</span><span class="p">(</span><span class="n">elo_2018</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">elo_up_to_2017</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">elo_2017</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elos_two_types</span><span class="p">)</span><span class="w">
</span><span class="n">summary</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">
</span><span class="n">anova</span><span class="p">(</span><span class="n">mod</span><span class="p">)</span><span class="w">

</span><span class="c1"># this suggests that Elo ratings have too long a memory; it is better </span><span class="w">
</span><span class="c1"># to shrink them towards 1500 in between each season</span><span class="w">



</span><span class="c1">#---------------success over time-----------------</span><span class="w">

</span><span class="n">elos_2017_onwards</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">filter</span><span class="p">(</span><span class="n">year</span><span class="p">(</span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">2017</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">afl_elos</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">successful_predictions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">predicted_winner</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">winner</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2017"</span><span class="p">)</span><span class="w">

</span><span class="n">CairoSVG</span><span class="p">(</span><span class="s2">"../img/0147-success-rates.svg"</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w">
</span><span class="n">elos_all</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">season</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">summarise</span><span class="p">(</span><span class="n">successful_predictions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mean</span><span class="p">(</span><span class="n">successful_prediction</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"1897"</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">rbind</span><span class="p">(</span><span class="n">elos_2017_onwards</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ggplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">season</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">successful_predictions</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">method</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Season"</span><span class="p">,</span><span class="w"> </span><span class="n">colour</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Prediction based on performance since:"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">scale_y_continuous</span><span class="p">(</span><span class="s2">"Prediction success"</span><span class="p">,</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">percent_format</span><span class="p">(</span><span class="n">accuracy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">ggtitle</span><span class="p">(</span><span class="s2">"Success rate of predicted AFL outcomes from Elo rating based on full history"</span><span class="p">)</span></code></pre></figure>

<h2 id="and-the-answer-is">And the answer is…</h2>

<p>So here’s my rating table I used for tips for round 1 of 2019 (other than the first game, which being on a Thursday snuck up on me before I realised I had to get tips in - newbie mistake, annoying because I would have picked the winner correctly).</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">team</th>
      <th style="text-align: right">new_elo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Richmond</td>
      <td style="text-align: right">1560.921</td>
    </tr>
    <tr>
      <td style="text-align: left">West Coast</td>
      <td style="text-align: right">1553.291</td>
    </tr>
    <tr>
      <td style="text-align: left">Melbourne</td>
      <td style="text-align: right">1553.150</td>
    </tr>
    <tr>
      <td style="text-align: left">Collingwood</td>
      <td style="text-align: right">1543.454</td>
    </tr>
    <tr>
      <td style="text-align: left">Geelong</td>
      <td style="text-align: right">1533.995</td>
    </tr>
    <tr>
      <td style="text-align: left">Hawthorn</td>
      <td style="text-align: right">1523.387</td>
    </tr>
    <tr>
      <td style="text-align: left">GWS</td>
      <td style="text-align: right">1522.148</td>
    </tr>
    <tr>
      <td style="text-align: left">Port Adelaide</td>
      <td style="text-align: right">1515.349</td>
    </tr>
    <tr>
      <td style="text-align: left">Sydney</td>
      <td style="text-align: right">1514.495</td>
    </tr>
    <tr>
      <td style="text-align: left">Essendon</td>
      <td style="text-align: right">1514.178</td>
    </tr>
    <tr>
      <td style="text-align: left">North Melbourne</td>
      <td style="text-align: right">1509.164</td>
    </tr>
    <tr>
      <td style="text-align: left">Adelaide</td>
      <td style="text-align: right">1507.768</td>
    </tr>
    <tr>
      <td style="text-align: left">Brisbane Lions</td>
      <td style="text-align: right">1465.610</td>
    </tr>
    <tr>
      <td style="text-align: left">Footscray</td>
      <td style="text-align: right">1461.265</td>
    </tr>
    <tr>
      <td style="text-align: left">Fremantle</td>
      <td style="text-align: right">1457.496</td>
    </tr>
    <tr>
      <td style="text-align: left">St Kilda</td>
      <td style="text-align: right">1433.498</td>
    </tr>
    <tr>
      <td style="text-align: left">Gold Coast</td>
      <td style="text-align: right">1423.489</td>
    </tr>
    <tr>
      <td style="text-align: left">Carlton</td>
      <td style="text-align: right">1407.342</td>
    </tr>
  </tbody>
</table>

<p>This led to tips that were mostly consistent with the crowd favourites and bookies’ odds. The main exception was that I tip Hawthorn to beat the Adelaide Crows, against the strong expectations of everyone else. Possibly they know something additional to what’s in my data; did Hawthorn lose some key players, or have a bad off-season? We’ll only know at the end of the season when we can see if my method gets better results than the average punter.</p>

<p><em>Post continues after code extract</em></p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">#---------------current ratings--------------------------</span><span class="w">
</span><span class="c1"># This provides round 1 tips for 2019</span><span class="w">
</span><span class="c1"># The differ from the popular choice on two:</span><span class="w">
</span><span class="c1"># Hawthorn predicted by me to beat Adelaide Crows, although tips are 88:12 other direction</span><span class="w">
</span><span class="c1"># North Melbourne predicted by me to beat Fremantle, although tips are 62:38 in other direction</span><span class="w">
</span><span class="n">elos_2018</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">group_by</span><span class="p">(</span><span class="n">team</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">date</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">slice</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">ungroup</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">new_elo</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">select</span><span class="p">(</span><span class="n">team</span><span class="p">,</span><span class="w"> </span><span class="n">new_elo</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">knitr</span><span class="o">::</span><span class="n">kable</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">clipr</span><span class="o">::</span><span class="n">write_clip</span><span class="p">()</span></code></pre></figure>

<p>That’s all.</p>

<p>Here’s the R packages used in producing this post:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">thankr</span><span class="o">::</span><span class="n">shoulders</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">mutate</span><span class="p">(</span><span class="n">maintainer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">str_squish</span><span class="p">(</span><span class="n">gsub</span><span class="p">(</span><span class="s2">"&lt;.+&gt;"</span><span class="p">,</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">maintainer</span><span class="p">)))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w">
  </span><span class="n">knitr</span><span class="o">::</span><span class="n">kable</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> 
  </span><span class="n">clipr</span><span class="o">::</span><span class="n">write_clip</span><span class="p">()</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th style="text-align: left">maintainer</th>
      <th style="text-align: right">no_packages</th>
      <th style="text-align: left">packages</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">Hadley Wickham</td>
      <td style="text-align: right">16</td>
      <td style="text-align: left">assertthat, dplyr, ellipsis, forcats, ggplot2, gtable, haven, httr, lazyeval, modelr, plyr, rvest, scales, stringr, tidyr, tidyverse</td>
    </tr>
    <tr>
      <td style="text-align: left">R Core Team</td>
      <td style="text-align: right">11</td>
      <td style="text-align: left">base, compiler, datasets, graphics, grDevices, grid, methods, splines, stats, tools, utils</td>
    </tr>
    <tr>
      <td style="text-align: left">Winston Chang</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">extrafont, extrafontdb, R6, Rttf2pt1</td>
    </tr>
    <tr>
      <td style="text-align: left">Yihui Xie</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">evaluate, knitr, rmarkdown, xfun</td>
    </tr>
    <tr>
      <td style="text-align: left">Kirill Müller</td>
      <td style="text-align: right">4</td>
      <td style="text-align: left">DBI, hms, pillar, tibble</td>
    </tr>
    <tr>
      <td style="text-align: left">Yixuan Qiu</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">showtext, showtextdb, sysfonts</td>
    </tr>
    <tr>
      <td style="text-align: left">Lionel Henry</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">purrr, rlang, tidyselect</td>
    </tr>
    <tr>
      <td style="text-align: left">Gábor Csárdi</td>
      <td style="text-align: right">3</td>
      <td style="text-align: left">cli, crayon, pkgconfig</td>
    </tr>
    <tr>
      <td style="text-align: left">Dirk Eddelbuettel</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">digest, Rcpp</td>
    </tr>
    <tr>
      <td style="text-align: left">Jeroen Ooms</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">curl, jsonlite</td>
    </tr>
    <tr>
      <td style="text-align: left">Jim Hester</td>
      <td style="text-align: right">2</td>
      <td style="text-align: left">glue, withr</td>
    </tr>
    <tr>
      <td style="text-align: left">Kamil Slowikowski</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">ggrepel</td>
    </tr>
    <tr>
      <td style="text-align: left">Vitalie Spinu</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">lubridate</td>
    </tr>
    <tr>
      <td style="text-align: left">Deepayan Sarkar</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">lattice</td>
    </tr>
    <tr>
      <td style="text-align: left">Patrick O. Perry</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">utf8</td>
    </tr>
    <tr>
      <td style="text-align: left">Jennifer Bryan</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">cellranger</td>
    </tr>
    <tr>
      <td style="text-align: left">Michel Lang</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">backports</td>
    </tr>
    <tr>
      <td style="text-align: left">Jennifer Bryan</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">readxl</td>
    </tr>
    <tr>
      <td style="text-align: left">Kevin Ushey</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">rstudioapi</td>
    </tr>
    <tr>
      <td style="text-align: left">Martin Maechler</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Matrix</td>
    </tr>
    <tr>
      <td style="text-align: left">Justin Talbot</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">labeling</td>
    </tr>
    <tr>
      <td style="text-align: left">Jim Hester</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">readr</td>
    </tr>
    <tr>
      <td style="text-align: left">Charlotte Wickham</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">munsell</td>
    </tr>
    <tr>
      <td style="text-align: left">Alex Hayes</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">broom</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Wood</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">mgcv</td>
    </tr>
    <tr>
      <td style="text-align: left">Joe Cheng</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">htmltools</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Urbanek</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">audio</td>
    </tr>
    <tr>
      <td style="text-align: left">Peter Ellis</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">frs</td>
    </tr>
    <tr>
      <td style="text-align: left">Brodie Gaslam</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">fansi</td>
    </tr>
    <tr>
      <td style="text-align: left">R-core</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">nlme</td>
    </tr>
    <tr>
      <td style="text-align: left">Stefan Milton Bache</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">magrittr</td>
    </tr>
    <tr>
      <td style="text-align: left">Marek Gagolewski</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">stringi</td>
    </tr>
    <tr>
      <td style="text-align: left">James Hester</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">xml2</td>
    </tr>
    <tr>
      <td style="text-align: left">Max Kuhn</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">generics</td>
    </tr>
    <tr>
      <td style="text-align: left">Simon Urbanek</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">Cairo</td>
    </tr>
    <tr>
      <td style="text-align: left">Jeremy Stephens</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">yaml</td>
    </tr>
    <tr>
      <td style="text-align: left">James Day</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">fitzRoy</td>
    </tr>
    <tr>
      <td style="text-align: left">Achim Zeileis</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">colorspace</td>
    </tr>
    <tr>
      <td style="text-align: left">Rasmus Bååth</td>
      <td style="text-align: right">1</td>
      <td style="text-align: left">beepr</td>
    </tr>
  </tbody>
</table>



		
	</div>
</div>

<div class="col-md-1"></div>
<div class="col-md-4">
	<div class="side-banner">
	


	<div>
	   
	    
			
			<p>&larr; Previous post</p>
			<p><a rel="prev" href="/blog/2019/03/11/aust-election-2-swings">Exploring swings in Australian federal elections</a></p>
		
		
		
		
		 
			
			<p>Next post &rarr;</p>
			<p><a rel="next" href="/blog/2019/03/30/afl-elo-adjusted">Better predictions for AFL from adjusted Elo ratings</a></p>
			
			
		
		
	</div>
	
	 

   <div class = "side-footer">
			
			<hr></hr>
			<p><gcse:search></gcse:search></p>
			<hr></hr>
        	<p>Follow <a href = "/feed.xml">this blog with RSS</a>.</p>
			<p>Find me on <a rel="me" href="https://mastodon.social/@peter_ellis">Mastodon</a>.</p>
			<hr></hr>
			
			<p>My day job is Director of the <a href='https://sdd.spc.int/'>Statistics for Development Division</a> at the Pacific Community, the principal scientific and technical organisation in the Pacific region, proudly supporting development since 1947. We are an international development organisation owned and governed by our 27 country and territory members. This blog is not part of my role there and contains my personal views only.</p>
		
		    <hr></hr>
			
       <div class="fb-like" data-href="https://www.facebook.com/peterstats/" data-layout="standard" data-action="like" data-show-faces="false" data-share="false"></div>
			
			<hr></hr>
			<p>I'm pleased to be aggregated at <a href="https://www.r-bloggers.com/">R-bloggers</a>, the one-stop shop for blog posts featuring R.</p>
			<hr></hr>

			
			<p>			
            <span xmlns:dct="https://purl.org/dc/terms/" property="dct:title"><i>free range statistics</i></span> by <a href = "/about/index.html">Peter Ellis</a> is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
			</p>

			<hr></hr>
			


    </div>



  
   




		  
		  



	   
	<div id="disqus_thread"></div>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function() {
				var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
				dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
				(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
			})();
		</script>

		<script type="text/javascript">
			/* * * CONFIGURATION VARIABLES * * */
			var disqus_shortname = 'statsinthewild';
			
			/* * * DON'T EDIT BELOW THIS LINE * * */
			(function () {
				var s = document.createElement('script'); s.async = true;
				s.type = 'text/javascript';
				s.src = '//' + disqus_shortname + '.disqus.com/count.js';
				(document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
			}());
		</script>

	<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
	</div>	
</div>    
   
   

			
			</div><!-- /.container -->
         
   <!-- Default Statcounter code for Free Range Statistics https://freerangestats.info -->
<script type="text/javascript">
var sc_project=11673245; 
var sc_invisible=1; 
var sc_security="5b7111a4"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img class="statcounter"
src="//c.statcounter.com/11673245/0/5b7111a4/1/" alt="Web
Analytics"></a></div></noscript>
<!-- End of Statcounter Code -->

</body>   
</html>